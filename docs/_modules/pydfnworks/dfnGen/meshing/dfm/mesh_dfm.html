<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pydfnworks.dfnGen.meshing.dfm.mesh_dfm &mdash; dfnWorks 2.9.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b76e3c8a" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../../_static/documentation_options.js?v=bc52e0b9"></script>
        <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index_docs.html" class="icon icon-home">
            dfnWorks
              <img src="../../../../../_static/dfnworks_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.9.1 LANL, Docs: LA-UR-17-22216, Software: LA-CC-17-027
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro.html">Welcome To dfnWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications.html">Example Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../setup.html">Setup and Running dfnWorks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pydfnworks.html">pydfnworks: the dfnWorks python package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pydfnGen.html">pydfnworks: dfnGen</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pydfnFlow.html">pydfnworks: dfnFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pydfnTrans.html">pydfnworks: dfnTrans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pydfnGraph.html">pydfnworks: dfnGraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../pydfnWorks-well.html">pydfnworks: Well Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dfngen.html">dfnGen - C++ Generation Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dfnflow.html">dfnFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dfntrans.html">dfnTrans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../output.html">Run Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../publications.html">dfnWorks Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../gallery.html">dfnWorks Gallery</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index_docs.html">dfnWorks</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index_docs.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pydfnworks.dfnGen.meshing.dfm.mesh_dfm</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pydfnworks.dfnGen.meshing.dfm.mesh_dfm</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. module:: mesh_dfm.py</span>
<span class="sd">   :synopsis: meshing driver for conforming DFM  </span>
<span class="sd">.. moduleauthor:: Jeffrey Hyman &lt;jhyman@lanl.gov&gt;</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span> 

<span class="c1"># pydfnworks Modules</span>
<span class="kn">from</span> <span class="nn">pydfnworks.dfnGen.meshing.mesh_dfn</span> <span class="kn">import</span> <span class="n">mesh_dfn_helper</span> <span class="k">as</span> <span class="n">mh</span>

<span class="k">def</span> <span class="nf">setup_mesh_dfm_directory</span><span class="p">(</span><span class="n">jobname</span><span class="p">,</span> <span class="n">dirname</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Setup working directory for meshing the DFM. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">        jobname : string</span>
<span class="sd">            path to DFN working directory </span>
<span class="sd">        dirname : string </span>
<span class="sd">            name of working directory</span>

<span class="sd">    Returns</span>
<span class="sd">    --------------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -------------</span>
<span class="sd">        None </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">jobname</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">dirname</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Working directory is now </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Make symbolic links to required files</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">jobname</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s2">&quot;full_mesh.inp&quot;</span><span class="p">,</span> <span class="s2">&quot;full_mesh.inp&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error. Unable to make symbolic link to full_mesh.inp file for DFM meshing from </span><span class="si">{</span><span class="n">jobname</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">Exitting program.&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Setting up DFM meshing directory complete&quot;</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">translate_mesh</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Moves reduced_mesh.inp from center at x1 to x2 </span>

<span class="sd">    Parameters</span>
<span class="sd">    ---------------</span>
<span class="sd">        x1 : list</span>
<span class="sd">            floats x-0, y-1, z-2 - current center</span>

<span class="sd">        x2 : list</span>
<span class="sd">            floats x-0, y-1, z-2 - requisted center </span>
<span class="sd">    Returns</span>
<span class="sd">    --------------</span>
<span class="sd">        None </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lagrit_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">read / avs / full_mesh.inp / MODFN</span>
<span class="s2">trans / 1 0 0 / </span><span class="si">{</span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">x2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span>
<span class="s2">cmo / printatt / MODFN / -xyz- / minmax</span>
<span class="s2">dump / full_mesh.inp / MODFN</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;translate_mesh.lgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">mh</span><span class="o">.</span><span class="n">run_lagrit_script</span><span class="p">(</span><span class="s2">&quot;translate_mesh.lgi&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_domain</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Gather domain information. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        domain : dict</span>
<span class="sd">            Domain size dictionary from DFN object </span>
<span class="sd">        h : float </span>
<span class="sd">            Meshing length scale from DFN object </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        num_points : int </span>
<span class="sd">            Number of points on side of the domain </span>
<span class="sd">        box_domain : dict</span>
<span class="sd">            dictionary of domain min/max for x,y,z</span>

<span class="sd">    Notes</span>
<span class="sd">    ------</span>
<span class="sd">        Exits program is too many points are in domain. </span>
<span class="sd">        Assuming that </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">box_domain</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;x0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="s2">&quot;y0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;y1&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> 
                  <span class="s2">&quot;z0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;z1&quot;</span><span class="p">:</span> <span class="kc">None</span> 
                  <span class="p">}</span>

    <span class="c1"># Extent of domain</span>
    <span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>

    <span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> 
    <span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> 

    <span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>
    <span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">domain</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span>

    <span class="c1"># Mesh size in matrix</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">2</span>
    <span class="c1"># # Number of points in each direction in matrix</span>
    <span class="c1"># num_points = domain[&#39;x&#39;] / l + 1</span>
    <span class="c1"># if num_points**3 &gt; 1e8:</span>
    <span class="c1">#     error = f&quot;Error: Too many elements for DFM meshing.\nValue {num_points**3}\nMaximum is 1e8\nExiting Program&quot;</span>
    <span class="c1">#     sys.stderr.write(error)</span>
    <span class="c1">#     sys.exit(1)</span>

    <span class="n">num_points_x</span> <span class="o">=</span> <span class="n">domain</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">num_points_y</span> <span class="o">=</span> <span class="n">domain</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">num_points_z</span> <span class="o">=</span> <span class="n">domain</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">num_points_x</span><span class="o">*</span><span class="n">num_points_y</span><span class="o">*</span><span class="n">num_points_z</span> <span class="o">&gt;</span> <span class="mf">1e8</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error: Too many elements for DFM meshing.</span><span class="se">\n</span><span class="s2">Value </span><span class="si">{</span><span class="n">num_points_x</span><span class="o">*</span><span class="n">num_points_y</span><span class="o">*</span><span class="n">num_points_z</span><span class="w"> </span><span class="si">}</span><span class="se">\n</span><span class="s2">Maximum is 1e8</span><span class="se">\n</span><span class="s2">Exiting Program&quot;</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">box_domain</span><span class="p">,</span> <span class="n">num_points_x</span><span class="p">,</span> <span class="n">num_points_y</span><span class="p">,</span> <span class="n">num_points_z</span> 

<span class="k">def</span> <span class="nf">dfm_driver</span><span class="p">(</span><span class="n">num_points_x</span><span class="p">,</span> <span class="n">num_points_y</span><span class="p">,</span> <span class="n">num_points_z</span> <span class="p">,</span> <span class="n">num_fracs</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">box_domain</span><span class="p">,</span> <span class="n">psets</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function creates the main lagrit driver script, which calls the other lagrit scripts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        num_points : int </span>
<span class="sd">            Number of points on side of the domain </span>
<span class="sd">        num_fracs : int </span>
<span class="sd">            Number of Fractures in the DFN</span>
<span class="sd">        h : float</span>
<span class="sd">            meshing length scale </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        None </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">floop</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ifrac</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_fracs</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ifrac</span> <span class="o">&lt;</span> <span class="n">num_fracs</span><span class="p">:</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;facets_f</span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span><span class="s2">.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;facets_f</span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span><span class="s2">.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="s2">&quot;left.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="s2">&quot;right.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="s2">&quot;front.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="s2">&quot;back.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="s2">&quot;top.table &amp;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">floop</span> <span class="o">+=</span> <span class="s2">&quot;bottom.table&quot;</span>
            
    <span class="n">lagrit_script</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;#</span>
<span class="s2">#   dfm_mesh_fracture_driver.lgi</span>
<span class="s2">#   dfm_box_dimensions.mlgi</span>
<span class="s2">#   dfm_build_background_mesh.mlgi</span>
<span class="s2">#   dfm_extract_fracture_facets.mlgi</span>
<span class="s2">#   dfm_extract_facets.mlgi</span>
<span class="s2">#</span>
<span class="s2"># extract_fracture_facets.mlgi must be customized for the number of fractures in the DFN</span>
<span class="s2">#</span>
<span class="s2"># This is the dfnWorks DFN mesh</span>
<span class="s2">#</span>
<span class="s2">define / INPUT / full_mesh.inp</span>
<span class="s2">read / avs / INPUT / mo_dfn</span>
<span class="s2">cmo / DELATT / mo_dfn / dfield</span>
<span class="s2">cmo / DELATT / mo_dfn / b_a</span>
<span class="s2">cmo / DELATT / mo_dfn / numbnd</span>
<span class="s2">cmo / DELATT / mo_dfn / if_numb</span>
<span class="s2">#</span>
<span class="s2"># Diagnostics on fracture mesh extents and resolution</span>
<span class="s2">#</span>
<span class="s2">cmo / printatt / mo_dfn / -xyz- / minmax</span>
<span class="s2">quality</span>
<span class="s2">quality/edge_min</span>
<span class="s2">quality/edge_max</span>
<span class="s2">#</span>
<span class="s2"># Define a resolution for the background mesh. This assumes the DFN</span>
<span class="s2"># triangulation is uniform resolution triangles. No attempt is made</span>
<span class="s2"># to adapt the volume mesh resolution to the DFN triangle resolution.</span>
<span class="s2">#</span>
<span class="s2">define / NPX / </span><span class="si">{</span><span class="n">num_points_x</span><span class="si">}</span>
<span class="s2"># define / NPXM1 / </span><span class="si">{</span><span class="n">num_points_x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span>
<span class="s2">define / NPY / </span><span class="si">{</span><span class="n">num_points_y</span><span class="si">}</span>
<span class="s2"># define / NPYM1 / </span><span class="si">{</span><span class="n">num_points_y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span>
<span class="s2">define / NPZ / </span><span class="si">{</span><span class="n">num_points_z</span><span class="si">}</span>
<span class="s2"># define / NPZM1 / </span><span class="si">{</span><span class="n">num_points_z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span>
<span class="s2">define / VERTEX_CLOSE / </span><span class="si">{</span><span class="n">h</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="si">}</span>
<span class="s2">#</span>
<span class="s2">define / MO_BACKGROUND / mo_background</span>
<span class="s2">infile dfm_box_dimensions.mlgi</span>
<span class="s2">infile dfm_build_background_mesh.mlgi</span>
<span class="s2">#</span>
<span class="s2"># Remove all vertices of the tet mesh that fall withing a circumsphere of a fracture triangle.</span>
<span class="s2">#</span>
<span class="s2">addmesh / excavate / mo_tmp / MO_BACKGROUND / mo_dfn</span>
<span class="s2">cmo / delete / MO_BACKGROUND</span>
<span class="s2">#</span>
<span class="s2"># Merge the vertices of the excavated tet mesh with the DFN vertices</span>
<span class="s2">#</span>
<span class="s2">cmo / create / mo_dfm / / / tet</span>
<span class="s2">copypts / mo_dfm / mo_tmp</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">compute / distance_field / mo_dfm / mo_dfn / df_vertex</span>
<span class="s2">cmo / select / mo_dfm</span>
<span class="s2">pset / pdel / attribute / df_vertex / 1 0 0 / le VERTEX_CLOSE</span>
<span class="s2">rmpoint / pset get pdel / inclusive</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_dfm / df_vertex</span>
<span class="s2">copypts / mo_dfm / mo_dfn</span>
<span class="s2">#</span>
<span class="s2">cmo / setatt / mo_dfm / imt / 1 0 0 / 1</span>
<span class="s2">cmo / setatt / mo_dfm / itp / 1 0 0 / 0</span>
<span class="s2">cmo / select / mo_dfm</span>
<span class="s2">connect</span>
<span class="s2">cmo / setatt / mo_dfm / itetclr / 1 0 0 / 1</span>
<span class="s2">resetpts / itp</span>
<span class="s2">quality</span>
<span class="s2">#</span>
<span class="s2">#compute / signed_distance_field / mo_dfm / mo_dfn / df_sign_dfm_dfn</span>
<span class="s2">#</span>
<span class="s2"># crush_thin_tets / mo_dfm / 0.25 / 1 0 0 </span>
<span class="s2">dump / avs    / dfm_tet_mesh.inp / mo_dfm</span>
<span class="s2">dump / lagrit / dfm_tet_mesh.lg  / mo_dfm</span>
<span class="s2">dump / exo    / dfm_tet_mesh.exo / mo_dfm</span>

<span class="s2">cmo / delete / mo_dfm</span>
<span class="s2">cmo / delete / mo_dfn</span>
<span class="s2">#</span>
<span class="s2">cmo / status / brief</span>
<span class="s2">#</span>
<span class="s2">infile dfm_extract_fracture_facets.mlgi</span>
<span class="s2">infile dfm_diagnostics.mlgi</span>
<span class="s2">#</span>
<span class="s2"># Delete this !!!! </span>
<span class="s2"># Hardcoded facesets on boundaries for Alex EES17</span>
<span class="s2">cmo / select / mo_dfm</span>
<span class="s2">extract / surfmesh / 1 0 0 / mo_surf / mo_dfm / external</span>
<span class="s2">cmo / addatt / mo_surf / id_side / vint / scalar / nelements</span>
<span class="s2">cmo / select / mo_surf</span>
<span class="s2">settets / normal</span>
<span class="s2">cmo / copyatt / mo_surf mo_surf / id_side itetclr</span>
<span class="s2">cmo / printatt / mo_surf / id_side / minmax</span>
<span class="s2">cmo / DELATT / mo_surf / itetclr0</span>
<span class="s2">cmo / DELATT / mo_surf / idnode0</span>
<span class="s2">cmo / DELATT / mo_surf / idelem0</span>
<span class="s2">cmo / DELATT / mo_surf / facecol</span>
<span class="s2">cmo / DELATT / mo_surf / itetclr1</span>
<span class="s2">cmo / DELATT / mo_surf / idface0</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_tmp / mo_surf</span>
<span class="s2">cmo / select / mo_tmp</span>
<span class="s2">eltset / e_bottom / id_side / eq / 1</span>
<span class="s2">eltset / e_delete / not / e_bottom</span>
<span class="s2">rmpoint / element / eltset get e_delete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_tmp / id_side</span>
<span class="s2">dump / avs2 / bottom.table / mo_tmp / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_tmp / mo_surf</span>
<span class="s2">cmo / select / mo_tmp</span>
<span class="s2">eltset / e_top / id_side / eq / 2</span>
<span class="s2">eltset / e_delete / not / e_top</span>
<span class="s2">rmpoint / element / eltset get e_delete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_tmp / id_side</span>
<span class="s2">dump / avs2 / top.table / mo_tmp / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_tmp / mo_surf</span>
<span class="s2">cmo / select / mo_tmp</span>
<span class="s2">eltset / e_right / id_side / eq / 3</span>
<span class="s2">eltset / e_delete / not / e_right</span>
<span class="s2">rmpoint / element / eltset get e_delete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_tmp / id_side</span>
<span class="s2">dump / avs2 / right.table / mo_tmp / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_tmp / mo_surf</span>
<span class="s2">cmo / select / mo_tmp</span>
<span class="s2">eltset / e_back / id_side / eq / 4</span>
<span class="s2">eltset / e_delete / not / e_back</span>
<span class="s2">rmpoint / element / eltset get e_delete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_tmp / id_side</span>
<span class="s2">dump / avs2 / back.table / mo_tmp / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_tmp / mo_surf</span>
<span class="s2">cmo / select / mo_tmp</span>
<span class="s2">eltset / e_left / id_side / eq / 5</span>
<span class="s2">eltset / e_delete / not / e_left</span>
<span class="s2">rmpoint / element / eltset get e_delete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_tmp / id_side</span>
<span class="s2">dump / avs2 / left.table / mo_tmp / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_tmp / mo_surf</span>
<span class="s2">cmo / select / mo_tmp</span>
<span class="s2">eltset / e_front / id_side / eq / 6</span>
<span class="s2">eltset / e_delete / not / e_front</span>
<span class="s2">rmpoint / element / eltset get e_delete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">cmo / DELATT / mo_tmp / id_side</span>
<span class="s2">dump / avs2 / front.table / mo_tmp / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_tmp</span>
<span class="s2">#</span>
<span class="s2">&quot;&quot;&quot;</span>
    
    <span class="k">if</span> <span class="n">psets</span><span class="p">:</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="n">h</span><span class="o">/</span><span class="mi">4</span>
        <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">cmo / select / mo_dfm</span>
<span class="s2">cmo / printatt / mo_dfm / -xyz- / minmax</span>

<span class="s2">pset/ pleft / geom / xyz / 1, 0, 0 /  &amp;</span>
<span class="s2">     </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  / 0,0,0</span>
<span class="s2">pset/ pright / geom / xyz / 1, 0, 0 / &amp;</span>
<span class="s2">    </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  / 0,0,0</span>

<span class="s2">pset / pfront / geom / xyz / 1, 0, 0 / &amp; </span>
<span class="s2">    </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  / 0,0,0 </span>
<span class="s2">pset / pback / geom / xyz / 1, 0, 0 / &amp; </span>
<span class="s2">    </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  / 0,0,0 </span>

<span class="s2">pset / pbottom / geom / xyz / 1, 0, 0 / &amp;</span>
<span class="s2">    </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2">/ 0,0,0 </span>
<span class="s2">pset / ptop / geom / xyz / 1, 0, 0 /  &amp; </span>
<span class="s2">    </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eps</span><span class="si">}</span><span class="s2"> / 0,0,0 </span>

<span class="s2"># corners of the mesh 1</span>
<span class="s2">pset / p_tmp / inter / pleft pbottom</span>
<span class="s2">pset / p_corner_lfb / inter / p_tmp pfront </span>
<span class="s2">pset / p_tmp / delete </span>

<span class="s2">pset / pbottom / not / pbottom p_corner_lfb</span>
<span class="s2">pset / pleft / not / pleft p_corner_lfb</span>
<span class="s2">pset / pfront / not / pfront p_corner_lfb</span>


<span class="s2">cmo / addatt / mo_dfm / p_corner_lfb / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lfb / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lfb /pset,get,p_corner_lfb / 1</span>

<span class="s2"># corners of the mesh 2</span>
<span class="s2">pset / p_tmp / inter / pright pbottom</span>
<span class="s2">pset / p_corner_rfb / inter / p_tmp pfront </span>
<span class="s2">pset / p_tmp / delete </span>

<span class="s2">pset / pbottom / not / pbottom p_corner_rfb</span>
<span class="s2">pset / pright / not / pright p_rfp_corner</span>
<span class="s2">pset / pfront / not / pfront p_corner_rfb</span>

<span class="s2">cmo / addatt / mo_dfm / p_corner_rfb / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rfb / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rfb /pset,get,p_corner_rfb / 1</span>

<span class="s2"># corners of the mesh 3</span>
<span class="s2">pset / p_tmp / inter / pleft ptop</span>
<span class="s2">pset / p_corner_lft / inter / p_tmp pfront </span>

<span class="s2">pset / pbottom / not / pbottom p_corner_lft</span>
<span class="s2">pset / pleft / not / pleft p_corner_lft</span>
<span class="s2">pset / pfront / not / pfront p_corner_lft</span>
<span class="s2">pset / p_tmp / delete </span>

<span class="s2">cmo / addatt / mo_dfm / p_corner_lft / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lft / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lft /pset,get,p_corner_lft / 1</span>

<span class="s2"># corners of the mesh 4</span>
<span class="s2">pset / p_tmp / inter / pright ptop </span>
<span class="s2">pset / p_corner_rft / inter / p_tmp pfront </span>
<span class="s2">pset / p_tmp / delete </span>

<span class="s2">pset / ptop / not / ptop p_corner_rft</span>
<span class="s2">pset / pright / not / pright p_corner_rft</span>
<span class="s2">pset / pfront / not / pfront p_corner_rft</span>



<span class="s2">cmo / addatt / mo_dfm / p_corner_rft / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rft / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rft /pset,get,p_corner_rft / 1</span>



<span class="s2">### back face </span>

<span class="s2"># corners of the mesh 1</span>
<span class="s2">pset / p_tmp / inter / pleft pbottom</span>
<span class="s2">pset / p_corner_lbb / inter / p_tmp pback </span>
<span class="s2">pset / p_tmp / delete </span>


<span class="s2"># corners of the mesh 2</span>
<span class="s2">pset / p_tmp / inter / pright pbottom</span>
<span class="s2">pset / p_corner_rbb / inter / p_tmp pback </span>
<span class="s2">pset / p_tmp / delete </span>


<span class="s2"># corners of the mesh 3</span>
<span class="s2">pset / p_tmp / inter / pleft ptop</span>
<span class="s2">pset / p_corner_lbt / inter / p_tmp pback </span>
<span class="s2">pset / p_tmp / delete </span>


<span class="s2"># corners of the mesh 4</span>
<span class="s2">pset / p_tmp / inter / pright ptop </span>
<span class="s2">pset / p_corner_rbt / inter / p_tmp pback </span>
<span class="s2">pset / p_tmp / delete </span>

<span class="s2">########</span>

<span class="s2">cmo / addatt / mo_dfm / p_corner_rbt / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rbt / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rbt /pset,get,p_corner_rbt / 1</span>

<span class="s2">cmo / addatt / mo_dfm / p_corner_lbt / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lbt / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lbt /pset,get,p_corner_lbt / 1</span>


<span class="s2">cmo / addatt / mo_dfm / p_corner_lbb / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lbb / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_lbb /pset,get,p_corner_lbb / 1</span>

<span class="s2">cmo / addatt / mo_dfm / p_corner_rbb / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rbb / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / p_corner_rbb /pset,get,p_corner_rbb / 1</span>

<span class="s2">## clean up PSETS TO MESH </span>
<span class="s2">pset / pbottom / not / pbottom p_corner_lbb</span>
<span class="s2">pset / pleft / not / pleft p_corner_lbb</span>
<span class="s2">pset / pback / not / pback p_corner_lbb</span>

<span class="s2">pset / pbottom / not / pbottom p_corner_rbb</span>
<span class="s2">pset / pright / not / pright p_corner_rbb</span>
<span class="s2">pset / pback / not / pback p_corner_rbb</span>

<span class="s2">pset / ptop / not / ptop p_corner_lbt</span>
<span class="s2">pset / pleft / not / pleft p_corner_lbt</span>
<span class="s2">pset / pback / not / pback p_corner_lbt</span>

<span class="s2">pset / ptop / not / ptop p_corner_rbt</span>
<span class="s2">pset / pright / not / pright p_corner_rbt</span>
<span class="s2">pset / pback / not / pback p_corner_rbt</span>


<span class="s2">pset / pbottom / not / pbottom p_corner_lfb</span>
<span class="s2">pset / pleft / not / pleft p_corner_lfb</span>
<span class="s2">pset / pfront / not / pfront p_corner_lfb </span>

<span class="s2">pset / pbottom / not / pbottom p_corner_rfb</span>
<span class="s2">pset / pright / not / pright p_corner_rfb</span>
<span class="s2">pset / pfront / not / pfront p_corner_rfb</span>

<span class="s2">pset / ptop / not / ptop p_corner_lft</span>
<span class="s2">pset / pleft / not / pleft p_corner_lft</span>
<span class="s2">pset / pfront / not / pfront p_corner_lft</span>

<span class="s2">pset / ptop / not / ptop p_corner_rft</span>
<span class="s2">pset / pright / not / pright p_corner_rft</span>
<span class="s2">pset / pfront / not / pfront p_corner_rft</span>



<span class="s2">### edges ##### </span>

<span class="s2">pset / p_edge_lb / inter / pleft pbottom</span>
<span class="s2">pset / pbottom / not / pbottom p_edge_lb</span>
<span class="s2">pset / pleft / not / pleft p_edge_lb</span>

<span class="s2">pset / p_edge_lt / inter / pleft ptop</span>
<span class="s2">pset / ptop / not / ptop p_edge_lt</span>
<span class="s2">pset / pleft / not / pleft p_edge_lt</span>

<span class="s2">pset / p_edge_rb / inter / pright pbottom</span>
<span class="s2">pset / pbottom / not / pbottom p_edge_rb</span>
<span class="s2">pset / pright / not / pright p_edge_rb</span>

<span class="s2">pset / p_edge_rt / inter / pright ptop </span>
<span class="s2">pset / ptop / not / ptop p_edge_rt</span>
<span class="s2">pset / pright / not / pright p_edge_rt</span>

<span class="s2">####### </span>
<span class="s2">pset / p_edge_lfr / inter / pleft pfront</span>
<span class="s2">pset / pleft / not / pleft p_edge_lfr</span>
<span class="s2">pset / pfront / not / pfront p_edge_lfr</span>

<span class="s2">pset / p_edge_lba / inter / pleft pback </span>
<span class="s2">pset / pleft / not / pleft p_edge_lba</span>
<span class="s2">pset / pback / not / pback p_edge_lba</span>

<span class="s2">pset / p_edge_rfr / inter / pright pfront</span>
<span class="s2">pset / pright / not / pright p_edge_rfr</span>
<span class="s2">pset / pfront / not / pfront p_edge_rfr</span>

<span class="s2">pset / p_edge_rba / inter / pright pback </span>
<span class="s2">pset / pright / not / pright p_edge_rba</span>
<span class="s2">pset / pback / not / pback p_edge_rba</span>

<span class="s2">####### </span>


<span class="s2">pset / p_edge_frb / inter / pfront pbottom</span>
<span class="s2">pset / pfront / not / pfront p_edge_frb</span>
<span class="s2">pset / pbottom / not / pbottom p_edge_frb</span>

<span class="s2">pset / p_edge_bab / inter / pback pbottom</span>
<span class="s2">pset / pback / not / pback p_edge_bab</span>
<span class="s2">pset / pbottom / not / pbottom p_edge_bab</span>

<span class="s2">pset / p_edge_frtop / inter / pfront ptop</span>
<span class="s2">pset / pfront / not / pfront p_edge_frtop</span>
<span class="s2">pset / ptop / not / ptop p_edge_frtop</span>

<span class="s2">pset / p_edge_btop / inter /  pback ptop</span>
<span class="s2">pset / pback / not / pback p_edge_btop</span>
<span class="s2">pset / ptop / not / ptop p_edge_btop</span>

<span class="s2">####### </span>

<span class="s2">cmo / addatt / mo_dfm / right / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / right / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / right /pset,get,pright / 1</span>

<span class="s2">cmo / addatt / mo_dfm / back / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / back / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / back /pset,get,pback / 1</span>


<span class="s2">cmo / addatt / mo_dfm / left / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / left / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / left /pset,get,pleft / 1</span>

<span class="s2">cmo / addatt / mo_dfm / top / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / top / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / top /pset,get,ptop / 1</span>

<span class="s2">cmo / addatt / mo_dfm / bottom / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / bottom / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / bottom /pset,get,pbottom / 1</span>

<span class="s2">cmo / addatt / mo_dfm / front / vint / scalar / nnodes</span>
<span class="s2">cmo/setatt / mo_dfm / front / 1,0,0 / 0</span>
<span class="s2">cmo/setatt / mo_dfm / front /pset,get,pfront / 1</span>

<span class="s2">dump / dfm_tet_w_psets.inp / mo_dfm</span>
<span class="s2">dump / exo / dfm_tet_mesh_w_fsets.exo / mo_dfm / psets / / &amp;</span>
<span class="s2">     facesets &amp;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="n">floop</span> 
        <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">## no psets</span>
        <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">dump / exo / dfm_tet_mesh_w_fsets.exo / mo_dfm / / / &amp;</span>
<span class="s2">     facesets &amp;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="n">floop</span> 
        <span class="n">lagrit_script</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dfm_mesh_fracture_driver.lgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating dfm_mesh_fracture_driver.lgi file: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dfm_box</span><span class="p">(</span><span class="n">box_domain</span><span class="p">):</span>    
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function creates the dfm_box_dimensions.mlgi lagrit script.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        box_domain : dict</span>
<span class="sd">            dictionary of domain min/max for x,y,z</span>
<span class="sd">  </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None </span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        None </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lagrit_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;#</span>
<span class="s2"># Define a bounding box that surrounds, and is a big bigger, than the DFN</span>
<span class="s2">#</span>
<span class="s2">define / X0 / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x0&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">define / X1 / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">define / Y0 / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y0&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">define / Y1 / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">define / Z0 / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z0&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">define / Z1 / </span><span class="si">{</span><span class="n">box_domain</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">]</span><span class="si">}</span>

<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dfm_box_dimensions.mlgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating dfm_box_dimensions.mlgi file: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dfm_build</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Create the dfm_build_background_mesh.mlgi lagrit script.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        None </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None </span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        Needs to be modified to have different NPX, NPY, NPZ </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lagrit_script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;#</span>
<span class="s2"># Build a uniform background point distribution.</span>
<span class="s2">#</span>
<span class="s2">cmo / create / MO_BACKGROUND / / / tet</span>
<span class="s2">createpts / xyz / NPX NPY NPZ / X0 Y0 Z0 / X1 Y1 Z1 / 1 1 1</span>
<span class="s2">cmo / setatt / MO_BACKGROUND / imt / 1 0 0 / 1</span>
<span class="s2">connect / noadd</span>
<span class="s2">cmo / setatt / MO_BACKGROUND / itetclr / 1 0 0 / 1</span>
<span class="s2">#</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dfm_build_background_mesh.mlgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span> 
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating dfm_box_dimensions.mlgi file: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dfm_fracture_facets</span><span class="p">(</span><span class="n">num_frac</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function creates the dfm_extract_fracture_facets.mlgi lagrit script.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        num_frac : int </span>
<span class="sd">            Number of fractures in the DFN</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        None </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">floop1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">floop2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">ifrac</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_frac</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">floop1</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">define / FRAC_ID / </span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span>
<span class="s2">define / FRAC_FILE_OUT / facets_f</span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span><span class="s2">.inp</span>
<span class="s2">define / FRAC_TABLE_OUT / facets_f</span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span><span class="s2">.table</span>
<span class="s2">#</span>
<span class="s2">infile dfm_extract_facets.mlgi</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ifrac</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">floop2</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">read / avs / facets_f</span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span><span class="s2">.inp / mo_merge</span>
<span class="s2">cmo / setatt / mo_merge / itetclr / 1 0 0 / </span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span>
<span class="s2">        &quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">floop2</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">read / avs / facets_f</span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span><span class="s2">.inp / mo</span>
<span class="s2">cmo / setatt / mo / itetclr / 1 0 0 / </span><span class="si">{</span><span class="n">ifrac</span><span class="si">}</span>
<span class="s2">addmesh / merge / mo_merge / mo_merge / mo</span>
<span class="s2">cmo / delete / mo</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="n">lagrit_script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;#</span>
<span class="s2">define / INPUT / full_mesh.inp</span>
<span class="s2">define / MO_ONE_FRAC / mo_tmp_one_fracture</span>
<span class="s2">#</span>
<span class="s2">read / avs / dfm_tet_mesh.inp / mo_dfm</span>
<span class="s2">#</span>
<span class="s2">cmo / create / mo_merge</span>
<span class="s2">cmo / status / brief</span>
<span class="s2">read / avs / INPUT / mo_dfn</span>
<span class="s2">cmo / status / brief</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">+</span> <span class="n">floop1</span> <span class="o">+</span> <span class="n">floop2</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">dump / avs / facets_merged.inp / mo_merge</span>
<span class="s2">cmo / addatt / mo_merge / id_frac / vint / scalar / nelements</span>
<span class="s2">cmo / copyatt / mo_merge / mo_merge / id_frac / itetclr</span>
<span class="s2">dump / avs / facets_merged.table / mo_merge / 0 0 0 2</span>
<span class="s2">cmo / delete / mo_merge</span>

<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dfm_extract_fracture_facets.mlgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating dfm_extract_fracture_facets.mlgi file: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dfm_facets</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function creates the dfm_extract_facets.mlgi lagrit script.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        None </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None </span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">lagrit_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;#</span>
<span class="s2">cmo / copy / MO_ONE_FRAC / mo_dfn</span>
<span class="s2">cmo / select / MO_ONE_FRAC</span>
<span class="s2">rmmat / FRAC_ID / element / exclusive</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">resetpts / itp</span>
<span class="s2">cmo / status / brief</span>
<span class="s2">#</span>
<span class="s2">compute / signed_distance_field / mo_dfm / MO_ONE_FRAC / dfield_sign</span>

<span class="s2">cmo / delete / MO_ONE_FRAC</span>
<span class="s2">#</span>
<span class="s2">cmo / copy / mo_df_work / mo_dfm</span>

<span class="s2">cmo / DELATT / mo_dfm / dfield_sign</span>

<span class="s2">cmo / select / mo_df_work</span>
<span class="s2">pset / p1 / attribute / dfield_sign / 1 0 0 / gt 0.0</span>
<span class="s2">pset / p2 / attribute / dfield_sign / 1 0 0 / lt 0.0</span>
<span class="s2">eltset / e1 / inclusive / pset get p1</span>
<span class="s2">eltset / e2 / inclusive / pset get p2</span>
<span class="s2">cmo / setatt / mo_df_work / itetclr / eltset get e1 / 1</span>
<span class="s2">cmo / setatt / mo_df_work / itetclr / eltset get e2 / 2</span>
<span class="s2">resetpts / itp</span>
<span class="s2">extract / surfmesh / 1 0 0 / MO_ONE_FRAC_EXTRACT / mo_df_work</span>
<span class="s2">#</span>
<span class="s2">cmo / select / MO_ONE_FRAC_EXTRACT</span>
<span class="s2">eltset / edel / idelem0 / eq / 0</span>
<span class="s2">rmpoint / element / eltset get edel</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">pset / pdel / attribute / dfield_sign / 1 0 0 / gt / 1.e-9</span>
<span class="s2">rmpoint / pset get pdel / inclusive</span>
<span class="s2">rmpoint / compress</span>
<span class="s2">#</span>
<span class="s2"># idelem0, idelem1 are element numbers</span>
<span class="s2"># idface0, idface1 are the face numbers</span>
<span class="s2">#</span>
<span class="s2">cmo / DELATT / MO_ONE_FRAC_EXTRACT / itetclr0</span>
<span class="s2">cmo / DELATT / MO_ONE_FRAC_EXTRACT / itetclr1</span>
<span class="s2">cmo / DELATT / MO_ONE_FRAC_EXTRACT / facecol</span>
<span class="s2">#</span>
<span class="s2"># Don&#39;t keep both sides of the fracture face information.</span>
<span class="s2">#</span>
<span class="s2">cmo / DELATT / MO_ONE_FRAC_EXTRACT / idelem0</span>
<span class="s2">cmo / DELATT / MO_ONE_FRAC_EXTRACT / idface0</span>
<span class="s2">#</span>
<span class="s2">dump / avs2 / FRAC_FILE_OUT  / MO_ONE_FRAC_EXTRACT</span>
<span class="s2">dump / avs2 / FRAC_TABLE_OUT / MO_ONE_FRAC_EXTRACT  / 0 0 0 2</span>
<span class="s2">#</span>
<span class="s2">cmo / delete / MO_ONE_FRAC_EXTRACT</span>
<span class="s2">#</span>
<span class="s2">cmo / status / brief</span>
<span class="s2">#</span>
<span class="s2">finish</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dfm_extract_facets.mlgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating dfm_extract_facets.mlgi file: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">dfm_diagnostics</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eps_offset</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">h</span>
    <span class="n">lagrit_script</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2"># Figure out which cells (tringles) from DFN full_mesh.inp were not reproduced</span>
<span class="s2"># in the DFM tet fracture faces (facets_f1.inp, facets_f2.inp, etc).</span>
<span class="s2">#</span>
<span class="s2">read / avs / full_mesh.inp / mo_full</span>
<span class="s2">#</span>
<span class="s2">read / avs / facets_merged.inp / mo_merge</span>
<span class="s2">#</span>
<span class="s2"># If the above file exists the next lines can be removed.</span>
<span class="s2">#</span>
<span class="s2"># Interpolate does not work well on coincident 2D triangulations. C&#39;est la vie.</span>
<span class="s2"># To work around this turn the facets into prism volumes by giving them a small</span>
<span class="s2"># negative and positive offset and then combine to make prisms. Then you have volume</span>
<span class="s2"># cells to interpolate from.</span>
<span class="s2">#</span>
<span class="s2">#++++++++++++++++++++++++++++++++++++</span>
<span class="s2"># EPS_OFFSET  should be set to ~0.1h</span>
<span class="s2">#</span>
<span class="s2">define / EPS_OFFSET_1  / </span><span class="si">{</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">eps_offset</span><span class="si">}</span>
<span class="s2">define / EPS_OFFSET_2  /  </span><span class="si">{</span><span class="n">eps_offset</span><span class="si">}</span>
<span class="s2">#++++++++++++++++++++++++++++++++++++</span>
<span class="s2">offsetsurf / mo_offset_1 / mo_merge / EPS_OFFSET_1</span>
<span class="s2">cmo / setatt / mo_offset_1 / imt / 1 0 0 / 1</span>
<span class="s2">offsetsurf / mo_offset_2 / mo_merge / EPS_OFFSET_2</span>
<span class="s2">cmo / setatt / mo_offset_2 / imt / 1 0 0 / 2</span>
<span class="s2">addmesh / merge / mo_offset_1_2 / mo_offset_1 / mo_offset_2</span>
<span class="s2">pset / p_bottom / attribute / imt / 1 0 0 / eq / 1</span>
<span class="s2">pset / p_top    / attribute / imt / 1 0 0 / eq / 2</span>

<span class="s2">extrude / mo_extrude / mo_offset_1_2 / interp / 0 / &amp;</span>
<span class="s2">        pset,get,p_bottom / pset,get,p_top</span>

<span class="s2">cmo / delete / mo_merge</span>
<span class="s2">cmo / delete / mo_offset_1</span>
<span class="s2">cmo / delete / mo_offset_2</span>
<span class="s2">cmo / delete / mo_offset_1_2</span>
<span class="s2">cmo / select / mo_extrude</span>
<span class="s2">quality</span>

<span class="s2">cmo / addatt / mo_full / mat_interp / vint / scalar / nelements</span>
<span class="s2">cmo / setatt / mo_full / mat_interp / 1 0 0 / 2</span>
<span class="s2">cmo / setatt / mo_extrude / itetclr / 1 0 0 / 1</span>
<span class="s2">interpolate / map / mo_full mat_interp / 1 0 0 / &amp;</span>
<span class="s2">                    mo_extrude itetclr</span>
<span class="s2">dump / avs / tmp_interpolate.inp / mo_full</span>
<span class="s2">cmo / delete / mo_extrude</span>
<span class="s2">cmo / select / mo_full</span>
<span class="s2">eltset / edelete / mat_interp / eq / 1</span>

<span class="s2">cmo / addatt / mo_full / volume / e_area</span>
<span class="s2">math / sum / mo_full / area_sum / 1,0,0 / mo_full / e_area</span>

<span class="s2">rmpoint / element /  eltset get edelete</span>
<span class="s2">rmpoint / compress</span>
<span class="s2"># Note: If there are no missed cells, this will return:</span>
<span class="s2"># RMPOINT: new point count is            0                                        </span>
<span class="s2"># RMPOINT: new element count is          0                                        </span>

<span class="s2">cmo / status / brief</span>

<span class="s2">cmo / addatt / mo_full / volume / e_area</span>
<span class="s2">math / sum / mo_full / area_sum / 1,0,0 / mo_full / e_area</span>
<span class="s2"># Note: If there are no missed cells, this MO will be empty and this</span>
<span class="s2"># command will return:</span>
<span class="s2"># 0 element attribute: e_area</span>
<span class="s2"># FATAL ERROR: SUM unable to begin.</span>
<span class="s2"># error in command : math/sum/mo_full/area_sum/1,0,0/mo_full/e_area</span>
<span class="s2">#</span>
<span class="s2"># The attributes that are output in this file could be cleaned up so</span>
<span class="s2"># extra unnecessary information is not included.</span>
<span class="s2">cmo / DELATT / mo_full / e_area</span>
<span class="s2">cmo / DELATT / mo_full / mat_interp</span>
<span class="s2">#</span>
<span class="s2"># NOTE: If there are no missed cells, mo_full will be an empty (#nodes=0) MO</span>
<span class="s2"># No file will be written and LaGriT message will be:</span>
<span class="s2"># WARNING: dumpavs             </span>
<span class="s2"># WARNING: nnodes=0 nelements = 0</span>
<span class="s2"># WARNING: No output</span>
<span class="s2">dump / avs / missed_cells_full_mesh.inp / mo_full</span>

<span class="s2">cmo / delete / mo_full</span>

<span class="s2">finish</span>



<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dfm_diagnostics.mlgi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lagrit_script</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating dfm_diagonstics.mlgi file: Complete</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_dfm</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; This function executes the lagrit scripts. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        None    </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>
<span class="sd">    </span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">        None</span>
<span class="sd"> </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Run LaGriT</span>
    <span class="n">mh</span><span class="o">.</span><span class="n">run_lagrit_script</span><span class="p">(</span>
        <span class="s2">&quot;dfm_mesh_fracture_driver.lgi&quot;</span><span class="p">,</span>
        <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">cleanup_mesh_dfm_directory</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Clean up working files from meshing the DFM</span>

<span class="sd">    Parameters</span>
<span class="sd">    ---------------</span>
<span class="sd">        None</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    ---------------</span>
<span class="sd">        None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Cleaning up working directory&quot;</span><span class="p">)</span>
    <span class="c1"># clean up LaGrit Scripts</span>
    <span class="n">lagrit_script_dir</span> <span class="o">=</span> <span class="s2">&quot;dfm_lagrit_files&quot;</span> 
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">lagrit_script_dir</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">lagrit_script_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">lagrit_script_dir</span><span class="p">)</span>
    <span class="n">lagrit_scripts</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*lgi&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">lagrit_scripts</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lagrit_script_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">extra_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dfm_mesh_fracture_driver.lgi.log&#39;</span><span class="p">,</span><span class="s1">&#39;dfm_mesh_fracture_driver.lgi.out&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tmp_interpolate.inp&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">extra_files</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">lagrit_script_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">table_dir</span> <span class="o">=</span> <span class="s2">&quot;tables&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">table_dir</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">table_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">table_dir</span><span class="p">)</span>

    <span class="n">table_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*table&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">table_files</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">table_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="n">facets_dir</span> <span class="o">=</span> <span class="s2">&quot;facets&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">facets_dir</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">facets_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">facets_dir</span><span class="p">)</span>

    <span class="n">facet_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;facets*inp&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">facet_files</span><span class="p">:</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">facets_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>


    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Cleaning up working directory: Complete&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">check_dfm_mesh</span><span class="p">(</span><span class="n">allowed_percentage</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Checks how many elements of the DFN meshing are missinf from the DFM. If the percentage missing is larger than the allowed percentage, then the program exists.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------------</span>
<span class="sd">        allowed_percentage : float</span>
<span class="sd">            Percentage of the mesh allowed to be missing and still continue</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    ----------</span>
<span class="sd">        None</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Checking for missing elements&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;missed_cells_full_mesh.inp&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Missing elements have been found.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Missing elements are in the file &#39;missed_cells_full_mesh.inp&#39; if you want to see them.&quot;</span><span class="p">)</span>
        <span class="c1"># get number of missed elements in the </span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;missed_cells_full_mesh.inp&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">missing_num_elems</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># get the total number of elements</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;full_mesh.inp&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">total_num_elems</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># Compute percentage and compare</span>
        <span class="n">missing_percent</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">missing_num_elems</span><span class="o">/</span><span class="n">total_num_elems</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; Out of </span><span class="si">{</span><span class="n">total_num_elems</span><span class="si">}</span><span class="s2"> elements in the DFN there are </span><span class="si">{</span><span class="n">missing_num_elems</span><span class="si">}</span><span class="s2"> missing from the DFM.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--&gt; That&#39;s </span><span class="si">{</span><span class="n">missing_percent</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> percent of the mesh.&quot;</span><span class="p">)</span>

        <span class="k">if</span>  <span class="n">missing_percent</span> <span class="o">&gt;</span> <span class="n">allowed_percentage</span><span class="p">:</span>
            <span class="n">error</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;*** Error. Missing percent of mesh is larger than tolerance </span><span class="si">{</span><span class="n">allowed_percentage</span><span class="si">}</span><span class="s2"> ***</span><span class="se">\n</span><span class="s2">*** Exitting ***</span><span class="se">\n</span><span class="s2"> &quot;</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; Doesn&#39;t seem to bad. Keep Calm and Carry on.&quot;</span><span class="p">)</span>

    <span class="c1"># if the file &#39;missed_cells_full_mesh.inp&#39; does not exists, this means no elements were missed.  </span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&gt; No missinng elements found. &quot;</span><span class="p">)</span>

<div class="viewcode-block" id="mesh_dfm">
<a class="viewcode-back" href="../../../../../pydfnGen.html#pydfnworks.dfnGen.meshing.dfm.mesh_dfm.mesh_dfm">[docs]</a>
<span class="k">def</span> <span class="nf">mesh_dfm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dirname</span> <span class="o">=</span> <span class="s2">&quot;dfm_mesh&quot;</span><span class="p">,</span> <span class="n">allowed_percentage</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">psets</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cleanup</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot; Creates a conforming mesh of a DFN using a uniform background tetrahedron mesh. The DFN must be meshed using a uniform triangular mesh. (DFN.mesh_network(uniform_mesh = True))</span>

<span class="sd">    Parameters</span>
<span class="sd">    ------------------</span>
<span class="sd">        dirname : string</span>
<span class="sd">            name of working directory. Default : dfm_mesh</span>
<span class="sd">        allowed_percentage : float</span>
<span class="sd">            Percentage of the mesh allowed to be missing and still continue</span>
<span class="sd">        cleanup : bool</span>
<span class="sd">            Clean up working directory. If true dep files are moved into subdirectories</span>

<span class="sd">    Returns</span>
<span class="sd">    ---------------</span>
<span class="sd">        None</span>

<span class="sd">    Notes</span>
<span class="sd">    --------------</span>
<span class="sd">        The final mesh is output in exodus format. This requires that LaGriT is built against exodus.  </span>
<span class="sd">         </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating conforming DFM mesh using LaGriT : Starting&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

    <span class="n">setup_mesh_dfm_directory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">jobname</span><span class="p">,</span> <span class="n">dirname</span><span class="p">)</span>

    <span class="n">center</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;domainCenter&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;domainCenter&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;domainCenter&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span> 
    <span class="n">translate_mesh</span><span class="p">(</span><span class="n">center</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">box_domain</span><span class="p">,</span> <span class="n">num_points_x</span><span class="p">,</span> <span class="n">num_points_y</span><span class="p">,</span> <span class="n">num_points_z</span>  <span class="o">=</span> <span class="n">create_domain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
    <span class="n">dfm_driver</span><span class="p">(</span><span class="n">num_points_x</span><span class="p">,</span> <span class="n">num_points_y</span><span class="p">,</span> <span class="n">num_points_z</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frac</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">box_domain</span><span class="p">,</span> <span class="n">psets</span><span class="p">)</span>
    <span class="n">dfm_box</span><span class="p">(</span><span class="n">box_domain</span><span class="p">)</span>    
    <span class="n">dfm_build</span><span class="p">()</span>
    <span class="n">dfm_fracture_facets</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_frac</span><span class="p">)</span>
    <span class="n">dfm_facets</span><span class="p">()</span>
    <span class="n">dfm_diagnostics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
    <span class="n">create_dfm</span><span class="p">()</span>

    <span class="n">check_dfm_mesh</span><span class="p">(</span><span class="n">allowed_percentage</span><span class="p">)</span>

    <span class="n">translate_mesh</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">center</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cleanup</span><span class="p">:</span>
        <span class="n">cleanup_mesh_dfm_directory</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating conforming DFM mesh using LaGriT : Complete&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span></div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, LANL, LA-UR-17-22216.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>