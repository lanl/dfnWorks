<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>dfnTrans: Docs_PT/ParticleTracking_source/TrackingPart.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="dfnTrans"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">dfnTrans
   </div>
   <div id="projectbrief">Code for Particle Tracking simulations in 3D DFN</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,true,'search.php','Search');
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_tracking_part_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">TrackingPart.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_tracking_part_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;search.h&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_func_def_8h.html">FuncDef.h</a>&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include&lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">struct </span><a class="code" href="structinpfile.html">inpfile</a> {</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>[120];</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;};</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structlagrangian.html">   18</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlagrangian.html">lagrangian</a> </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">   20</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">   21</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">betta</a>;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">   22</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">initx</a>;</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">   23</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">inity</a>;</div><div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">   24</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">initz</a>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;};</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">   28</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlagrangian.html">lagrangian</a> <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">   29</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0, <a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>=0;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">   30</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>, <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>=0, <a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>=0, <a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>=0, <a class="code" href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a>=0, <a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>=0, <a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>=0, <a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a>=1;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">   31</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a7530c338b58fe878c151e5b4a1a16f19">marfa</a>=0, <a class="code" href="_tracking_part_8c.html#a2c8fb935fea8f63cfbb4e768f2f7edb4">plumec</a>=0, <a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>=0, <a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>=0, <a class="code" href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a>=0, <a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>=0, <a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>=0;</div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">   32</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_tracking_part_8c.html#aca9c704b192b82aaa3d33d12882a1c2f">tdrw_porosity</a>=0.0, <a class="code" href="_tracking_part_8c.html#a0779a8c7e2a72abcda717f87b68d4bfc">tdrw_diffcoeff</a>=0.0, <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=0.0, <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=0.0, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=0.0;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structintcoef.html">   33</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a> </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">   35</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[3];</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;};</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">struct </span><a class="code" href="structposit3d.html">posit3d</a> {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[3];</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;};</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structtempout.html">   42</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtempout.html">tempout</a>  </div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">   44</a></span>&#160;{    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>; <span class="comment">// count of the time steps</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">   45</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[2]; <span class="comment">// 2d position of particles on a fracture plane</span></div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">   46</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[3]; <span class="comment">// 3d position of particle in the 3d space</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structtempout.html#abc348407152ab976840ee50d46164a83">   47</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[3]; <span class="comment">//particles velocity, 3d</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">   48</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>; <span class="comment">// number of cell in current particle position</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">   49</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a>; <span class="comment">// number of fracture in current particle position</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">   50</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>; <span class="comment">// particle&#39;s current travel time</span></div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">   51</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>; <span class="comment">// current beta parameter</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">   52</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>; <span class="comment">//particle&#39;s trajectory length</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">   53</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>; <span class="comment">// fluid pressure at particle&#39;s position</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;};</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">   56</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtempout.html">tempout</a> *<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">static</span> FILE *tmp;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">static</span> FILE *wpt;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">static</span> FILE *wpt_att;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">static</span> FILE *wv;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">static</span> FILE *wint;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword">static</span> FILE *diff;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a70ceb6e59ecdae0487126a86c88523bb">   66</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#a70ceb6e59ecdae0487126a86c88523bb">ParticleTrack</a> ()</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    </div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">/*** read output options *****/</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keyword">struct </span><a class="code" href="structinpfile.html">inpfile</a> inputfile;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>[125];</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tort_o=0;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// Output of tortuosity file</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;out_tort:&quot;</span>,9);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        tort_o=0;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            tort_o=1;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// Output of fractures ID</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;out_fract:&quot;</span>,10);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a>=0;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <a class="code" href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a>=1;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    </div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// Determine the subgrid process for particle motion at fracture intersections</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;streamline_routing:&quot;</span>,19);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (res==0){</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a>=0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        printf(<span class="stringliteral">&quot;Fracture Intersection Rule: Streamline Routing \n&quot;</span>); }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">else</span>{printf(<span class="stringliteral">&quot;Fracture Intersection Rule: Complete Mixing \n&quot;</span>);}</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    </div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Output according to trajectory curvature (not every time step)</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;out_curv:&quot;</span>,9);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a>=1;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    </div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// output AVS file for each trajectory</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;out_avs:&quot;</span>,8);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>=1;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    </div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Output ASCII trajectory file</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;out_traj:&quot;</span>,9);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>=1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Output MARFA input file</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;out_marfa:&quot;</span>,10);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <a class="code" href="_tracking_part_8c.html#a7530c338b58fe878c151e5b4a1a16f19">marfa</a>=0;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <a class="code" href="_tracking_part_8c.html#a7530c338b58fe878c151e5b4a1a16f19">marfa</a>=1;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>=1;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <a class="code" href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a>=1;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    </div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// Output PLUMECALC input file</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;out_plumecalc:&quot;</span>,14);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="_tracking_part_8c.html#a2c8fb935fea8f63cfbb4e768f2f7edb4">plumec</a>=0;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="_tracking_part_8c.html#a2c8fb935fea8f63cfbb4e768f2f7edb4">plumec</a>=1;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>=1;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a>=1;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Output Time control planes</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;out_disp:&quot;</span>,9);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>=0;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (res==0 )</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>=1;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    </div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">//if there is an additional output</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>+<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>)==0)</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>=1;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    </div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// Add diffusion time (TDRW)</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;tdrw:&quot;</span>,5);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>=0;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>=1;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;tdrw_porosity:&quot;</span>,14);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <a class="code" href="_tracking_part_8c.html#aca9c704b192b82aaa3d33d12882a1c2f">tdrw_porosity</a>=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;tdrw_diffcoeff:&quot;</span>,15);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="_tracking_part_8c.html#a0779a8c7e2a72abcda717f87b68d4bfc">tdrw_diffcoeff</a>=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="_tracking_part_8c.html#a0779a8c7e2a72abcda717f87b68d4bfc">tdrw_diffcoeff</a>=<a class="code" href="_tracking_part_8c.html#a0779a8c7e2a72abcda717f87b68d4bfc">tdrw_diffcoeff</a>*<a class="code" href="_func_def_8h.html#a5799b26fb87c6d98cd44352eb84a2e7e">timeunit</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// open file with traveling time results of all particles</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    inputfile = <a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;out_time:&quot;</span>,9 );</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    sprintf(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;%s/%s&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    FILE *tp = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a> (<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        fprintf(tp,<span class="stringliteral">&quot;# of time steps, flux weights, total advective travel time, total advective + diffusion time, total diffusion time, beta, total length[m] \n&quot;</span>);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        fprintf(tp,<span class="stringliteral">&quot;# of time steps, flux weights, total travel time, x-, y-, z-final pos, beta, total length[m] \n&quot;</span>);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    </div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">/* output of initial and final positions of particle*/</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    FILE *inp;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    FILE *fnp;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;allparticles_output:&quot;</span>,20);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>=0;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">else</span> </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;       {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;       </div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>=1;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        sprintf(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;%s/initpos&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        inp = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a> (<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        fprintf(inp,<span class="stringliteral">&quot; #of particle, # of cell, # of fracture, x-, y-, z- initial  position, flux weight &quot;</span>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        sprintf(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;%s/finpos&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        fnp = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a> (<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        fprintf(fnp,<span class="stringliteral">&quot; #of particle, # of cell, # of fracture, x-, y-, z- final position, flux weight &quot;</span>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;       }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// open tortuosity file</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">char</span> path[125];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    FILE *tort;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (tort_o&gt;0)</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        sprintf(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;%s/torts.dat&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        tort =  <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a> (<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        fprintf(tort,<span class="stringliteral">&quot;Data for tortuosity calculation: total length of trajectory, x-,y-, z- of initial pos., x-, y-, z- final pos., number of intersections. \n&quot;</span>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// open FractureID file</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    FILE *frac;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a>&gt;0)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        sprintf(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;%s/FractureID&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        frac =  <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a> (<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        fprintf(frac,<span class="stringliteral">&quot;Fractures ID  \n&quot;</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// output in case of tdrw</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;     <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;       inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;tdrw_out:&quot;</span>,9);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>=0;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>=1;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;       }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// Create path for trajectory outputs</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)||(<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1))</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        inputfile = <a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;out_path:&quot;</span>,9 );</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        sprintf(path,<span class="stringliteral">&quot;%s/%s&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a> );</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        </div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        mkdir(path, 0777);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        printf(<span class="stringliteral">&quot;\n All output trajectory files will be written in %s/ \n&quot;</span>, path);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        printf(<span class="stringliteral">&quot; Note: if the directory exists all the files in it will be replaced. \n \n&quot;</span>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// temporary otputs go to external file or memory buffer</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;out_filetemp:&quot;</span>,13);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>=0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>=1;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">//settings for Control Plane/Cylinder Output</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">int</span> out_control=0, out_plane=0, out_cylinder=0;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;ControlPlane:&quot;</span>,13);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    res=<a class="code" href="_func_def_8h.html#a0bbf0ae1391d4e6a5a3fbc8d360d18b3">String_Compare</a>(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        out_plane=1;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        inputfile=<a class="code" href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a>(<span class="stringliteral">&quot;ControlCylinder:&quot;</span>,16);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (inputfile.<a class="code" href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">flag</a>&lt;0)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            out_cylinder=0;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="keywordflow">if</span> (res==0)</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                out_cylinder=1;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    </div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> ((out_cylinder+out_plane)&gt;0)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        out_control=1;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    </div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// reading variables for dispersivity (time-control) calculation</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> time_d=1, kd=1;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">double</span> dtime=0.0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">double</span> epsl=0.0;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>==1)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        inputfile = <a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;out_dtimest:&quot;</span>,12 );</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        time_d=(int)inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        inputfile = <a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;out_dtime:&quot;</span>,10 );</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        dtime=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        </div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        epsl=0.05*dtime;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    </div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">double</span> sumsquares[time_d][2];<span class="comment">//keeps sum of squares, like (x0-x)^2 for all particles</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    FILE * dis;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nd[time_d];</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    </div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordtype">int</span> itime;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">char</span> filetime[15];</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">double</span> inflowcoord=0.0; <span class="comment">//define automatically</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordtype">double</span> outflowcoord=0.0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordtype">double</span> controllength=0.0;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordtype">double</span> wellthick=0.0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">char</span> pathcontrol[125];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordtype">double</span> deltaCP=0, current_CP=0.0;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">int</span> ic, icl=0, idist=0, flowd=0, welld=0;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;       </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>==1)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        </div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">for</span> (ic=0; ic&lt;time_d-1; ic++)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            sumsquares[ic][0]=0.0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            sumsquares[ic][1]=0.0;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            nd[ic]=0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            </div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            sprintf(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;%s/ControlTime_t%d&quot;</span>, <a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>, ic+1);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            dis = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="comment">// fprintf(dis,&quot;positions for longitudinal dispersivity calculation at time %f \n&quot;, (ic+1)*dtime);</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            fclose(dis);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            </div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;dflowdir:&quot;</span>,8);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        flowd=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    </div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// settings for Control Plane / Control Cylinder options</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (out_control==1)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        inputfile = <a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;control_out:&quot;</span>,12 );</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        sprintf(pathcontrol,<span class="stringliteral">&quot;%s/%s&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a> );</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        </div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        mkdir(pathcontrol,0777);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        </div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        </div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;delta_Control:&quot;</span>,14);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        deltaCP=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">if</span> (out_plane==1)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;flowdir:&quot;</span>,8);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            flowd=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            </div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#ae04e94bac8fc762dd97706043f25eaa4">nodezonein</a>[0]-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[0];</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            inflowcoord=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#ae04e94bac8fc762dd97706043f25eaa4">nodezonein</a>[0]-1].<a class="code" href="structvertex.html#a1eff0deab63f96c97ba5098608d65ad3">coord</a>[flowd];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            outflowcoord=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a8e227a7bdba87548413eeac3daae26a6">nodezoneout</a>[0]-1].<a class="code" href="structvertex.html#a1eff0deab63f96c97ba5098608d65ad3">coord</a>[flowd];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            </div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            controllength=fabs(outflowcoord)+fabs(inflowcoord);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            icl=controllength/deltaCP +1;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        </div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span> (out_cylinder==1)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;welldir:&quot;</span>,8);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            welld=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            </div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;lengthtowell:&quot;</span>,13);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            controllength=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            </div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            inputfile=<a class="code" href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a>(<span class="stringliteral">&quot;wellthickness:&quot;</span>,14);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            wellthick=inputfile.<a class="code" href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">param</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">if</span> (deltaCP&lt;wellthick)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                icl=(controllength-wellthick/2)/deltaCP+1;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                icl=controllength/deltaCP +1;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        </div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        </div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    </div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">int</span> cross[icl];</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    </div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    </div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    </div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">/*** define particle&#39;s initial positions **/</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">int</span> numbpart, initweight=0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">/*** set up initial positions of particles ***/</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    numbpart=<a class="code" href="_func_def_8h.html#ae2df2bd90c8d4aa96e508002a36327c9">InitPos</a>();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    printf(<span class="stringliteral">&quot;\n  %ld time steps in the current run \n&quot;</span>, <a class="code" href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    printf(<span class="stringliteral">&quot;\n  Initial number of particles being placed: %d \n&quot;</span>, numbpart);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    inputfile=<a class="code" href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a>(<span class="stringliteral">&quot;flux_weight:&quot;</span>,12);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    res=strncmp(inputfile.<a class="code" href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">filename</a>,<span class="stringliteral">&quot;yes&quot;</span>,3);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> ((res==0)&amp;&amp;(<a class="code" href="_func_def_8h.html#adef0bd5e77533cdd4cdd0bcf0d5dc96b">flag_w</a>==1))</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        initweight=1;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordtype">int</span> i=1, ins=0, intersm=0,curr_n=1, curr_o=1;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordtype">int</span>  t_end=0, fracthit=0;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">struct </span><a class="code" href="structposit3d.html">posit3d</a> particle3dposit, particle3dvelocity;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordtype">int</span> counttimestep=0, prevcell=0, prevfract=0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordtype">double</span> xcop, ycop, zcop, currentlength=0, totallength=0;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">double</span> xx=0, yy=0,zz=0, xinit=0, yinit=0, zinit=0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">/**** calculate initial flux weight of particles *****/</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">/**** works for first 3 options of particles initial positions ******/</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    </div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (initweight==1)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <a class="code" href="_func_def_8h.html#a3ff73fcd11e358801772a4241e99e12d">FlowInWeight</a>(numbpart);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        </div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> percent_done=0;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">/************ LOOP ON PARTICLES  **********/</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>=0; <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>&lt;numbpart; <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>++)</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>=0;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        </div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a> &gt;= (<span class="keywordtype">int</span>)(0.01*numbpart)) &amp;&amp; ( percent_done==0))</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            printf(<span class="stringliteral">&quot;Done %d particles, 1%%. \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            percent_done=1;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a> &gt;= (<span class="keywordtype">int</span>)(0.05*numbpart)) &amp;&amp; ( percent_done==1))</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            printf(<span class="stringliteral">&quot;Done %d particles, 5%%. \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            percent_done=2;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a> &gt;= (<span class="keywordtype">int</span>)(0.25*numbpart)) &amp;&amp; ( percent_done==2))</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            printf(<span class="stringliteral">&quot;Done %d particles, 25%%. \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            percent_done=3;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a> &gt;= (<span class="keywordtype">int</span>)(0.5*numbpart)) &amp;&amp; ( percent_done==3))</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            printf(<span class="stringliteral">&quot;Done %d particles, 50%%.  \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            percent_done=4;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a> &gt;= (<span class="keywordtype">int</span>)(0.75*numbpart)) &amp;&amp; ( percent_done==4))</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        {</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            printf(<span class="stringliteral">&quot;Done %d particles, 75%%. \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            percent_done=5;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        </div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>==1)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="comment">// AVS output (should be optional)</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            sprintf(filename,<span class="stringliteral">&quot;%s/part3D_%d.inp&quot;</span>,path,curr_n);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            wpt = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            fprintf(wpt,<span class="stringliteral">&quot;%10d    %10d    %10d    %10d    %10d\n&quot;</span>, <a class="code" href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a>, 0,0,0,0);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            <span class="comment">//open a separate file for attributes, will be attached to the original AVS later</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            sprintf(filename,<span class="stringliteral">&quot;%s/part3D_%d.att&quot;</span>,path,curr_n);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            wpt_att = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;0008   1    1     1    1    1     1    1   1\n&quot;</span>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;fracture, integer\n&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;time, real\n&quot;</span>);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;velocity, real\n&quot;</span>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;vel_x, real\n&quot;</span>);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;vel_y, real\n&quot;</span>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;vel_z, real\n&quot;</span>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;aperture, real\n&quot;</span>);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;pressure, real\n&quot;</span>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="comment">// ascii output of: 3d positions, 3d velocities, cell, fracture, time and beta</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            sprintf(filename,<span class="stringliteral">&quot;%s/traject_%d&quot;</span>,path,curr_n);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            wv = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            fprintf(wv,<span class="stringliteral">&quot;    Current time step, x-, y-, z- pos., Vx, Vy, Vz at this positions, # of cell, #of fracture, travel time, aperture, beta, intersect. fracture ID, fluid pressure at particle&#39;s position \n&quot;</span>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="comment">// output data on intersections only</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            sprintf(filename,<span class="stringliteral">&quot;%s/inters_%d&quot;</span>,path,curr_n);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            wint = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            fprintf(wint,<span class="stringliteral">&quot;     Current traj. length, travel time, x-, y-, z- pos., fracture ID, beta, fluid pressure at part.pos. \n&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1) &amp;&amp; (<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1))</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        {</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            sprintf(filename,<span class="stringliteral">&quot;%s/tdrw_%d&quot;</span>,path,curr_n);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            diff = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            fprintf(diff,<span class="stringliteral">&quot;       Advective travel time on the fracture, Diffusion time on the fracture, Total travel time on the fracture, fracture ID, Accumulative advective travel time, Accumulative total time, Accumulative diffusion time \n&quot;</span>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// define capacity for temp data used for outputs</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordtype">int</span> capacity= (int) <a class="code" href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a>/10;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>=!1)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            time_d=1;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        </div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordtype">double</span> part_squares[time_d][3];</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>=!1)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            <span class="keywordflow">for</span> (ic=0; ic&lt;time_d; ic++)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                part_squares[ic][0]=0.0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                part_squares[ic][1]=0.0;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                part_squares[ic][2]=0.0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">// control plane/cylinder output</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        </div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        t_end=0;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        intersm=0;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">/* define  an initial cell  */</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        ins=0;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        </div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            ins=1;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            ins=<a class="code" href="_func_def_8h.html#a461479d92dd1f67c7ef94fa953186860">InitCell</a>();</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (ins==0)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            printf(<span class="stringliteral">&quot;Initial cell is not found for particle %d %f %f in fract %d. \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>+1, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="comment">// set up initial values for Lagrangian variables</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>=0.0;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">betta</a>=0.0;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            prevcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            prevfract=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fract_id[<a class="code" href="_func_def_8h.html#accb317d0fcd1e5a1683184b91a49ff11">nfract</a>], <span class="keywordtype">id</span>=0;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">id</span>=0; <span class="keywordtype">id</span>&lt;<a class="code" href="_func_def_8h.html#accb317d0fcd1e5a1683184b91a49ff11">nfract</a>; <span class="keywordtype">id</span>++)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                fract_id[<span class="keywordtype">id</span>]=0;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            </div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            fract_id[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordtype">int</span> stuck=0, stuckcell=0, cur_ind=0, cur_node=0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>=0;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>=0;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            counttimestep=0;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            xinit=0.0;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            yinit=0.0;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            zinit=0.0;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            fracthit=0;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="comment">// output particles initial positions (in 3D)</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            particle3dposit=<a class="code" href="_func_def_8h.html#aa8cd5b8e207b47b4a0ad1052040d16e9">CalculatePosition3D</a>();</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            xcop=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0];</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            ycop=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1];</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            zcop=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2];</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            xinit=xcop;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            yinit=ycop;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            zinit=zcop;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">initx</a>=xinit;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">inity</a>=yinit;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">initz</a>=zinit;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            kd=1;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordtype">double</span> tautau=0.0;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="keywordtype">double</span> beta=0.0;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">if</span>  (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>&gt;0)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                fprintf(inp,<span class="stringliteral">&quot;\n %d  %d  %d %5.12E %5.12E %5.12E %5.12E&quot;</span>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>+1, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#ad50f20b01e37af1fedfd7bbe0cd1d7e3">fl_weight</a>);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            totallength=0.0;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            currentlength=0.0;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="comment">//counts for control plane/time output</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            FILE* tmp2;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">if</span> (out_control==1)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">for</span>  (ic=0; ic&lt;icl; ic++)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    cross[ic]=0;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                }</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                idist=0;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                sprintf(filename,<span class="stringliteral">&quot;%s/part_control_%d&quot;</span>,pathcontrol, curr_n);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                tmp2=<a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    fprintf(tmp2,<span class="stringliteral">&quot; x-, y-, z- position, Vx, Vy, Vz, trajectory length, fracture ID , aperture,   Accumulative advective travel time, Accumulative total time, Accumulative diffusion time \n&quot;</span>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    fprintf(tmp2,<span class="stringliteral">&quot; travel time, x-, y-, z- position, Vx, Vy, Vz, trajectory length, #  of current fracture, aperture \n&quot;</span>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <span class="keywordflow">if</span> (out_plane==1)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                        </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                        fprintf(tmp2,<span class="stringliteral">&quot;  %5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E   %5.12E  %5.12E  %5.12E \n&quot;</span>, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                        </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                        fprintf(tmp2,<span class="stringliteral">&quot;%5.12E  %5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E\n&quot;</span>,<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                    </div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    <span class="keywordflow">if</span> (inflowcoord&lt;0)</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        current_CP=inflowcoord+deltaCP;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                        current_CP=inflowcoord-deltaCP;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="keywordflow">if</span> (out_cylinder==1)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    current_CP=controllength;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>&gt;0)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            {</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                sprintf(filename,<span class="stringliteral">&quot;%s/tempdata_%d&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>, <a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                tmp=<a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>=0; <span class="comment">//for temp data allocation</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=0; <span class="comment">//for tdrw calculation; starting time</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=0.0;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=0.0;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>=0; <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>&lt;<a class="code" href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a>; <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>++)</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                particle3dposit=<a class="code" href="_func_def_8h.html#aa8cd5b8e207b47b4a0ad1052040d16e9">CalculatePosition3D</a>();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                xx=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0]-xcop;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                yy=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1]-ycop;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                zz=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2]-zcop;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                currentlength=sqrt(xx*xx+yy*yy+zz*zz);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                totallength=totallength+currentlength;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                xcop=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0];</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                ycop=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1];</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                zcop=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2];</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                    particle3dvelocity=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                    {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                        fprintf(tmp,<span class="stringliteral">&quot;%05d  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %05d  %05d  %5.12E  %5.12E  %5.12E  %5.12E \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>, beta, totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>==0)</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>=(<span class="keyword">struct </span><a class="code" href="structtempout.html">tempout</a>*) malloc (capacity*<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structtempout.html">tempout</a>));</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                        </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>==NULL)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                            printf(<span class="stringliteral">&quot;Allocation memory problem - tempdata\n&quot;</span>);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                            printf(<span class="stringliteral">&quot;timecounter %d time %d capacity %d\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>, <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, capacity);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                            </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        particle3dvelocity=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                       </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>=<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[0]= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[1]= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[0]= particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0];</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[1]= particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1];</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[2]= particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2];</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[0]= particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0];</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[1]= particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1];</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[2]= particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2];</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a> = <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>= beta;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>=totallength;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>++;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                        </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                        <span class="comment">// if memory should be reallocated</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>==capacity)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                            </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                            capacity=2*capacity;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                            <span class="keywordflow">if</span> (capacity &gt;= <a class="code" href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a>)</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                            {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                printf(<span class="stringliteral">&quot;overload\n&quot;</span>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                t_end=<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                free(<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                            }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>=(<span class="keyword">struct </span><a class="code" href="structtempout.html">tempout</a>*)realloc(<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structtempout.html">tempout</a>)*capacity);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>==NULL)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                            {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                                printf(<span class="stringliteral">&quot;REAllocation memory problem - tempdata\n&quot;</span>);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                printf(<span class="stringliteral">&quot;timecounter %d time %d capacity %d\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>, <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, capacity);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                            }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                        }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                        </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    </div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="comment">//calculations for dispersivity: square of (xo-x) is calculated for transverse disersivity only</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="comment">// for longitudinal dispersivity we save the actual coordination of the particle (commented out)</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordtype">double</span> ctime=0.0;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>==1)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                    ctime=kd*dtime;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <span class="keywordflow">if</span> (((ctime-epsl)&lt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time) &amp;&amp; ((ctime+epsl)&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time))</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                      </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                        <span class="comment">// 3d position of particle</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        part_squares[kd-1][0]=xcop;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                        part_squares[kd-1][1]=ycop;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        part_squares[kd-1][2]=zcop;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                        </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                        <span class="keywordflow">if</span> (kd&lt;time_d) kd++;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                <span class="comment">/***** output data at each control plane ********/</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                <span class="keywordtype">double</span> welldist=0.0; <span class="comment">//shortest distance from particle to well</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                <span class="keywordflow">if</span> (out_control==1)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                    <span class="keywordflow">if</span> (out_plane==1)</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                        <span class="keywordflow">if</span> (( (inflowcoord&lt;0) &amp;&amp; (cross[idist]==0) &amp;&amp; (particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[flowd] &gt;=current_CP)) || ( (inflowcoord&gt;0) &amp;&amp; (cross[idist]==0) &amp;&amp; (particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[flowd] &lt;=current_CP)))</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        {</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                            </div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                            cross[idist]=1;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            </div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>==1)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                particle3dvelocity=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                            </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                            {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>-<a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                                <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=<a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a>(<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a> +<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>+<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                                </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                fprintf(tmp2,<span class="stringliteral">&quot;%5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E   %5.12E  %5.12E  %5.12E \n&quot;</span>, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                            }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                            {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                fprintf(tmp2,<span class="stringliteral">&quot;%5.12E  %5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E\n&quot;</span>,<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                            }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                            </div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                            </div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                            </div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                            <span class="keywordflow">if</span> (inflowcoord&lt;0)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                current_CP=current_CP+deltaCP;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                                current_CP=current_CP-deltaCP;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                            idist=idist+1;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                            </div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    }</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    <span class="keywordflow">if</span> ((out_cylinder==1)&amp;&amp;(current_CP&gt;=wellthick/2))</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                    {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                        </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                        <span class="keywordflow">if</span> (welld==0)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                            welldist=sqrt(ycop*ycop+zcop*zcop);</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                        <span class="keywordflow">if</span> (welld==1)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                            welldist=sqrt(xcop*xcop+zcop*zcop);</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                        <span class="keywordflow">if</span> (welld==2)</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                            welldist=sqrt(xcop*xcop+ycop*ycop);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        </div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        <span class="keywordflow">if</span> ((cross[idist]==0) &amp;&amp; (welldist&lt;=current_CP))</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                        {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                            </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                            </div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                            cross[idist]=1;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>==1)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                particle3dvelocity=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                            </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                            fprintf(tmp2,<span class="stringliteral">&quot;%5.12E  %5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E\n&quot;</span>,<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, xcop, ycop,zcop, particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                            </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                            current_CP=current_CP-deltaCP;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                            idist=idist+1;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                        }</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                    }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                </div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <span class="comment">/*** if particle is on intersection cell **/</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <span class="comment">/*** check distance to intersection ***/</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].intcell==1) || (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].intcell==3))</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                    intersm=<a class="code" href="_tracking_part_8c.html#a92f5b1ab36094a7f2007161931bb0fdb">CheckDistance</a> ();</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                    prevcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                    </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                <span class="comment">/*** if particle&#39;s new cell was not found move to the next particle ***/</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                    </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                </div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                <span class="comment">/*** Get new particle&#39;s velocity ***/</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                </div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                </div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <a class="code" href="_tracking_part_8c.html#aeab4f78b54bf9ba581dcc8f5246d658d">PredictorStep</a>();</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                <span class="comment">/*** Calculate new weights and check if particle is in new cell ***/</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                </div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                <a class="code" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a>();</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>==1))</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                </div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].intcell!=1)&amp;&amp;(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].intcell!=3))</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                    <span class="comment">/*** Get new particle&#39;s position ***/</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        </div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a31b6a7f477cbead6448a5c27a867f86d">CorrectorStep</a>();</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                        <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a> = <a class="code" href="_tracking_part_8c.html#a9fbd79304ae6c1759d1e903f5626ab87">CalculateLagrangian</a>(xcop,ycop,zcop,<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">initx</a>, <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">inity</a>, <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">initz</a>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    tautau=tautau+<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    beta=beta+<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">betta</a>;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>+<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>!=1)&amp;&amp;(<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>!=3))</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                        <span class="comment">//      printf(&quot;%5.8e % 5.8e %d \n&quot;, particle[np].velocity[0], particle[np].velocity[1], particle[np].cell);</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        <span class="comment">//                  printf(&quot;cell=0 %d for particle %d at time %d after predictor step \n&quot;,particle[np].cell, np+1, t );</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                        </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>==1)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                            <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)&amp;&amp; (<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>==3))</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                            {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                                <a class="code" href="_tracking_part_8c.html#a3655e04df015e152f63d69abfbf9fdee">Moving2NextCellBound</a>(prevcell);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                            }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                    }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="comment">/*** Calculate new weights and check if particle is in new cell ***/</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                    <a class="code" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a>();</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)&amp;&amp; (<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>==3))</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                {</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a3655e04df015e152f63d69abfbf9fdee">Moving2NextCellBound</a>(prevcell);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                </div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=prevcell) &amp;&amp; (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0))</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                {</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    counttimestep=0;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                    prevcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    <span class="keywordflow">if</span> (prevfract!=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                    {</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        stuck=0;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        stuckcell=0;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                        cur_ind=0;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                        cur_node=0;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                        prevfract=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        fracthit=fracthit+1;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                        <span class="keywordflow">if</span> (fracthit &gt; <a class="code" href="_func_def_8h.html#accb317d0fcd1e5a1683184b91a49ff11">nfract</a>)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                        }</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        fract_id[fracthit]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        </div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                        <span class="comment">//         printf(&quot; %d %d %15.8e \n&quot;,np+1, prevfract, particle[np].time);</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                    }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                }</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==prevcell)</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                        counttimestep++;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        <span class="comment">/**** The number of time steps that particle spent in one cell is counted.</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">                         If particles spent more than 1/10 of the total time steps given by user for the entire path, then the particle is considered to be stuck and the time lopp ends. ****/</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                        <span class="keywordflow">if</span> (counttimestep &gt; (<span class="keywordtype">int</span>)<a class="code" href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a>/10.0)</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                        {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                            <span class="comment">//                           printf(&quot;stuck %05d %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %05d %05d %5.12E %d %d\n&quot;,t+1,particle[np].position[0], particle[np].position[1], particle3dposit.cord3[0], particle3dposit.cord3[1],particle3dposit.cord3[2],particle3dvelocity.cord3[0], particle3dvelocity.cord3[1],particle3dvelocity.cord3[2],particle[np].cell, particle[np].fracture, particle[np].time, counttimestep, (int)timesteps/3.0);</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                        }</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    }</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                t_end=<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                </div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="comment">/*** if particle&#39;s new cell was not found move to the next particle ***/</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=0;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            } <span class="comment">//end of loop on time steps</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <span class="comment">/********** Final outputs ***************/</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">/***** if particle did not go out through flow-out zone ****/</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>==0)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            {</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>==0)          </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;               {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    fclose(tmp);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                    <span class="keywordtype">int</span> status;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    sprintf(filename,<span class="stringliteral">&quot;%s/tempdata_%d&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                    status = remove(filename);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                   </div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                    </div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                <span class="keywordflow">if</span> (out_control==1)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                    fclose(tmp2);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                }</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;               }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;               <span class="keywordflow">else</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                curr_o++;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            }</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            </div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <span class="comment">/**** if particle went out through flow out zone ****/</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>==1)|| (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>==1)) </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                        </div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a> !=0)</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                        {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                            </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                            <a class="code" href="_tracking_part_8c.html#aff6510d8f65513c2356dc171c2191086">FinalPosition</a>();</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                        particle3dposit=<a class="code" href="_func_def_8h.html#aa8cd5b8e207b47b4a0ad1052040d16e9">CalculatePosition3D</a>();</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                        particle3dvelocity=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                        </div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                        {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                            fprintf(tmp,<span class="stringliteral">&quot;%05d  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %05d  %05d  %5.12E  %5.12E  %5.12E  %5.12E \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>, beta, totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                            </div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                        }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                        {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                            </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>=<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[0]= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[1]= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[0]= particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0];</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[1]= particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1];</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[2]= particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2];</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[0]= particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0];</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[1]= particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1];</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[2]= particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2];</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a> = <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>= <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>= beta;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>=totallength;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[<a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>].<a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        }</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                        </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                        <a class="code" href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b">ParticleOutput</a>(<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, 0);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        {</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                            fclose(tmp);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                            <span class="keywordtype">int</span> status;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                            sprintf(filename,<span class="stringliteral">&quot;%s/tempdata_%d&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                            status = remove(filename);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                    {</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a> !=0)</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                        {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                            </div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                            <a class="code" href="_tracking_part_8c.html#aff6510d8f65513c2356dc171c2191086">FinalPosition</a>();</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                        }</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                        particle3dposit=<a class="code" href="_func_def_8h.html#aa8cd5b8e207b47b4a0ad1052040d16e9">CalculatePosition3D</a>();</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                        </div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                        </div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                    }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    </div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                    {</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                        <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>-<a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                        <span class="comment">//  printf(&quot;%d  %lf   %lf   %lf \n&quot;, np+1, t_adv, particle[np].time, t_adv0);</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                        </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                        <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=<a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a>(<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a> +<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>+<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                         <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1)</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                        fprintf(diff, <span class="stringliteral">&quot;%5.12E  %5.12E  %5.12E  %d  %5.12E  %5.12E  %5.12E \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_adv_diff, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_diff);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                    }</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    <span class="comment">//adding data to dispersivity</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    </div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    </div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    <span class="keywordflow">for</span> (ic=0; ic&lt;kd-1; ic++)</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                    {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                        nd[ic]++;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                        </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        </div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a>==1)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                        {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                            sprintf(filename,<span class="stringliteral">&quot;%s/dispers_t%d&quot;</span>, <a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>, ic+1);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                            dis = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;r+&quot;</span>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                            fseek(dis, 0, SEEK_END);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            fprintf(dis,<span class="stringliteral">&quot;%f %f %f \n&quot;</span>, part_squares[ic][0], part_squares[ic][1], part_squares[ic][2]);</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                          </div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                            fclose(dis);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                        }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                    }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                    </div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                    {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                        <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a> = <a class="code" href="_tracking_part_8c.html#a9fbd79304ae6c1759d1e903f5626ab87">CalculateLagrangian</a>(xcop,ycop,zcop,<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">initx</a>, <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">inity</a>, <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">initz</a>);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                        tautau=tautau+<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                        beta=beta+<a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">betta</a>;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                    }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    </div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    xx=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0]-xcop;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    yy=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1]-ycop;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    zz=particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2]-zcop;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                    </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    currentlength=sqrt(xx*xx+yy*yy+zz*zz);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    </div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    totallength=totallength+currentlength;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                    </div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    sprintf(filename,<span class="stringliteral">&quot;%s/initpos&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>==1)</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                    {</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                        fprintf(fnp,<span class="stringliteral">&quot;\n %d  %d  %d  %5.12E  %5.12E  %5.12E   %5.12E &quot;</span>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>+1, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#ad50f20b01e37af1fedfd7bbe0cd1d7e3">fl_weight</a>);                               <span class="keywordflow">else</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                        fprintf(fnp,<span class="stringliteral">&quot;\n %d  %d  %d &quot;</span>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>+1, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>);   </div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    }                    </div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                    <span class="comment">/*******  output travel time *****/</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                        </div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                        fprintf(tp,<span class="stringliteral">&quot;%d  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  \n&quot;</span>,t_end, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].fl_weight, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_adv_diff, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_diff, beta, totallength);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        fprintf(tp,<span class="stringliteral">&quot;%d  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E  %5.12E \n&quot;</span>,t_end, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].fl_weight, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], beta, totallength);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                    </div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    </div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                    <span class="keywordflow">if</span> (tort_o&gt;0)</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                    {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                        fprintf(tort,<span class="stringliteral">&quot;%5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E  %d\n&quot;</span>,totallength, xinit, yinit, zinit, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], fracthit);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                    }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                    </div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    </div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a>&gt;0)</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                    {</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                        <span class="keywordtype">id</span>=0;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                        <span class="keywordflow">do</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                        {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                            fprintf(frac,<span class="stringliteral">&quot;%d  &quot;</span>, fract_id[<span class="keywordtype">id</span>]);</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                            <span class="keywordtype">id</span>++;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        <span class="keywordflow">while</span> (fract_id[<span class="keywordtype">id</span>]!=0);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        fprintf(frac,<span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                        </div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                    }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    </div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    </div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                    <span class="comment">// output of last control plane - outflow plane</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                    <span class="keywordflow">if</span> (out_control==1)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                        </div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=prevcell;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                        </div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                        particle3dvelocity=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                        </div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                        {</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                            </div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                            <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>-<a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                            <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=<a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a>(<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a> +<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>+<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                            </div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                            fprintf(tmp2,<span class="stringliteral">&quot;%5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E   %5.12E  %5.12E  %5.12E \n&quot;</span>, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>,  <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>);</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                        }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                            </div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                        {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                            fprintf(tmp2,<span class="stringliteral">&quot;%5.12E  %5.12E   %5.12E  %5.12E   %5.12E   %5.12E   %5.12E  %5.12E  %05d  %5.12E\n&quot;</span>,<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dposit.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dvelocity.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], totallength, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                        }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                        fclose(tmp2);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                        </div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                        </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                    }</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                    </div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    </div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    curr_n++;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    </div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>==1)</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                    {</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        <span class="comment">/*** write a connectivity list in inp files ***/</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                        <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>-1; i++)</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        {</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                            fprintf(wpt, <span class="stringliteral">&quot;%10d %5d line %10d %10d\n&quot;</span>, i+1, 1, i+1,i+2);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                        }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        rewind(wpt);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                        fprintf(wpt,<span class="stringliteral">&quot;%10d    %10d    %10d    %10d    %10d\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>-1 ,8,0,0);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                        fclose(wpt);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                        fclose(wpt_att);</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                        <span class="keywordtype">char</span> filename1[125]={0}, filename2[125]={0}, filename3[125]={0}, buffer[500]={0};</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                        <span class="keywordtype">char</span> wspace=<span class="charliteral">&#39; &#39;</span>;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                        sprintf(filename1,<span class="stringliteral">&quot;%s/part3D_%d.inp&quot;</span>,path,curr_n-1);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        sprintf(filename2,<span class="stringliteral">&quot;%s/part3D_%d.att&quot;</span>,path,curr_n-1);</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                        sprintf(filename3,<span class="stringliteral">&quot;%s/part_%d.inp&quot;</span>,path,curr_n-1);</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                        </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                        sprintf(buffer,<span class="stringliteral">&quot;cat%c%s%c%s%c&gt;%c%s&quot;</span>,wspace,filename1, wspace,filename2,wspace,wspace,filename3);</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                        </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                        system (buffer);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                        sprintf(buffer,<span class="stringliteral">&quot;rm%c-f%c%s%c%s  &quot;</span>,wspace,wspace,filename1,wspace,filename2);</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                        system (buffer);</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    </div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            </div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        } <span class="comment">//end if ins!=0 (the initial cell was found)</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        </div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            rewind(wv);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            fprintf(wv,<span class="stringliteral">&quot;%d \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            fclose(wv);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            </div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            fclose(wint);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            </div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1) &amp;&amp;  (<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1))</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        {</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            fclose(diff);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            </div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        }</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;     </div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    } <span class="comment">//end of particle loop</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    </div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>==0)</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    printf(<span class="stringliteral">&quot;\n  Number of particles that went out through flow-out boundary: %d \n&quot;</span>, curr_n-1);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    printf(<span class="stringliteral">&quot;\n  Number of particles completed %d, number of particles that went out through flow-out boundary: %d \n&quot;</span>, curr_n-1, curr_n-1-curr_o);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    fclose(tp);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">if</span> (tort_o&gt;0)</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        fclose(tort);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>&gt;0)</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        fclose(inp);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>&gt;0)</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        fclose(fnp);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a>&gt;0)</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        fclose(frac);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    </div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    sprintf(filename,<span class="stringliteral">&quot;%s/TotalNumberP&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    FILE *tn = <a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a> (filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a>==0)</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    fprintf(tn,<span class="stringliteral">&quot; %10d \n&quot;</span>, curr_n-1);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    fprintf(tn,<span class="stringliteral">&quot; %10d %10d \n&quot;</span>, curr_n-1, curr_n-curr_o-1);</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    fclose(tn);</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    </div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a7530c338b58fe878c151e5b4a1a16f19">marfa</a>==1 || <a class="code" href="_tracking_part_8c.html#a2c8fb935fea8f63cfbb4e768f2f7edb4">plumec</a>==1 )</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        printf(<span class="stringliteral">&quot;\n    Working on additional outputs    \n&quot;</span>);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        <a class="code" href="_func_def_8h.html#a5d25bfed6640fd5e87e0e1f917e25218">OutputMarPlumDisp</a> (curr_n-1, path);</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    }</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    </div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    </div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;}</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03"> 1273</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a>()</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;{</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;   </div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a> lambda;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordtype">int</span> n1=0, n2=0, n3=0, pcell;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">double</span> delta_t;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordtype">int</span> cb=0;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    n1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    n2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    n3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    </div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    delta_t=<a class="code" href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec">CalculateCurrentDT</a>();</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    </div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    </div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <span class="comment">/**** first, calculate weights in the current cell****/</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    </div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    lambda=<a class="code" href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add">CalculateWeights</a>(n1, n2, n3);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    </div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordflow">if</span> ((lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]&lt;=1.)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]&gt;=0.)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]&lt;=1.)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]&gt;=0.)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]&lt;=1.)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]&gt;=0.))</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    {</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="comment">/**** particle is in the current cell ***/</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[0]=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0];</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[1]=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1];</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[2]=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2];</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    }</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="comment">/* particle is not in the current cell ***/</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        pcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordtype">int</span> pfract;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        pfract=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=0;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        </div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <a class="code" href="_tracking_part_8c.html#a3202503f7885b8b7db52a53134351045">SearchNeighborCells</a>(n1,n2,n3);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        cb=0;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==200)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==202))</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            cb=cb+1;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==200)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==202))</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            cb=cb+1;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==200)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==202))</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            cb=cb+1;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">if</span> (cb!=0)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            <span class="comment">//   printf(&quot; Particle %d IS OUT of flow out zone. \n&quot;, np+1);</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=1;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        {</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            cb=0;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            </div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <span class="keywordflow">if</span> (((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==10)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==12)))</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                cb=cb+1;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordflow">if</span> (((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==10)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==12)))</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                cb=cb+1;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordflow">if</span> (((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==10)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==12)))</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                cb=cb+1;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <span class="keywordflow">if</span> ((cb&gt;0)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN!=210)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN!=212)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN!=210)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN!=212)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN!=210)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN!=212))</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            {</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                <span class="comment">//       printf(&quot;Particle %d is out of fracture %f  %f %d %d\n&quot;, np+1, particle[np].position[0], particle[np].position[1], particle[np].fracture, pcell);</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                </div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="comment">/**** if out of fracture -   make a flip in x direction ***/</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                </div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="keywordtype">double</span>  cx, cy;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                cy=1.0;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                cx=-1.0;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[0]*cx;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[1]*cy;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                <a class="code" href="_tracking_part_8c.html#a3202503f7885b8b7db52a53134351045">SearchNeighborCells</a>(n1,n2,n3);</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                </div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                {</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                    <span class="comment">/**** if still  out of fracture -   make a flip in y direction ***/</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                    cy=-1.0;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                    cx=1.0;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[0]*cx;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[1]*cy;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a3202503f7885b8b7db52a53134351045">SearchNeighborCells</a>(n1,n2,n3);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                }</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                </div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=3;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                    </div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                   </div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            }</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            cb=0;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==200))</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                cb=cb+1;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==200))</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                cb=cb+1;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==200))</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                cb=cb+1;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <span class="keywordflow">if</span> (cb!=0)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                <span class="comment">//   printf(&quot; Particle %d IS OUT of flow out zone. \n&quot;, np+1);</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=1;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            }</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                <span class="keywordtype">int</span> ii=0;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                <span class="keywordflow">for</span> (ii=0; ii&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].<a class="code" href="structvertex.html#acf83b561551952403148f73fe032f57b">numneighb</a>; ii++)</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].indnodes[ii]-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].indnodes[ii]-1].typeN==210))</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                    {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        cb++;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=1;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                    }</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                }</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                <span class="keywordflow">if</span> (cb==0)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                    <span class="keywordflow">for</span> (ii=0; ii&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].<a class="code" href="structvertex.html#acf83b561551952403148f73fe032f57b">numneighb</a>; ii++)</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    {</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].indnodes[ii]-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].indnodes[ii]-1].typeN==210))</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                        {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                            cb++;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=1;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                        }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                    }</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                <span class="keywordflow">if</span> (cb==0)</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                {</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                    <span class="keywordflow">for</span> (ii=0; ii&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].<a class="code" href="structvertex.html#acf83b561551952403148f73fe032f57b">numneighb</a>; ii++)</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                    {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                        <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].indnodes[ii]-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].indnodes[ii]-1].typeN==210))</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                        {</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                            cb++;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a>=1;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                        }</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                    }</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                }</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                </div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        }</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div><div class="line"><a name="l01416"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add"> 1416</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a>  <a class="code" href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add">CalculateWeights</a>(int nn1, int nn2, int nn3)</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;{</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;   </div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordtype">double</span> n1x,n1y,n2x,n2y,n3x,n3y, deter;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a> lambda;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    n1x=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nn1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(nn1,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    n1y=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nn1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(nn1,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    </div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    n2x=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nn2-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(nn2,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    n2y=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nn2-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(nn2,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    </div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    n3x=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nn3-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(nn3,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    n3y=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nn3-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(nn3,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    </div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    deter=(n2y-n3y)*(n1x-n3x)+(n3x-n2x)*(n1y-n3y);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    </div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]=((n2y-n3y)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0]-n3x)+(n3x-n2x)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1]-n3y))/deter;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]=((n3y-n1y)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0]-n3x)+(n1x-n3x)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1]-n3y))/deter;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]=1-lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]-lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1];</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    </div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordtype">double</span> eps=10e-5;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">if</span> ((lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]&gt;=-eps) &amp;&amp; (lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]&lt;=eps))</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]=0.0;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keywordflow">if</span> ((lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]&gt;=-eps) &amp;&amp; (lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]&lt;=eps))</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]=0.0;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]=1-lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]-lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1];</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="keywordflow">if</span> ((lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]&gt;=-eps) &amp;&amp; (lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]&lt;=eps))</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]=0.0;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                </div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                <span class="keywordflow">return</span> lambda;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;}</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a3202503f7885b8b7db52a53134351045"> 1450</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#a3202503f7885b8b7db52a53134351045">SearchNeighborCells</a>(<span class="keywordtype">int</span> nn1, <span class="keywordtype">int</span> nn2, <span class="keywordtype">int</span> nn3)</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;{</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    </div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    </div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordtype">int</span> k=0;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    </div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">/*search for cells of the vertex with highest intepolation weight - highest probability that particle is in one of it&#39;s neighbors*/</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[0]&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[1]) &amp;&amp; (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[0]&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[2]))</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        k=nn1;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    </div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[1]&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[0]) &amp;&amp; (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[1]&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[2]))</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        k=nn2;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    </div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[2]&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[1]) &amp;&amp; (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[2]&gt;=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[0]))</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        k=nn3;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    </div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">if</span> (k!=0)</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        </div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <a class="code" href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1">NeighborCells</a> (k);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    </div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">/* if not found, search between neighbors of other two nodes */</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)&amp;&amp;(k!=nn1))</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <a class="code" href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1">NeighborCells</a> (nn1);</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    </div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    </div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)&amp;&amp;(k!=nn2))</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <a class="code" href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1">NeighborCells</a> (nn2);</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    </div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    </div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>==0)&amp;&amp;(k!=nn3))</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        <a class="code" href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1">NeighborCells</a> (nn3);</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    </div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;}</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div><div class="line"><a name="l01487"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a5c8fe8978ce1689f5dcf12bc7b56793d"> 1487</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a5c8fe8978ce1689f5dcf12bc7b56793d">InsideCell</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> numc)</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;{</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a> lambda;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordtype">int</span> nk_1, nk_2, nk_3, inside, nb=0;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    nk_1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[numc-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    nk_2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[numc-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    nk_3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[numc-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordtype">double</span> eps=1e-5;</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    lambda=<a class="code" href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add">CalculateWeights</a>(nk_1, nk_2, nk_3);</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    </div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordtype">int</span> intc=0;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].intcell==4)</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        intc=1;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    </div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    </div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">if</span>((lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]&lt;=1.+eps)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]&gt;=-eps)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]&lt;=1.+eps)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]&gt;=-eps)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]&lt;=1.+eps)&amp;&amp;(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]&gt;=-eps))</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    {</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        inside=1;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[0]=fabs(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]);</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[1]=fabs(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[2]=fabs(lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=numc;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        </div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <span class="comment">/* particle.intcell is a flag of particle being in intersection (=1) or boundary(=2) cell */</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        </div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_1-1].typeN==10)</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            nb++;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_2-1].typeN==10)</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            nb++;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_3-1].typeN==10)</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            nb++;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        </div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        </div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keywordflow">if</span> (nb&gt;1)</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a1747a7b7a63f22656afa1df6462279e8">intcell</a>=2;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a1747a7b7a63f22656afa1df6462279e8">intcell</a>=0;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        </div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">if</span> (((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_1-1].typeN==2) || (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_2-1].typeN==2)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_3-1].typeN==2) ||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_1-1].typeN==12) || (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_2-1].typeN==12)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nk_3-1].typeN==12))&amp;&amp; (intc==0))</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            </div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a1747a7b7a63f22656afa1df6462279e8">intcell</a>=1;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        </div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <span class="keywordflow">if</span> ((nb&gt;0) &amp;&amp; (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].intcell==1))</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a1747a7b7a63f22656afa1df6462279e8">intcell</a>=3;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        </div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        inside=0;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">return</span> inside;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;}</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#aeab4f78b54bf9ba581dcc8f5246d658d"> 1541</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#aeab4f78b54bf9ba581dcc8f5246d658d">PredictorStep</a>()</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;{</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordtype">int</span> n1=0, n2=0, n3=0, v1=0,v2=0,v3=0;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <span class="keywordtype">double</span> delta_t;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    n1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    n2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    n3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    </div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    v1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[0];</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    v2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[1];</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    v3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[2];</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    </div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    delta_t=<a class="code" href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec">CalculateCurrentDT</a>();</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    </div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    </div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    </div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="comment">/*** velocity interpolation ***/</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v1][0]+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v2][0]+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v3][0];</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v1][1]+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v2][1]+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v3][1];</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    </div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].<a class="code" href="structvertex.html#a54ac97be271319fa385aef0685ea0641">pressure</a>+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].<a class="code" href="structvertex.html#a54ac97be271319fa385aef0685ea0641">pressure</a>+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].<a class="code" href="structvertex.html#a54ac97be271319fa385aef0685ea0641">pressure</a>;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    </div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    </div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[0];</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[1];</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    </div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;}</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a31b6a7f477cbead6448a5c27a867f86d"> 1576</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#a31b6a7f477cbead6448a5c27a867f86d">CorrectorStep</a>()</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;{</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordtype">int</span> n1=0, n2=0, n3=0, v1=0,v2=0,v3=0;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="keywordtype">double</span> delta_t;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    n1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    n2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    n3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    </div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    v1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[0];</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    v2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[1];</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    v3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[2];</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    </div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    </div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    delta_t=<a class="code" href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec">CalculateCurrentDT</a>();</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    </div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   </div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    </div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[0];</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]+delta_t*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a70e44829116675e21bda7422f0c2b777">velocity</a>[1];</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;}</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div><div class="line"><a name="l01600"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1"> 1600</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1">NeighborCells</a> (<span class="keywordtype">int</span> k)</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;{</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordtype">int</span> i=0,j,inscell;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;4; j++)</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].fracts[i][j]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>))</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                nc=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[i][j];</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                inscell=<a class="code" href="_tracking_part_8c.html#a5c8fe8978ce1689f5dcf12bc7b56793d">InsideCell</a>(nc);</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            }</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        i++;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    }</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="keywordflow">while</span> ((inscell==0)&amp;&amp;(i&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].numneighb));</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;}</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#ae1803816ac80e7c427387495c19a41c8"> 1622</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#ae1803816ac80e7c427387495c19a41c8">DefineTimeStep</a>()</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;{</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;   </div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordtype">int</span> i;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordtype">double</span>  dotvel1, epsd=1e-10;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="_func_def_8h.html#a0049b706bb5b3980868a5b1e1b3fac0c">nnodes</a>; i++)</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    {</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="keywordtype">short</span> <span class="keywordtype">int</span>  j=0;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;4; j++)</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        {</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            </div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            dotvel1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[j][0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[j][0]+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[j][1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[j][1];</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <span class="keywordflow">if</span> (dotvel1&gt;epsd)</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            {</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                </div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].typeN==10)</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                    </div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                    <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">timestep</a>[j]=0.005*sqrt(((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].pvolume)/<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].aperture)/dotvel1);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                    <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">timestep</a>[j]=0.005*sqrt(((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].pvolume)/<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].aperture)/dotvel1);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;            }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].<a class="code" href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">timestep</a>[j]=0.005*sqrt(((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].pvolume)/<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[i].aperture)/epsd);</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            </div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            }</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        </div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    }</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;   </div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;}</div><div class="line"><a name="l01655"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a92f5b1ab36094a7f2007161931bb0fdb"> 1655</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a92f5b1ab36094a7f2007161931bb0fdb">CheckDistance</a>()</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;{</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">/*** define the intersection segment/line ***/</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordtype">int</span> dn1, dn2, dn3, int1=0, int2=0, int3=0, i, intm=0;</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="keywordtype">int</span> ind_int2, fract_p;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordtype">double</span> px, py, dist, delta_t;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordtype">double</span> cx1=0,cy1=0,cx2=0,cy2=0;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    </div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    dn1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    dn2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    dn3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    delta_t=<a class="code" href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec">CalculateCurrentDT</a>();</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    </div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordtype">int</span> prevcell=0;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    prevcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    </div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    px=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    py=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    </div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">/* distance that particle will make during next step */</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    </div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    dist=sqrt(pow((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[0]*delta_t),2)+pow((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[1]*delta_t),2));</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    </div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="comment">/* check: one edge of cell belongs to intersection line */</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn1-1].typeN==2)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn1-1].typeN==12))</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        int1=dn1;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn2-1].typeN==2)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn2-1].typeN==12))</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    {</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">if</span> (int1!=0)</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            int2=dn2;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            int1=dn2;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    }</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn3-1].typeN==2)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn3-1].typeN==12))</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keywordflow">if</span> (int1!=0)</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            int2=dn3;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            int1=dn3;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    }</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span> ((int1!=0) &amp;&amp; (int2!=0))</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        int3=-1;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    </div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="comment">/* check: only one node of cell belongs to intersection - find the second node in neighboring list */</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">if</span> (int2==0)</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    {</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">for</span>(i=0; i&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#acf83b561551952403148f73fe032f57b">numneighb</a>; i++)</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        {</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            <span class="keywordflow">if</span> (((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].type[i]==2)|| (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].type[i]==12)) &amp;&amp; ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].indnodes[i]-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[0]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].indnodes[i]-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[1]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)))</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            {</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                <span class="keywordflow">if</span> (int2==0)</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                    int2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a82e41673a29352ee0f004ae7890d5266">indnodes</a>[i];</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                    int3=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a82e41673a29352ee0f004ae7890d5266">indnodes</a>[i];</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            }</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;            <span class="keywordflow">if</span> ((int3!=0) &amp;&amp;(int3!=-1))</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        }</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    }</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    </div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">//       printf(&quot;int1 %d int2 %d int3 %d cell %d frac %d \n&quot;, int1, int2, int3, particle[np].cell, particle[np].fracture);</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    </div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="comment">/*** if two nodes on intersection are found. the intersection edge will be defined  *****/</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> ((int1!=0) &amp;&amp; (int2!=0))</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        cx1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(int1,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        cy1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(int1,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        </div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        cx2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int2-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(int2,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        cy2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int2-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(int2,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        </div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        </div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">if</span> ((int1!=0) &amp;&amp; (int2!=0) &amp;&amp; (int3!=0))</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;            </div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            <span class="comment">/* define height of triangle, where the base is intersection segment */</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            <span class="keywordtype">double</span> base, side1, side2, perim, area, height;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            base=sqrt(((cx2-cx1)*(cx2-cx1))+((cy2-cy1)*(cy2-cy1)));</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            side2=sqrt(((cx2-px)*(cx2-px))+((cy2-py)*(cy2-py)));</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            side1=sqrt(((cx1-px)*(cx1-px))+((cy1-py)*(cy1-py)));</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            perim=(side1+side2+base)/2.0;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            area=sqrt(perim*(perim-base)*(perim-side1)*(perim-side2));</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            height=area/(base*0.5);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            </div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="comment">/**** if distance between particle and intersection line is small enough, **/</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            <span class="comment">/****  particle makes an additional step and we check did it cross the intersection line or not**/</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            <span class="comment">/****  if particle crossed intersection,  find the intersection point and move particle there**/</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            </div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            <span class="keywordflow">if</span> (height&lt;=dist)</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            {</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;                <span class="keywordtype">double</span>  pr1, pr2,pr3,pr4, px1, py1,px2,py2;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                px2=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0];</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                py2=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1];</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                </div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                <a class="code" href="_tracking_part_8c.html#aeab4f78b54bf9ba581dcc8f5246d658d">PredictorStep</a>();</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;                px1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;                py1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;   </div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                px1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                py1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                pr1=(px1-cx1)*(py2-cy1)-(py1-cy1)*(px2-cx1);</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                pr2=(cx1-px1)*(cy2-py1)-(cy1-py1)*(cx2-px1);</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                pr3=(px1-cx2)*(py2-cy2)-(py1-cy2)*(px2-cx2);</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                pr4=(cx1-px2)*(cy2-py2)-(cy1-py2)*(cx2-px2);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                </div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                <span class="keywordflow">if</span> ((pr1*pr3&lt;0)&amp;&amp;(pr2*pr4&lt;0))</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                {</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                    </div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;                    <span class="comment">/* particle crossed intersection */</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                    pr1=cx1*cy2-cy1*cx2;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                    pr2=px1*py2-py1*px2;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                    pr3=(cx1-cx2)*(py1-py2)-(cy1-cy2)*(px1-px2);</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                    px=((px1-px2)*pr1-(cx1-cx2)*pr2)/pr3;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                    py=((py1-py2)*pr1-(cy1-cy2)*pr2)/pr3;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;                    </div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=px;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=py;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                    </div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;                    <a class="code" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a>();</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;                    intm=1;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;                    </div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;                    {</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                        {</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[0]!=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                                fract_p=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[0];</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                                fract_p=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[1];</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                            <a class="code" href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b">ParticleOutput</a>(<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, fract_p);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;                        }</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                        </div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                        {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                            <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>-<a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                            <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=<a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a>(<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a> +<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>+<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;                             <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1)</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;                            fprintf(diff, <span class="stringliteral">&quot;%5.12E  %5.12E  %5.12E  %d  %5.12E  %5.12E  %5.12E \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_adv_diff, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_diff);</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                        }</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a5db4b51d7dc78cb8deb4fe9ab4e0a4c6">AcrossIntersection</a> (prevcell, int1, int2, <a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a>);</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                    }</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                  </div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                    </div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            }<span class="comment">//if height</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        }</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        </div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <span class="comment">/* particle is in a cell at the ending point of intersection */</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="keywordflow">if</span> ((int1!=0)&amp;&amp;(int2!=0)&amp;&amp;(int3==0))</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        {</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            </div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="keywordtype">double</span> nposx=0, nposy=0, dist_init=0, dist_fin=0, inout=0;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <span class="keywordtype">int</span> coutf=0;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            </div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            nposx=(cx1+cx2)/2;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            nposy=(cy1+cy2)/2;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            </div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            dist_init=pow((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0]-nposx),2)+pow((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1]-nposy),2);</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            </div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <a class="code" href="_tracking_part_8c.html#aeab4f78b54bf9ba581dcc8f5246d658d">PredictorStep</a>();</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            </div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            dist_fin=pow((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0]-nposx),2)+pow((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1]-nposy),2);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            </div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            </div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            </div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="keywordflow">if</span> (dist_init&gt;=dist_fin)</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            {</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                </div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                <span class="comment">/* particle moves toward the intersection */</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                </div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=nposx;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=nposy;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                </div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                <a class="code" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a>();</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                </div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                intm=1;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                {</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                    prevcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                    </div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                    </div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                    {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[0]!=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                            fract_p=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[0];</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                            fract_p=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[1];</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                        </div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                        <a class="code" href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b">ParticleOutput</a>(<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, fract_p);</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                    }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                    {</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                        <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>-<a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                        <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=<a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a>(<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>);</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a> +<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>+<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                          <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1)</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                        fprintf(diff, <span class="stringliteral">&quot;%5.12E  %5.12E  %5.12E  %d  %5.12E  %5.12E  %5.12E \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_adv_diff, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_diff);</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                    }</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a5db4b51d7dc78cb8deb4fe9ab4e0a4c6">AcrossIntersection</a> (prevcell, int1, int2, <a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a>);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                    </div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                }</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                    </div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                    printf(<span class="stringliteral">&quot;Particle is lost on end of intersection. \n&quot;</span>);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            }</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;            {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;                ind_int2=0;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;                <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#acf83b561551952403148f73fe032f57b">numneighb</a>; i++)</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                {</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].indnodes[i]==int2)</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                    {</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;                        ind_int2=i;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;                    }</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;                }</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                <span class="keywordflow">if</span> (ind_int2==0)</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;                    <span class="comment">//      printf(&quot;ind=0 \n&quot;);</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;                    <span class="keywordflow">for</span> (i=0; i&lt;4; i++)</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                    {</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].fracts[ind_int2][i]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;                        {</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                            <span class="keywordtype">int</span> indc=0;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                            indc=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[ind_int2][i];</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                            inout=<a class="code" href="_tracking_part_8c.html#a6f447de1387b9a1e610decc755e43bd8">InOutFlowCell</a>(indc, int1, nposx,nposy);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                            <span class="keywordflow">if</span> (inout&gt;0)</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                                coutf++;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                            </div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                        }</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                    }</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                </div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                <span class="keywordflow">if</span> (coutf&gt;1)</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                {</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                    </div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=nposx;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=nposy;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                    </div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                    <a class="code" href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a>();</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                    </div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                    intm=1;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0)</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;                    {</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;                        prevcell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;                        </div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                        </div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                        {</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[0]!=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                                fract_p=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[0];</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                            <span class="keywordflow">else</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                                fract_p=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[1];</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                            </div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                            </div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                            <a class="code" href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b">ParticleOutput</a>(<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, fract_p);</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;                        }</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a>==1)</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;                        {</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                            <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>-<a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                            <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=<a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a>(<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                            <a class="code" href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">t_diff</a> +<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;                            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aaa72e564c7052e029003076e0d8768be">t_adv_diff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>+<a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a>==1)</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                            fprintf(diff, <span class="stringliteral">&quot;%5.12E  %5.12E  %5.12E  %d  %5.12E  %5.12E  %5.12E \n&quot;</span>, <a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>, <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>+<a class="code" href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_adv_diff, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].t_diff);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                        }</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                        <a class="code" href="_tracking_part_8c.html#a5db4b51d7dc78cb8deb4fe9ab4e0a4c6">AcrossIntersection</a> (prevcell, int1, int2, <a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a>);</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                    }</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                    </div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;                }</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            }</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            </div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        }</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    }</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">if</span> ((int1==0)||(int2==0))</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="comment">/* there is no node of cell belongs to intersection */</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <span class="comment">//      printf(&quot;Check if %d cell is on intersection %d %d %d %d %d dn %d %d %d  %d. \n&quot;, particle[np].cell, node[dn1-1].typeN, node[dn2-1].typeN, node[dn3-1].typeN, int1, int2, dn1, dn2, dn3,  particle[np].intcell);</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    }</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">return</span> intm;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;}</div><div class="line"><a name="l01949"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a6f447de1387b9a1e610decc755e43bd8"> 1949</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_tracking_part_8c.html#a6f447de1387b9a1e610decc755e43bd8">InOutFlowCell</a>(<span class="keywordtype">int</span> indcell, <span class="keywordtype">int</span> int1, <span class="keywordtype">double</span> nposx, <span class="keywordtype">double</span> nposy)</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;{</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    </div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordtype">double</span> inoutf=0;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordtype">int</span> n1n,n2n,n3n,v1v,v2v,v3v;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a> lambda;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    </div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordtype">double</span> prevpos0=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0], prevpos1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordtype">int</span> prevfract=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, previouscell=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keywordtype">double</span> products=0, product=0;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=nposx;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=nposy;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    </div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    n1n=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    n2n=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    n3n=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    </div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    v1v=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[0];</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    v2v=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[1];</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    v3v=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[2];</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    </div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordtype">int</span> thirdnode=0;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keywordtype">double</span> tnx=0,tny=0;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    </div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].typeN!=12)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].typeN!=2))</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        thirdnode=n1n;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].typeN!=12)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].typeN!=2))</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        thirdnode=n2n;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].typeN!=12)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].typeN!=2))</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        thirdnode=n3n;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    </div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    tnx=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[thirdnode-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[0];</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    tny=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[thirdnode-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[1];</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    </div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keywordtype">double</span> vintx=0, vinty=0, velocx=0, velocy=0;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    </div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    vintx=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_func_def_8h.html#a5445e2c235239b89cc51146de36ca58f">XindexC</a>(int1,indcell-1)];</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    vinty=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_func_def_8h.html#a11a6fda3ecb0ede2c4a9a8e96e23145d">YindexC</a>(int1,indcell-1)];</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;          </div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <a class="code" href="_func_def_8h.html#a6ac46448269e65b5766a3e49942c28e7">ChangeFracture</a>(indcell);</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    </div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    lambda=<a class="code" href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add">CalculateWeights</a>(n1n, n2n, n3n);</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    </div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    velocx=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v1v][0]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v2v][0]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v3v][0];</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    velocy=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v1v][1]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v2v][1]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v3v][1];</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    </div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">/* calculate vector&#39;s cross product to define outgoing and incoming flow cells */</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    product=((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]-tnx)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1]-vinty))-((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0]-vintx)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]-tny));</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    </div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    products=(velocx*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]-vinty))-((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]-vintx)*velocy);</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    inoutf=products*product;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    </div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    </div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=prevpos0;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=prevpos1;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=previouscell;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>=prevfract;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    </div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <span class="keywordflow">return</span> inoutf;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;}</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;</div><div class="line"><a name="l02013"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a5db4b51d7dc78cb8deb4fe9ab4e0a4c6"> 2013</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#a5db4b51d7dc78cb8deb4fe9ab4e0a4c6">AcrossIntersection</a> (<span class="keywordtype">int</span> prevcell, <span class="keywordtype">int</span> int1, <span class="keywordtype">int</span> int2, <span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a>)</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;{</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keyword">struct </span><a class="code" href="structintcoef.html">intcoef</a> lambda;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordtype">int</span>  indj=-1, k,  indcell, cell_win=0, indk=0;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <span class="keywordtype">int</span> n1n,n2n,n3n,v1v,v2v,v3v;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordtype">int</span> prevfrac; <span class="comment">// the fracture of previous cell;</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="keywordtype">int</span> finalfrac; <span class="comment">// the fracture the particle moved at the intersection</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordtype">double</span> speedsq[4]={0.0,0.0, 0.0, 0.0},  velocx, velocy;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <span class="keywordtype">double</span>  products[4]={0.0, 0.0, 0.0, 0.0};</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="keywordtype">int</span> neighborcellind[4]; <span class="comment">//a list of cell indices of all the neighbors</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordtype">int</span> neighborfracind[4]; <span class="comment">// a list of fractures of all the neighbors</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <span class="comment">//int rule =1; // if 0 streamline, 1 complete mixing</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    </div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    prevfrac = <a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[prevcell-1].<a class="code" href="structelement.html#af51b08146a1c495aadf45e7f085e1267">fracture</a>;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <span class="keywordflow">if</span> ((int1!=0)&amp;&amp;(int2!=0))</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    {</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        </div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="comment">/* defines indj - index of current cell in int1 node list */</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        k = 0;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        {</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].indnodes[k]==int2)</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                indj=k;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            k++;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        }</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="keywordflow">while</span> ((indj&lt;0) &amp;&amp; (k&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].numneighb));</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        </div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        <span class="keywordflow">if</span> (indj&lt;0)</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            printf(<span class="stringliteral">&quot; Current cell not found: NODES %d %d pw %f %f %f \n&quot;</span>, int1, int2, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[0], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[1], <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].weight[2]);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        </div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        </div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        <span class="comment">/* the loop on 4 neighboring cells with common edge: int1 - int2 */</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;4; k++)</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        {</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;            </div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][k]!=0)</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;            {</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                indcell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][k];</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                </div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                neighborcellind[k] = indcell;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;                </div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                n1n=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                n2n=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                n3n=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;                </div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                </div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                v1v=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[0];</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                v2v=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[1];</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                v3v=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[indcell-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[2];</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                <span class="keywordtype">int</span> thirdnode=0;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                <span class="keywordtype">double</span> tnx=0,tny=0;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                </div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].typeN!=12)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].typeN!=2))</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;                    thirdnode=n1n;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].typeN!=12)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].typeN!=2))</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                    thirdnode=n2n;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].typeN!=12)&amp;&amp;(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].typeN!=2))</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                    thirdnode=n3n;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                </div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                tnx=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[thirdnode-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[0];</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;                tny=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[thirdnode-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[1];</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;                neighborfracind[k] = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[thirdnode-1].<a class="code" href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">fracture</a>[0]; <span class="comment">// find the fracture of third node:</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                </div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                <span class="keywordtype">double</span> product, vintx=0, vinty=0;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;                </div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                vintx=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_func_def_8h.html#a5445e2c235239b89cc51146de36ca58f">XindexC</a>(int1,indcell-1)];</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                vinty=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_func_def_8h.html#a11a6fda3ecb0ede2c4a9a8e96e23145d">YindexC</a>(int1,indcell-1)];</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                </div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                </div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                <span class="keywordflow">if</span> ((indcell)==prevcell){</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                    indk=k;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                    <span class="comment">//printf(&quot;Found index cell \n&quot;);</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                }</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                </div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                <span class="comment">/**** move to the intersecting  fracture and recalculate coordinations  ***/</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                <a class="code" href="_func_def_8h.html#a6ac46448269e65b5766a3e49942c28e7">ChangeFracture</a>(indcell);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                </div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                lambda=<a class="code" href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add">CalculateWeights</a>(n1n, n2n, n3n);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                </div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                velocx=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v1v][0]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v2v][0]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v3v][0];</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                velocy=lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[0]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v1v][1]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[1]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v2v][1]+lambda.<a class="code" href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">weights</a>[2]*<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3n-1].<a class="code" href="structvertex.html#a92493253fc12b459eb0599ec07c56743">velocity</a>[v3v][1];</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                </div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                <span class="comment">/* calculate vector&#39;s cross product to define outgoing and incoming flow cells */</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                product=((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]-tnx)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[1]-vinty))-((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].position[0]-vintx)*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]-tny));</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                </div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                products[k]=(velocx*(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]-vinty))-((<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]-vintx)*velocy);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                products[k]=products[k]*product;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                speedsq[k]=velocx*velocx+velocy*velocy;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            }</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        }<span class="comment">//loop on k</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        </div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        </div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        </div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;        <span class="comment">//printf(&quot;Speed of each cell: %lf, %lf, %lf, %lf, %lf \n&quot;, sqrt(speedsq[0]), sqrt(speedsq[1]), sqrt(speedsq[2]),(speedsq[3]), sqrt(4));</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a> == 1){</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            <span class="comment">//printf(&quot;Complete Mixing \n&quot;);</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            cell_win=<a class="code" href="_tracking_part_8c.html#a7ff6ac949c292978394b28d9e0a9977b">CompleteMixingRandomSampling</a>(products, speedsq, indj, int1, indk);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        </div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a> == 0){</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <span class="comment">//printf(&quot;Streamline Routing \n&quot;);</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            cell_win =<a class="code" href="_tracking_part_8c.html#a1da16dbc53cf2728df74a0184f76e1ef">StreamlineRandomSampling</a>(products, speedsq, indj, int1, indk, neighborcellind, neighborfracind, prevfrac, prevcell);</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        }</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        </div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <a class="code" href="_func_def_8h.html#a6ac46448269e65b5766a3e49942c28e7">ChangeFracture</a>(cell_win);</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a1747a7b7a63f22656afa1df6462279e8">intcell</a>=4;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        finalfrac = <a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[cell_win-1].<a class="code" href="structelement.html#af51b08146a1c495aadf45e7f085e1267">fracture</a>;</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    }</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;}</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">/**************************************************************************/</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">/******************** Streamline Routing Intersection Rule  ***************************/</span></div><div class="line"><a name="l02142"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a1da16dbc53cf2728df74a0184f76e1ef"> 2142</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a1da16dbc53cf2728df74a0184f76e1ef">StreamlineRandomSampling</a>(<span class="keywordtype">double</span> products[4], <span class="keywordtype">double</span> speedsq[4], <span class="keywordtype">int</span> indj, <span class="keywordtype">int</span> int1, <span class="keywordtype">int</span> indk, <span class="keywordtype">int</span> neighborcellind[4], <span class="keywordtype">int</span> neighborfracind[4], <span class="keywordtype">int</span> prevfrac, <span class="keywordtype">int</span> prevcell)</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;{</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">/*********** Streamline Routing Sampling ****************/</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <span class="keywordtype">int</span> win_cell=0, k, jj;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordtype">int</span> count=0, outc[4]={0,0,0,0};</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordtype">int</span> oppcellind; <span class="comment">// the index of the opposite cell</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordtype">int</span> oppflag = 1; <span class="comment">// opp flag set to 1 is we have outflow on the opposite cell</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordtype">double</span> random_number, totalspeed=0, minsp=0.0, incomingspeedsq=0, speedopp =0, totalmag=0;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    </div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    <span class="comment">/* find outgoing flow cells */</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordflow">for</span> (k=0; k&lt;4; k++)</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <span class="keywordflow">if</span> (products[k]&lt;0)</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        {</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;            outc[count]=k;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            count++;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            totalspeed=totalspeed+speedsq[k]; <span class="comment">//the sum of the speed square of outflowing cells</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            totalmag = totalmag + sqrt(speedsq[k]); <span class="comment">// the sum of speeds of outflowing cells</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            </div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;        }</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        </div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    }</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="comment">/* if no outgoing flow cells found - move to cell with largest velocity magnitude</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">     (this should not happen, it will mean we have a physical flow sink)*/</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">if</span> (count==0)</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    {</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;     <span class="comment">//   printf(&quot;Case 0 \n&quot;);</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        minsp=0.0;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;4; k++)</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            <span class="keywordflow">if</span> ((speedsq[k]&gt;minsp)&amp;&amp;(k!=indk))</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            {</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                minsp=speedsq[k];</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][k];</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;            }</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    }</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="comment">/* if only one cell found */</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordflow">if</span> (count==1)</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    {</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    }</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    </div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    </div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keywordflow">if</span> (count==2)</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    {</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="comment">// loop to find opposite cell. If we find an outflowing opposite cell(cell with same fracture as previous cell), then we are in continuous case and oppflag is set to 1;</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        </div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="keywordflow">for</span> (jj=0; jj&lt;4; jj++){</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;            <span class="keywordflow">if</span> ((neighborfracind[jj]==prevfrac) &amp;&amp; (neighborcellind[jj]==<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[0]] || neighborcellind[jj]==<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[1]])){ <span class="comment">//Opposite flag turned on if: the neighboring cell has the same fracture as the previous cell and that cell is one of the two outflowing cells</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                oppcellind = neighborcellind[jj];</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                oppflag = 1; <span class="comment">//we are in the continous case</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            }</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            </div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <span class="comment">//note this next case only will work if we have continuous case.</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            <span class="keywordflow">if</span> ((neighborfracind[jj]==prevfrac) &amp;&amp; neighborcellind[jj]!=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[0]] &amp;&amp; neighborcellind[jj]!=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[1]]){ <span class="comment">// We find the incoming speed by finding the neighbor cell that shares a fracture with previous cell, and is not outflowing. Note we code this way because in special cases the previous cell is not in the list of cells neighboring the intersection. In this case, we say the incoming velocity is the inflowing cell and has the same fracture of the previous cell.</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                incomingspeedsq = speedsq[jj];</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            }</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            </div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <span class="keywordflow">if</span>(neighborcellind[jj] == prevcell){ <span class="comment">//This is the easier way to find incoming speed: We find the neighboring cell equal to the previous cell and take the speed of that cell.</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                incomingspeedsq = speedsq[jj];</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            }</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            </div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            </div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        } <span class="comment">// end of jj loop</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[1]]].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a> == <a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[0]]].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>){<span class="comment">// if the two outflowing cells have the same fracture we are in the discontinuous case</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            oppflag = 0;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        }</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        </div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        random_number=drand48();</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        <span class="keywordflow">if</span> (oppflag == 1){ <span class="comment">// if oppflag is 1 then one of the outflow cells is opposite (on the same fracture) as the cell we are coming from: The other outflowing cell must be adjacent</span></div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            <span class="comment">// printf(&quot;We are in the continous case \n&quot;);</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="comment">// We need to find which outflowing cell is opposite</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].cells[indj][outc[0]] == oppcellind) { <span class="comment">// opposite cell has index outc[0] and outc[1] is adjacent</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                <span class="keywordflow">if</span> (incomingspeedsq &lt;= speedsq[outc[1]]) <span class="comment">// The adjacent cell has large velocity and so we are forced to the adjacent branch</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                {</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                    win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                }</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                <span class="keywordflow">else</span> { <span class="comment">// the adjacent velocity is not bigger the incoming</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                    <span class="keywordflow">if</span> (random_number &lt;= sqrt(speedsq[outc[1]])/sqrt(incomingspeedsq)){</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                    }</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                    <span class="keywordflow">else</span> {</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                        win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                    }</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                }</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            } <span class="comment">// end first if regarding opposite cell has index outc[0]</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            <span class="keywordflow">else</span> { <span class="comment">// other Continous case scenario: opposite has index outc[1] and adjacent is outc[0]</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                <span class="keywordflow">if</span> (incomingspeedsq&lt;= speedsq[outc[0]]) <span class="comment">//The adjacent cell has large velocity than incoming</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                {</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                    win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                }</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                <span class="keywordflow">else</span> { <span class="comment">// the adjacent (outc[0]) velocity is smaller than incoming</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                    <span class="keywordflow">if</span> (random_number &lt;= sqrt(speedsq[outc[0]])/sqrt(incomingspeedsq))</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                    {</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                        win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                    }</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                    <span class="keywordflow">else</span>{</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                        win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                    }</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                }</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            }<span class="comment">//end case where outc[1] is opposite</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        } <span class="comment">// end continous case</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="keywordflow">else</span>{  <span class="comment">// start discontinous case now: assume complete mixing for now</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            <span class="comment">//printf(&quot;We are in the discontinous case \n&quot;);</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            <span class="comment">//printf(&quot;Speed incoming = %lf: Other Speed incoming = %lf, Outflowing1 =%lf: Outflowing2 =%lf: \n&quot;, sqrt(incomingspeedsq), sqrt(speedsq[outc[0]]) +sqrt(speedsq[outc[1]]) - sqrt(incomingspeedsq),sqrt(speedsq[outc[0]]),sqrt(speedsq[outc[1]]) );</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            <span class="comment">//New Rule</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            <span class="keywordflow">if</span>(sqrt(incomingspeedsq)&gt;=(sqrt(speedsq[outc[0]]) +sqrt(speedsq[outc[1]]))/2){ <span class="comment">//the incoming speed is bigger than oppposite incoming: we are on the larger incoming fracture</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                <span class="keywordflow">if</span>(speedsq[outc[1]]&gt;= speedsq[outc[0]]) <span class="comment">//outgoing cell 1 is bigger than outgoint cell 0</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                {</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                    <span class="comment">//printf(&quot;On high; Prob of switching to high frac: %lf \n&quot;, sqrt(speedsq[outc[1]])/sqrt(incomingspeedsq));</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                    <span class="keywordflow">if</span>(random_number &gt;= sqrt(speedsq[outc[1]])/sqrt(incomingspeedsq))</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                    {win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];}</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                    <span class="keywordflow">else</span>{win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];}</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                }</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                <span class="keywordflow">else</span>{ <span class="comment">//outgoing cell 0 is bigger</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                    <span class="comment">//printf(&quot;On high; Prob of switching to high frac: %lf \n&quot;, sqrt(speedsq[outc[0]])/sqrt(incomingspeedsq));</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                    <span class="keywordflow">if</span>(random_number &gt;= sqrt(speedsq[outc[0]])/sqrt(incomingspeedsq))</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                    {win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];}</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    <span class="keywordflow">else</span>{win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];}</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                }</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            }</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            <span class="keywordflow">else</span>{ <span class="comment">// the incoming speed is smaller than oppoiste incoming</span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                speedopp = sqrt(speedsq[outc[0]]) +sqrt(speedsq[outc[1]]) - sqrt(incomingspeedsq); <span class="comment">// the speed of the larger incoming branch</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                <span class="keywordflow">if</span>(speedsq[outc[1]]&lt;= speedsq[outc[0]]) <span class="comment">//outgoing cell 1 is smaller than outgoing cell 0</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                {</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                    <span class="comment">//printf(&quot;On low; Prob of switching to high frac: %lf \n&quot;, (sqrt(speedsq[outc[0]])-speedopp)/sqrt(incomingspeedsq));</span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                    <span class="keywordflow">if</span>(random_number &lt;= (sqrt(speedsq[outc[0]])-speedopp)/sqrt(incomingspeedsq) &amp;&amp; sqrt(speedsq[outc[0]])&gt;= speedopp)</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                    {win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];}</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;                    <span class="keywordflow">else</span>{win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];}</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;                }</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;                <span class="keywordflow">else</span>{ <span class="comment">//outgoing cell 1 is bigger</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;                    <span class="comment">// printf(&quot;On low; Prob of switching to high frac: %lf \n&quot;, (sqrt(speedsq[outc[1]])-speedopp)/sqrt(incomingspeedsq));</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;                    <span class="keywordflow">if</span>(random_number &lt;= (sqrt(speedsq[outc[1]])-speedopp)/sqrt(incomingspeedsq) &amp;&amp; sqrt(speedsq[outc[1]])&gt;= speedopp)</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;                    {win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];}</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;                    <span class="keywordflow">else</span>{win_cell = <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];}</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                }</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            }</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            </div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            <span class="comment">// End New Rule</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            </div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            </div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            <span class="comment">//Start Old Rule: Complete mixing</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            <span class="comment">/****if (random_number&lt;=(sqrt(speedsq[outc[0]])/totalmag))</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment">             win_cell=node[int1-1].cells[indj][outc[0]];</span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">             else</span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">             win_cell=node[int1-1].cells[indj][outc[1]]; ****/</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            <span class="comment">// End old rule</span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            </div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        } <span class="comment">// end discontinous case</span></div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    }</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    </div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    </div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">if</span> (count==3)</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    {</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        random_number=drand48();</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="keywordflow">if</span> (random_number&gt;((sqrt(speedsq[outc[0]])+sqrt(speedsq[outc[1]]))/totalmag))</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="comment">//      if (random_number&lt;0.3)</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[2]];</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        {</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            <span class="keywordflow">if</span> (random_number&lt;=(sqrt(speedsq[outc[0]])/totalmag))</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                <span class="comment">//         if (random_number&lt;0.6)</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        }</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    }</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    </div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    </div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="keywordflow">if</span> (count==4)</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    {</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        random_number=drand48();</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordflow">if</span> (random_number&gt;((speedsq[outc[0]]+speedsq[outc[1]]+speedsq[outc[2]])/totalspeed))</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[3]];</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        {</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <span class="keywordflow">if</span> (random_number&gt;((speedsq[outc[0]]+speedsq[outc[1]])/totalspeed))</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[2]];</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            {</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                <span class="keywordflow">if</span> (random_number&lt;=(speedsq[outc[0]]/totalspeed))</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                    win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                    win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            }</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        }</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    }</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keywordflow">return</span> win_cell;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;}</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment">/**************************************************************************/</span></div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">/******************** Complete Mixing  Intersection Rule  ***************************/</span></div><div class="line"><a name="l02344"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a7ff6ac949c292978394b28d9e0a9977b"> 2344</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a7ff6ac949c292978394b28d9e0a9977b">CompleteMixingRandomSampling</a>(<span class="keywordtype">double</span> products[4], <span class="keywordtype">double</span> speedsq[4], <span class="keywordtype">int</span> indj, <span class="keywordtype">int</span> int1, <span class="keywordtype">int</span> indk)</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;{</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    <span class="comment">/***********Complete Mixing Sampling ****************/</span></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordtype">int</span> win_cell=0, k;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keywordtype">int</span> count=0, outc[4]={0,0,0,0};</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="keywordtype">double</span> random_number, totalspeed=0, minsp=0.0, totalmag=0;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    </div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    </div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    </div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    <span class="comment">/* find outgoing flow cells */</span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    <span class="keywordflow">for</span> (k=0; k&lt;4; k++)</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    {</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        <span class="keywordflow">if</span> (products[k]&lt;0)</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        {</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            outc[count]=k;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            count++;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            totalspeed=totalspeed+speedsq[k];</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;            totalmag = totalmag + sqrt(speedsq[k]);</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;            </div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        }</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        </div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;    }</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="comment">/* if no outgoing flow cells found - move to cell with largest velocity magnitude</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment">     (this should not happen, it will mean we have a physical flow sink)*/</span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;    <span class="keywordflow">if</span> (count==0)</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    {</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        </div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        minsp=0.0;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;4; k++)</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            <span class="keywordflow">if</span> ((speedsq[k]&gt;minsp)&amp;&amp;(k!=indk))</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            {</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                minsp=speedsq[k];</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][k];</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            }</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    }</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="comment">/* if only one cell found */</span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="keywordflow">if</span> (count==1)</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    {</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    }</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    </div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    </div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="keywordflow">if</span> (count==2)</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    {</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="comment">//printf(&quot;Case 2 \n&quot;);</span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        random_number=drand48();</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        <span class="keywordflow">if</span> (random_number&lt;=(sqrt(speedsq[outc[0]])/totalmag))</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            <span class="comment">//  if (random_number&lt;0.5)</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;            win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        </div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    }</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    </div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <span class="keywordflow">if</span> (count==3)</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    {</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        random_number=drand48();</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordflow">if</span> (random_number&gt;((sqrt(speedsq[outc[0]])+sqrt(speedsq[outc[1]]))/totalmag)){</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            <span class="comment">//      if (random_number&lt;0.3)</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;            win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[2]];</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;            <span class="comment">//printf(&quot;winning cell = %d \n&quot;, win_cell);</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        }</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        {</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            <span class="keywordflow">if</span> (random_number&lt;=(sqrt(speedsq[outc[0]])/totalmag))</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                <span class="comment">//         if (random_number&lt;0.6)</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            </div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        }</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    }</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    </div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    </div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="keywordflow">if</span> (count==4)</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    {</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        random_number=drand48();</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        <span class="keywordflow">if</span> (random_number&gt;((speedsq[outc[0]]+speedsq[outc[1]]+speedsq[outc[2]])/totalspeed))</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[3]];</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        {</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            <span class="keywordflow">if</span> (random_number&gt;((speedsq[outc[0]]+speedsq[outc[1]])/totalspeed))</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[2]];</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            {</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                <span class="keywordflow">if</span> (random_number&lt;=(speedsq[outc[0]]/totalspeed))</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                    win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[0]];</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                    win_cell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[int1-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[indj][outc[1]];</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            }</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        }</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    }</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keywordflow">return</span> win_cell;</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;}</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div><div class="line"><a name="l02440"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6"> 2440</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a> (<span class="keywordtype">int</span> nnp, <span class="keywordtype">int</span> cellnumber)</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;{</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    </div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="keywordtype">double</span> centx=0, centy=0, n1x=0, n2x=0, n3x=0, n1y=0, n2y=0,n3y=0;</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keywordtype">int</span> n1=0, n2=0, n3=0;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    n1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[cellnumber-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    n2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[cellnumber-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    n3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[cellnumber-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    </div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    n1x=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(n1,nnp)];</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    n1y=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(n1,nnp)];</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    </div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    n2x=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(n2,nnp)];</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    n2y=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(n2,nnp)];</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    </div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    n3x=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(n3,nnp)];</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    n3y=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(n3,nnp)];</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    </div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    centx=n1x+n2x+n3x;</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    centy=n1y+n2y+n3y;</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    </div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=centx/3;</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=centy/3;</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;    </div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="keywordtype">int</span> in;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    in=<a class="code" href="_tracking_part_8c.html#a5c8fe8978ce1689f5dcf12bc7b56793d">InsideCell</a> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>);</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    </div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;}</div><div class="line"><a name="l02471"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a9541c2c154a6c03a5bf820ac7522fc04"> 2471</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a9541c2c154a6c03a5bf820ac7522fc04">Moving2NextCell</a> (<span class="keywordtype">int</span> stuck, <span class="keywordtype">int</span> k)</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    </div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="keywordtype">int</span> current_index=0;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="keywordtype">int</span>  j, nc=0, i=0;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    </div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    </div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keywordflow">if</span> (stuck&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].numneighb)</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    {</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        i=stuck;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        </div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        {</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;            <span class="keywordflow">for</span> (j=0; j&lt;4; j++)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].fracts[i][j]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                {</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;                    </div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].cells[i][j]!=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>)</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;                    {</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;                        nc=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[i][j];</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;                        </div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                        current_index=i+1;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                        <span class="comment">//        printf(&quot;current_index %d i %d j %d \n&quot;, current_index, i,j);</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                    }</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;              </div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            }</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160; </div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;            <span class="keywordflow">if</span> (nc!=0)</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            {</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                <span class="comment">//        printf(&quot;particle %d moved from cell %d to cell %d \n&quot;, np+1, particle[np].cell, nc);</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=nc;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                <a class="code" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a> (<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>, nc);</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                </div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            }</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            i++;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        }</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <span class="keywordflow">while</span> ((nc==0)&amp;&amp;(i&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].numneighb));</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    }</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    {</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <span class="comment">//    printf(&quot; &#39;stuck&#39; is too big  \n&quot;);</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    }</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <span class="keywordflow">if</span> (nc==0)</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    {</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        <span class="comment">//   printf(&quot;moving cell was not found part %d fract %d cell %d k %d\n&quot;, np+1, particle[np].fracture, particle[np].cell, k);</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    }</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    </div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">return</span> current_index;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    </div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;}</div><div class="line"><a name="l02527"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec"> 2527</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec">CalculateCurrentDT</a>()</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;{</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    </div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <span class="keywordtype">int</span> dn1=0, dn2=0, dn3=0,  dv1=0, dv2=0, dv3=0;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="keywordtype">double</span> current_delta_t;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    </div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    </div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    dn1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    dn2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    dn3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    </div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    </div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    dv1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[0];</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    dv2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[1];</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    dv3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">veloc_ind</a>[2];</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    </div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    </div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    current_delta_t=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn1-1].<a class="code" href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">timestep</a>[dv1]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[0]+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn2-1].<a class="code" href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">timestep</a>[dv2]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[1]+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[dn3-1].<a class="code" href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">timestep</a>[dv3]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">weight</a>[2];</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    </div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="keywordflow">return</span> current_delta_t;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;}</div><div class="line"><a name="l02550"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0"> 2550</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(<span class="keywordtype">int</span> nodenum, <span class="keywordtype">int</span> nnp)</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;{</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordtype">int</span> xind=0;</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nodenum-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[0]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        xind=0;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nodenum-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[1]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        xind=3;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keywordflow">return</span> xind;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;}</div><div class="line"><a name="l02561"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9"> 2561</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(<span class="keywordtype">int</span> nodenum, <span class="keywordtype">int</span> nnp)</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;{</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keywordtype">int</span> yind=0;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nodenum-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[0]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        yind=1;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nodenum-1].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[1]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[nnp].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        yind=4;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <span class="keywordflow">return</span> yind;</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;}</div><div class="line"><a name="l02572"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a3655e04df015e152f63d69abfbf9fdee"> 2572</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#a3655e04df015e152f63d69abfbf9fdee">Moving2NextCellBound</a>(<span class="keywordtype">int</span> prevcell)</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;{</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;     <span class="keywordtype">int</span> n1=0, n2=0, n3=0;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    n1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[prevcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    n2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[prevcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    n3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[prevcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    </div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="keywordtype">int</span> k, j, nc=0, i=0, nc0=0, nc10=0, nc12=0, ncb=0;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    k=0;</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    </div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==0)</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        k=n1;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    {</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==0)</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            k=n2;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;            k=n3;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    }</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    </div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    </div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    {</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;4; j++)</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        {</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].fracts[i][j]==<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>)</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            {</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                </div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].cells[i][j]!=prevcell)</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                {</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                    nc=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[i][j];</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                    </div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                    </div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[0]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[1]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[2]-1].typeN==0)</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                    {</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                        nc0=nc;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                    }</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[0]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[1]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[2]-1].typeN==10)</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                        nc10=nc;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[0]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[1]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[2]-1].typeN==12)</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                        nc12=nc;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[0]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[1]-1].typeN+<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[nc-1].node_ind[2]-1].typeN &gt;15)</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                        ncb=nc;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                }</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            }</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            </div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        }</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        </div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <span class="keywordflow">if</span> (nc0!=0)</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        {</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            <span class="comment">//    printf(&quot;particle %d moved from boundary cell %d to cell %d \n&quot;, np+1, prevcell, nc0);</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=nc0;</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <a class="code" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a> (<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>, nc0);</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            </div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;        }</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        i++;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    }</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keywordflow">while</span> (i&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[k-1].numneighb);</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    </div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    </div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <span class="keywordflow">if</span> ((nc0==0) &amp;&amp; (nc10!=0))</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    {</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        <span class="comment">//      printf(&quot;particle %d moved from boundary cell %d to cell %d \n&quot;, np+1, prevcell, nc10);</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=nc10;</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        <a class="code" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a> (<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>, nc10);</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    }</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    {</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;        <span class="keywordflow">if</span> ((nc0==0) &amp;&amp; (nc10==0) &amp;&amp; (nc12!=0))</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        {</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            <span class="comment">//    printf(&quot;particle %d moved from boundary cell %d to cell %d \n&quot;, np+1, prevcell, nc12);</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;            <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=nc12;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            <a class="code" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a> (<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>, nc12);</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        }</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        {</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">if</span> ((nc0==0) &amp;&amp; (nc10==0) &amp;&amp; (nc12==0) &amp;&amp; (ncb!=0))</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            {</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                <span class="comment">//        printf(&quot;particle %d moved from boundary cell %d to cell %d \n&quot;, np+1, prevcell, ncb);</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;                <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=ncb;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                <a class="code" href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a> (<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>, ncb);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            }</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;            {</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                <span class="keywordflow">if</span> (nc0 +nc10+nc12+ncb ==0)</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                {</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                    <span class="comment">//      printf(&quot;moving cell from bound was not found part %d fract %d cell %d k %d\n&quot;, np+1, particle[np].fracture, prevcell, k);</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                }</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            }</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    }</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;}</div><div class="line"><a name="l02669"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b"> 2669</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b">ParticleOutput</a> (<span class="keywordtype">int</span> currentt, <span class="keywordtype">int</span> fract_p)</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;{</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    </div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    FILE *tmpp;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="keywordtype">double</span> posit[3]={0.0, 0.0, 0.0}, veloc[3]={0.0, 0.0, 0.0};</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="keywordtype">double</span> startx, starty, endx, endy, midx, midy, time, velocity_t=0.0, obeta=0.0, length_t=0.0;</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <span class="keywordtype">int</span> i,tstart=-1, pcell=0, pfrac=0, tend=0, tmid;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="keywordtype">int</span> time_l, kdiv=2;</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    <span class="keywordtype">double</span> eps=0.05, pressure=0.0;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keyword">struct </span><a class="code" href="structposit3d.html">posit3d</a> particle3dp, particle3dv;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    <span class="keywordtype">char</span> filename[125];</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    {</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        fclose(tmp);</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        </div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        </div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        sprintf(filename,<span class="stringliteral">&quot;%s/tempdata_%d&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        </div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        tmpp=<a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        fscanf(tmpp,<span class="stringliteral">&quot;%d %lf %lf %lf %lf %lf %lf %lf %lf %d %d %lf %lf %lf %lf\n &quot;</span>, &amp;tstart, &amp;startx, &amp;starty, &amp;posit[0], &amp;posit[1], &amp;posit[2], &amp;veloc[0],&amp;veloc[1], &amp;veloc[2], &amp;pcell, &amp;pfrac, &amp;time, &amp;obeta, &amp;length_t, &amp;pressure);</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    }</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    {</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        startx= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[0];</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        starty= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[1];</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        posit[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[0];</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        posit[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[1];</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        posit[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[2];</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        veloc[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[0];</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        veloc[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[1];</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        veloc[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[2];</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        pcell= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        pfrac= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a>;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        time= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        obeta= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        length_t=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;        pressure=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        tstart=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    }</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    </div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        fprintf(wint,<span class="stringliteral">&quot;%5.12E %5.12E  %5.12E   %5.12E  %5.12E %d %5.12E\n&quot;</span>, length_t, time, posit[0], posit[1], posit[2], pfrac, obeta);</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    </div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    </div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    </div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">if</span> (tstart&gt;=0)</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    {</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        </div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a>==1)</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        {</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            <span class="comment">/* output according to trajectory&#39;s curvature */</span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;            endx=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;            endy=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            tend=currentt;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            </div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordflow">if</span> (tstart!=tend)</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            {</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                </div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                {</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                    </div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                    </div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                    </div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                    fprintf(wv,<span class="stringliteral">&quot;%05d  %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %05d %05d %5.12E %5.12E %5.12E %d %5.12E\n&quot;</span>, tstart, posit[0], posit[1], posit[2], veloc[0], veloc[1], veloc[2], pcell, pfrac, time,<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].node_ind[0]-1].aperture, obeta, 0, pressure);</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                    </div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                }</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>++;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>==1)</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                {</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                    </div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                    fprintf(wpt,<span class="stringliteral">&quot;%05d %5.12E %5.12E %5.12E \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, posit[0], posit[1], posit[2]);</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                    velocity_t=sqrt(pow(veloc[0],2)+pow(veloc[1],2)+pow(veloc[2],2));</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                    fprintf(wpt_att,<span class="stringliteral">&quot;%010d  %06d  %5.12E  %5.12E  %5.12E %5.12E  %5.12E  %5.12E  %5.12E\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, pfrac, time, velocity_t, veloc[0], veloc[1], veloc[2], <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].node_ind[0]-1].aperture, pressure);</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                }</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                <span class="keywordtype">int</span> tstep, flag=0, isch=0;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                <span class="keywordtype">double</span> angle_m;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                </div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                <span class="keywordflow">do</span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                {</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                    </div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                    time_l=tend-tstart;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                    kdiv=kdiv*2;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                    tstep=(int) (time_l/2.0);</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                        rewind(tmp);</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                    </div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                    <span class="keywordflow">for</span> (isch=0; isch&lt;time_l; isch++)</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                    {</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                        {</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                            fscanf(tmpp,<span class="stringliteral">&quot;%d %lf %lf %lf %lf %lf %lf %lf %lf %d %d %lf %lf %lf %lf\n &quot;</span>, &amp;tmid, &amp;midx, &amp;midy, &amp;posit[0], &amp;posit[1], &amp;posit[2], &amp;veloc[0],&amp;veloc[1], &amp;veloc[2], &amp;pcell, &amp;pfrac, &amp;time, &amp;obeta, &amp;length_t, &amp;pressure);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                        }</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                        {</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                            tmid= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                            midx= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[0];</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                            midy= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[1];</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                            posit[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[0];</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                            posit[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[1];</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                            posit[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[2];</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                            veloc[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[0];</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                            veloc[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[1];</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                            veloc[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[2];</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                            pcell= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                            pfrac= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a>;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                            time= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                            obeta= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                            pressure=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                            length_t=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>;</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                            </div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                            </div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                        }</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                        <span class="keywordflow">if</span> (tmid==tstart+tstep)</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                        </div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                    }</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                    </div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                    </div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                    angle_m=<a class="code" href="_func_def_8h.html#a3759fb98594fea9a5c180b9d2324e027">DefineAngle</a>(startx-midx, starty-midy, endx-midx, endy-midy);</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                    </div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                    <span class="keywordflow">if</span> (((angle_m&gt;-eps)&amp;&amp; (angle_m&lt;eps)) || ((angle_m&gt;<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>-eps)&amp;&amp; (angle_m&lt;<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>+eps)))</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                    {</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                        </div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                        flag=1;</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                    }</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                    {</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                        tend=tmid;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                        endx=midx;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                        endy=midy;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                        </div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                    }</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                    <span class="keywordflow">if</span> (tend==tstart)</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                    {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                        flag=1;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                    }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;                    </div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                }</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                </div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                <span class="keywordflow">while</span> (flag==0);</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;                </div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                <span class="keywordflow">if</span> (kdiv&lt;10)</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                    kdiv=kdiv*4;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                </div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                time_l=<a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>-tstart;</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                <span class="keywordflow">if</span> (kdiv!=0)</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                    tstep=(int)(time_l/kdiv);</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;                </div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                <span class="keywordflow">if</span> (kdiv&gt;time_l)</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                {</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                    tstep=2;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                    kdiv=(int)time_l/2.0;</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;                }</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                <span class="keywordflow">if</span> (kdiv==0)</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                {</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                    kdiv=2;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                    tstep=1;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                }</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                    rewind(tmp);</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                </div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                <span class="keywordflow">for</span>(i=0; i&lt;kdiv-1; i++)</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                {</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                    </div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                    <span class="keywordflow">for</span> (isch=0; isch&lt;time_l; isch++)</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                        </div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                    {</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                        </div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                        {</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                            fscanf(tmpp,<span class="stringliteral">&quot;%d %lf %lf %lf %lf %lf %lf %lf %lf %d %d %lf %lf %lf %lf\n &quot;</span>, &amp;tmid, &amp;midx, &amp;midy, &amp;posit[0], &amp;posit[1], &amp;posit[2], &amp;veloc[0],&amp;veloc[1], &amp;veloc[2], &amp;pcell, &amp;pfrac, &amp;time, &amp;obeta, &amp;length_t, &amp;pressure);</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                        }</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                        {</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                            tmid= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                            midx= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[0];</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                            midy= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[1];</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                            posit[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[0];</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                            posit[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[1];</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                            posit[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[2];</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                            veloc[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[0];</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                            veloc[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[1];</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                            veloc[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[2];</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                            pcell= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>;</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                            pfrac= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a>;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;                            time= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                            obeta= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                            pressure=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                            length_t=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[isch].<a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>;</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                        }</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                        <span class="keywordflow">if</span> (tmid==tstart+tstep*(i+1))</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;                        </div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;                    }</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                    </div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;                    </div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;                    {</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                        </div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;                        fprintf(wv,<span class="stringliteral">&quot;%05d  %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %05d %05d %5.12E %5.12E %5.12E %d %5.12E\n&quot;</span>, tmid, posit[0], posit[1], posit[2], veloc[0], veloc[1], veloc[2], pcell, pfrac, time, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].node_ind[0]-1].aperture, obeta, 0, pressure);</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                        </div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                    }</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>++;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>==1)</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                    {</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                        </div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                        fprintf(wpt,<span class="stringliteral">&quot;%05d %5.12E %5.12E %5.12E \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, posit[0], posit[1], posit[2]);</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                        velocity_t=sqrt(pow(veloc[0],2)+pow(veloc[1],2)+pow(veloc[2],2));</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                        fprintf(wpt_att,<span class="stringliteral">&quot;%010d  %06d  %5.12E  %5.12E  %5.12E %5.12E  %5.12E  %5.12E %5.12E\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, pfrac, time, velocity_t, veloc[0], veloc[1], veloc[2], <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].node_ind[0]-1].aperture, pressure);</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                        </div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                    }</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                }</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                </div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                </div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            }</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;            </div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        }</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;        {</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            <span class="comment">/* in case of every time step output */</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a>!=1)</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;            {</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                </div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                {</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                    fscanf(tmpp,<span class="stringliteral">&quot;%d %lf %lf %lf %lf %lf %lf %lf %lf %d %d %lf %lf %lf %lf\n &quot;</span>, &amp;tstart, &amp;startx, &amp;starty, &amp;posit[0], &amp;posit[1], &amp;posit[2], &amp;veloc[0],&amp;veloc[1], &amp;veloc[2], &amp;pcell, &amp;pfrac, &amp;time, &amp;obeta, &amp;length_t, &amp;pressure);</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                    rewind(tmp);</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                    time_l=currentt-tstart;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                }</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                {</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                    tstart=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[0].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>;</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                    </div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                    </div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                    time_l=currentt-tstart;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                }</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                <span class="keywordflow">for</span> (i=0; i&lt;time_l; i++)</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                {</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                        fscanf(tmpp,<span class="stringliteral">&quot;%d %lf %lf %lf %lf %lf %lf %lf %lf %d %d %lf %lf %lf %lf\n &quot;</span>, &amp;tstart, &amp;startx, &amp;starty, &amp;posit[0], &amp;posit[1], &amp;posit[2], &amp;veloc[0],&amp;veloc[1], &amp;veloc[2], &amp;pcell, &amp;pfrac, &amp;time, &amp;obeta, &amp;length_t, &amp;pressure);</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;                    {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                        </div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                        tstart= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">times</a>;</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;                        startx= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[0];</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                        starty= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">position2d</a>[1];</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                        posit[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[0];</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                        posit[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[1];</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                        posit[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a389fe2c017890281652d5abc6a608f91">position3d</a>[2];</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                        veloc[0]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[0];</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                        veloc[1]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[1];</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                        veloc[2]= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#abc348407152ab976840ee50d46164a83">velocity3d</a>[2];</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;                        pcell= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a959460ad7a7becc867670385c6540dcd">cellp</a>;</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;                        pfrac= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">fracturep</a>;</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;                        time= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">timep</a>;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;                        obeta= <a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">betap</a>;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;                        pressure=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">pressure</a>;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;                        length_t=<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>[i].<a class="code" href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">length_t</a>;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                    }</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;                    <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>++;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>==1)</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                    {</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                        </div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                        fprintf(wpt,<span class="stringliteral">&quot;%05d %5.12E %5.12E %5.12E \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, posit[0], posit[1], posit[2]);</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                        velocity_t=sqrt(pow(veloc[0],2)+pow(veloc[1],2)+pow(veloc[2],2));</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                        fprintf(wpt_att,<span class="stringliteral">&quot;%010d  %06d  %5.12E  %5.12E  %5.12E %5.12E  %5.12E  %5.12E %5.12E\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, pfrac, time, velocity_t, veloc[0], veloc[1], veloc[2], <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].node_ind[0]-1].aperture, pressure);</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                        </div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                    }</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                        fprintf(wv,<span class="stringliteral">&quot;%05d  %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %05d %05d %5.12E %5.12E %5.12E %d %5.12E\n&quot;</span>, tstart, posit[0], posit[1], posit[2], veloc[0], veloc[1], veloc[2], pcell, pfrac, time, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].node_ind[0]-1].aperture, obeta, 0, pressure);</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                }</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                </div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            }</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        }</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        </div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;        particle3dp=<a class="code" href="_func_def_8h.html#aa8cd5b8e207b47b4a0ad1052040d16e9">CalculatePosition3D</a>();</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        particle3dv=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        </div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a>==1)</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        {</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;            </div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;            fprintf(wv,<span class="stringliteral">&quot;%05d  %5.12E %5.12E %5.12E %5.12E %5.12E %5.12E %05d %05d %5.12E %5.12E %5.12E %d %5.12E\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a>, particle3dp.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dp.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dp.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>, <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>, obeta, fract_p, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>);</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;            </div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        }</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>++;</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a>==1)</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        {</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;            fprintf(wpt,<span class="stringliteral">&quot;%05d %5.12E %5.12E %5.12E \n&quot;</span>,<a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, particle3dp.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dp.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dp.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2]);</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;            </div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;            velocity_t=sqrt(pow(particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0],2)+pow(particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],2)+pow(particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],2));</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;            fprintf(wpt_att,<span class="stringliteral">&quot;%010d  %06d  %5.12E  %5.12E  %5.12E %5.12E  %5.12E  %5.12E %5.12E\n&quot;</span>, <a class="code" href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].time, velocity_t, particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0], particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2], <a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[pcell-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>, <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">pressure</a>);</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;            </div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        }</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    }</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a>==1)</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;    {</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        fclose(tmpp);</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        <span class="keywordtype">int</span> status;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        sprintf(filename,<span class="stringliteral">&quot;%s/tempdata_%d&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;        status = remove(filename);</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a>!=1)</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;        {</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            <span class="keywordflow">if</span>( status != 0 )</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                </div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;            {</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                printf(<span class="stringliteral">&quot;Unable to delete the file %s\n&quot;</span>, filename);</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                perror(<span class="stringliteral">&quot;Error&quot;</span>);</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            }</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;           </div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;            {</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                sprintf(filename,<span class="stringliteral">&quot;%s/tempdata_%d&quot;</span>,<a class="code" href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a>,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>);</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                tmp=<a class="code" href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a>(filename,<span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;            }</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        }</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        </div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    }</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    {</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <a class="code" href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a>=0;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        free(<a class="code" href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a>);</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;    }</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;}</div><div class="line"><a name="l02996"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#aff6510d8f65513c2356dc171c2191086"> 2996</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_tracking_part_8c.html#aff6510d8f65513c2356dc171c2191086">FinalPosition</a>()</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;{</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    </div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="keywordtype">int</span> n1, n2, n3;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="keywordtype">int</span> n1out=0, n2out=0;</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    n1=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0];</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    n2=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1];</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    n3=<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2];</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    </div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;    <span class="keywordtype">double</span> cx1,cx2,cy1,cy2, px1,px2,py1,py2, ap,bp,cp,as,bs,cs, deter,xint,yint;</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    </div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    </div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    </div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==200)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1-1].typeN==202))</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        n1out=n1;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    </div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==200)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2-1].typeN==202))</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    {</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        <span class="keywordflow">if</span> (n1out==0)</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;            n2out=n2;</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            n1out=n2;</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    }</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==200)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n3-1].typeN==202))</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    {</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">if</span> (n2out==0)</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            n2out=n3;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    }</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    </div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordflow">if</span> ((n1out!=0) &amp;&amp; (n2out!=0))</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    {</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;        <span class="comment">//   two vertices of particles cell are on out flow boundary</span></div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        <span class="keywordtype">double</span> cx1,cx2,cy1,cy2, px1,px2,py1,py2, ap,bp,cp,as,bs,cs, deter,xint,yint;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        cx1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1out-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(n1out,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        cy1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n1out-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(n1out,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        </div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        cx2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2out-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(n2out,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;        cy2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[n2out-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(n2out,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        </div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        as=cy2-cy1;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        bs=cx1-cx2;</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        cs=as*cx1+bs*cy1;</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        px1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        py1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        </div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        px2=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0];</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;        py2=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1];</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        </div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        ap=py2-py1;</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        bp=px1-px2;</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        cp=ap*px1+bp*py1;</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        deter=ap*bs-as*bp;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        xint=(bs*cp-bp*cs)/deter;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        yint=(ap*cs-as*cp)/deter;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;        </div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        <span class="keywordtype">double</span> distance=0, tfinal;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        distance=sqrt((xint-px1)*(xint-px1)+(yint-py1)*(yint-py1));</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;        tfinal=distance/sqrt(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[0]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[0]+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[1]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[1]);</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;        </div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=xint;</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=yint;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>=tfinal+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;        </div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;        </div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;        <span class="comment">//     printf(&quot;x %12.5e y %12.5e z %12.5e %d time %5.12e\n&quot;, particle3dposit.cord3[0], particle3dposit.cord3[1],particle3dposit.cord3[2], particle[np].cell, particle[np].time);</span></div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        </div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    }</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    {</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;        <span class="keywordtype">int</span> ncent=0, nnext=0;</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        ncent=n1out+n2out;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        </div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        <span class="keywordflow">if</span> (ncent!=0)</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;        {</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;            </div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;            <span class="keywordtype">int</span> ii=0;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            <span class="keywordflow">for</span> (ii=0; ii&lt;<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].<a class="code" href="structvertex.html#acf83b561551952403148f73fe032f57b">numneighb</a>; ii++)</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;            {</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                </div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].indnodes[ii]-1].typeN==212)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].indnodes[ii]-1].typeN==210)||(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].indnodes[ii]-1].typeN==202))</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                {</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                    </div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;                    nnext=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].<a class="code" href="structvertex.html#a82e41673a29352ee0f004ae7890d5266">indnodes</a>[ii];</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;                    <span class="keywordtype">int</span> newcell=0;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;                    newcell=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].<a class="code" href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">cells</a>[ii][0];</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;                    </div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;                    cx1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(ncent,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                    cy1=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[ncent-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(ncent,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;                    </div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;                    cx2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nnext-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a>(nnext,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                    cy2=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[nnext-1].<a class="code" href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">coord_xy</a>[<a class="code" href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a>(nnext,<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>)];</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                    </div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                    </div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                    as=cy2-cy1;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                    bs=cx1-cx2;</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                    cs=as*cx1+bs*cy1;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                    px1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                    py1=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                    </div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                    px2=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0];</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                    py2=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1];</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;                    </div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;                    ap=py2-py1;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;                    bp=px1-px2;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                    cp=ap*px1+bp*py1;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                    deter=ap*bs-as*bp;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                    xint=(bs*cp-bp*cs)/deter;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;                    yint=(ap*cs-as*cp)/deter;</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                    </div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                    <span class="keywordtype">double</span> distance=0, tfinal;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                    distance=sqrt((xint-px1)*(xint-px1)+(yint-py1)*(yint-py1));</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                    tfinal=distance/sqrt(<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[0]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[0]+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[1]*<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].velocity[1]);</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                    </div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[0]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0];</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">prev_pos</a>[1]=<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1];</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[0]=xint;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">position</a>[1]=yint;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>=tfinal+<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">time</a>;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                    <a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>=newcell;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                    </div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                    <span class="comment">//      printf(&quot;INSIDE! x %12.5e y %12.5e z %12.5e %d time %5.12e\n&quot;, particle3dposit.cord3[0], particle3dposit.cord3[1],particle3dposit.cord3[2], newcell, particle[np].time);</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                    </div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                    </div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                }</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                <span class="keywordflow">if</span> (nnext!=0)</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;            }</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            </div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;            </div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            </div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        }</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;       </div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;        </div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        </div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    }</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    </div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    </div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    </div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;}</div><div class="line"><a name="l03140"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#a9fbd79304ae6c1759d1e903f5626ab87"> 3140</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlagrangian.html">lagrangian</a> <a class="code" href="_tracking_part_8c.html#a9fbd79304ae6c1759d1e903f5626ab87">CalculateLagrangian</a>(double xcurrent, double ycurrent, double zcurrent, double xprev, double yprev, double zprev)</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;{</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;    </div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    <span class="keyword">struct </span><a class="code" href="structlagrangian.html">lagrangian</a> <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    <span class="keyword">struct </span><a class="code" href="structposit3d.html">posit3d</a> particle3dv;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    <span class="keywordtype">double</span> currentdistance=0.0, deltatau=0.0, deltabeta=0.0, velsquare=0.0;</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    particle3dv=<a class="code" href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a>();</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    currentdistance=pow((xcurrent-xprev),2)+pow((ycurrent-yprev),2)+pow((zcurrent-zprev),2);</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    </div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;    velsquare=(pow(particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[0],2)+pow(particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[1],2)+pow(particle3dv.<a class="code" href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">cord3</a>[2],2));</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    </div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    deltatau=currentdistance/velsquare;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    </div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;    </div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <span class="keywordflow">if</span> (currentdistance&gt;0.0)</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    {</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        deltabeta=sqrt(currentdistance)/(sqrt(velsquare)*(<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>*0.5));</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;        <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>=sqrt(deltatau);</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    }</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    {</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        deltabeta=0.0;</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">tau</a>=0.0;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    }</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">betta</a>=deltabeta;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">initx</a>=xcurrent;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">inity</a>=ycurrent;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>.<a class="code" href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">initz</a>=zcurrent;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    </div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    </div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a>;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;}</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;</div><div class="line"><a name="l03175"></a><span class="lineno"><a class="line" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66"> 3175</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a> (<span class="keywordtype">double</span> time_advect)</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;{</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   </div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;    <span class="keywordtype">double</span> randomnumber=0.0;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    randomnumber=drand48();</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;    </div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;    <span class="keywordtype">double</span> term_a=0;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;    <span class="keywordtype">double</span> b=0;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>!=0){</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>-1].node_ind[0]-1].typeN!=2) &amp;&amp; (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>-1].node_ind[0]-1].typeN!=12)){</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;            b=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[0]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        }</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>-1].node_ind[1]-1].typeN!=2) &amp;&amp; (<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>-1].node_ind[1]-1].typeN!=12)){</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;                b=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[1]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>;</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            }</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;            <span class="keywordflow">else</span>{</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                b=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">cell</a>-1].<a class="code" href="structelement.html#aadc95dc4817009223151c40387f40e06">node_ind</a>[2]-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;            }</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;        }</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    }</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        b=<a class="code" href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a>[<a class="code" href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a>[<a class="code" href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a>[<a class="code" href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a>].<a class="code" href="structcontam.html#a0b9253ce268d781958145f9d110df2de">fracture</a>-1].<a class="code" href="structmaterial.html#a82946cb78555ad8c4c14a12fbd7aa3f8">firstnode</a>-1].<a class="code" href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">aperture</a>;</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    }</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    term_a= (<a class="code" href="_tracking_part_8c.html#aca9c704b192b82aaa3d33d12882a1c2f">tdrw_porosity</a>*sqrt(<a class="code" href="_tracking_part_8c.html#a0779a8c7e2a72abcda717f87b68d4bfc">tdrw_diffcoeff</a>))/b;</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    <span class="keywordtype">double</span> inverse_erfc=0.0;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keywordtype">double</span> z;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    z=1.0-randomnumber;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    </div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    inverse_erfc=0.5*sqrt(<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>)*(z+(<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>/12)*pow(z,3)+((7*pow(<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>,2))/480)*pow(z,5)+((127*pow(<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>,3))/40320)*pow(z,7)+((4369*pow(<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>,4))/5806080)*pow(z,9)+((34807*pow(<a class="code" href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a>,5))/182476800)*pow(z,11));</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=0.0;</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    </div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>=pow(((term_a*time_advect)/inverse_erfc),2);</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    <span class="comment">//  printf(&quot;%lf %lf %5.12E %lf %lf %lf\n&quot;, z, tdrw_porosity, tdrw_diffcoeff,inverse_erfc, time_advect, b);</span></div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    </div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a>;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    </div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;}</div><div class="ttc" id="structcontam_html_afdb17185baff7dc4f22cd6c76c6fd6fd"><div class="ttname"><a href="structcontam.html#afdb17185baff7dc4f22cd6c76c6fd6fd">contam::position</a></div><div class="ttdeci">double position[2]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00183">FuncDef.h:183</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a3655e04df015e152f63d69abfbf9fdee"><div class="ttname"><a href="_tracking_part_8c.html#a3655e04df015e152f63d69abfbf9fdee">Moving2NextCellBound</a></div><div class="ttdeci">void Moving2NextCellBound(int prevcell)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02572">TrackingPart.c:2572</a></div></div>
<div class="ttc" id="structtempout_html"><div class="ttname"><a href="structtempout.html">tempout</a></div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00042">TrackingPart.c:42</a></div></div>
<div class="ttc" id="structvertex_html_a7588fad77cf759d8db0957c9e957e23a"><div class="ttname"><a href="structvertex.html#a7588fad77cf759d8db0957c9e957e23a">vertex::aperture</a></div><div class="ttdeci">double aperture</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00157">FuncDef.h:157</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_ab72ec3059b077bf933070124a6f64a03"><div class="ttname"><a href="_tracking_part_8c.html#ab72ec3059b077bf933070124a6f64a03">CheckNewCell</a></div><div class="ttdeci">void CheckNewCell()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01273">TrackingPart.c:1273</a></div></div>
<div class="ttc" id="structposit3d_html_aefc0a716be214a76cae4e2176134c28e"><div class="ttname"><a href="structposit3d.html#aefc0a716be214a76cae4e2176134c28e">posit3d::cord3</a></div><div class="ttdeci">double cord3[3]</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00017">InitialPartPositions.c:17</a></div></div>
<div class="ttc" id="structtempout_html_aac9d83b4e041609a40d2f5c2cf1d1bb5"><div class="ttname"><a href="structtempout.html#aac9d83b4e041609a40d2f5c2cf1d1bb5">tempout::pressure</a></div><div class="ttdeci">double pressure</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00053">TrackingPart.c:53</a></div></div>
<div class="ttc" id="_func_def_8h_html_a922a07b425353141b29d8d57e830a7c1"><div class="ttname"><a href="_func_def_8h.html#a922a07b425353141b29d8d57e830a7c1">Control_Param</a></div><div class="ttdeci">struct inpfile Control_Param(char fileobject[], int ctr)</div><div class="ttdef"><b>Definition:</b> <a href="_read_grid_init_8c_source.html#l01245">ReadGridInit.c:1245</a></div></div>
<div class="ttc" id="_func_def_8h_html_a1daf785e3f68d293c7caa1c756d5cb74"><div class="ttname"><a href="_func_def_8h.html#a1daf785e3f68d293c7caa1c756d5cb74">pi</a></div><div class="ttdeci">#define pi</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00002">FuncDef.h:2</a></div></div>
<div class="ttc" id="structintcoef_html_ab3d267bf2bc81e221bed2ebc1779dbf0"><div class="ttname"><a href="structintcoef.html#ab3d267bf2bc81e221bed2ebc1779dbf0">intcoef::weights</a></div><div class="ttdeci">double weights[3]</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00035">TrackingPart.c:35</a></div></div>
<div class="ttc" id="structvertex_html_a1eff0deab63f96c97ba5098608d65ad3"><div class="ttname"><a href="structvertex.html#a1eff0deab63f96c97ba5098608d65ad3">vertex::coord</a></div><div class="ttdeci">double coord[3]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00115">FuncDef.h:115</a></div></div>
<div class="ttc" id="structlagrangian_html_a75fb1c376f05bb7ba3eaee13cab24067"><div class="ttname"><a href="structlagrangian.html#a75fb1c376f05bb7ba3eaee13cab24067">lagrangian::inity</a></div><div class="ttdeci">double inity</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00023">TrackingPart.c:23</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a92f5b1ab36094a7f2007161931bb0fdb"><div class="ttname"><a href="_tracking_part_8c.html#a92f5b1ab36094a7f2007161931bb0fdb">CheckDistance</a></div><div class="ttdeci">int CheckDistance()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01655">TrackingPart.c:1655</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a0779a8c7e2a72abcda717f87b68d4bfc"><div class="ttname"><a href="_tracking_part_8c.html#a0779a8c7e2a72abcda717f87b68d4bfc">tdrw_diffcoeff</a></div><div class="ttdeci">double tdrw_diffcoeff</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00032">TrackingPart.c:32</a></div></div>
<div class="ttc" id="structvertex_html_aa2cd06573422bc415cb8f38a67232de7"><div class="ttname"><a href="structvertex.html#aa2cd06573422bc415cb8f38a67232de7">vertex::fracture</a></div><div class="ttdeci">unsigned int fracture[2]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00112">FuncDef.h:112</a></div></div>
<div class="ttc" id="structvertex_html_a92493253fc12b459eb0599ec07c56743"><div class="ttname"><a href="structvertex.html#a92493253fc12b459eb0599ec07c56743">vertex::velocity</a></div><div class="ttdeci">double velocity[4][2]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00130">FuncDef.h:130</a></div></div>
<div class="ttc" id="structlagrangian_html_a44e890e0ddb81f46f4aa3c1e7c029a73"><div class="ttname"><a href="structlagrangian.html#a44e890e0ddb81f46f4aa3c1e7c029a73">lagrangian::initz</a></div><div class="ttdeci">double initz</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00024">TrackingPart.c:24</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a9fbd79304ae6c1759d1e903f5626ab87"><div class="ttname"><a href="_tracking_part_8c.html#a9fbd79304ae6c1759d1e903f5626ab87">CalculateLagrangian</a></div><div class="ttdeci">struct lagrangian CalculateLagrangian(double xcurrent, double ycurrent, double zcurrent, double xprev, double yprev, double zprev)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l03140">TrackingPart.c:3140</a></div></div>
<div class="ttc" id="structinpfile_html_a66e8759aa38ee20350f04cdc58dee702"><div class="ttname"><a href="structinpfile.html#a66e8759aa38ee20350f04cdc58dee702">inpfile::filename</a></div><div class="ttdeci">char filename[120]</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00011">InitialPartPositions.c:11</a></div></div>
<div class="ttc" id="structcontam_html_a185c332f0d90695ee85c1e243085e2ba"><div class="ttname"><a href="structcontam.html#a185c332f0d90695ee85c1e243085e2ba">contam::pressure</a></div><div class="ttdeci">double pressure</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00207">FuncDef.h:207</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_ae1803816ac80e7c427387495c19a41c8"><div class="ttname"><a href="_tracking_part_8c.html#ae1803816ac80e7c427387495c19a41c8">DefineTimeStep</a></div><div class="ttdeci">void DefineTimeStep()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01622">TrackingPart.c:1622</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_aa2fcd785cc85fd176b09473b4cfcca07"><div class="ttname"><a href="_tracking_part_8c.html#aa2fcd785cc85fd176b09473b4cfcca07">avs_o</a></div><div class="ttdeci">unsigned int avs_o</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a47bac93a59407fc80f873f14625552df"><div class="ttname"><a href="_tracking_part_8c.html#a47bac93a59407fc80f873f14625552df">tdrw</a></div><div class="ttdeci">unsigned int tdrw</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_func_def_8h_html_a26a18460ba7bc9d4e9ace81fda1819ee"><div class="ttname"><a href="_func_def_8h.html#a26a18460ba7bc9d4e9ace81fda1819ee">cell</a></div><div class="ttdeci">struct element * cell</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00042">main.c:42</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a3883c8054aad6431fa7abb3b55be8a20"><div class="ttname"><a href="_tracking_part_8c.html#a3883c8054aad6431fa7abb3b55be8a20">no_out</a></div><div class="ttdeci">unsigned int no_out</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_func_def_8h_html_accb317d0fcd1e5a1683184b91a49ff11"><div class="ttname"><a href="_func_def_8h.html#accb317d0fcd1e5a1683184b91a49ff11">nfract</a></div><div class="ttdeci">unsigned int nfract</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00031">main.c:31</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_aeab4f78b54bf9ba581dcc8f5246d658d"><div class="ttname"><a href="_tracking_part_8c.html#aeab4f78b54bf9ba581dcc8f5246d658d">PredictorStep</a></div><div class="ttdeci">void PredictorStep()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01541">TrackingPart.c:1541</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a5db4b51d7dc78cb8deb4fe9ab4e0a4c6"><div class="ttname"><a href="_tracking_part_8c.html#a5db4b51d7dc78cb8deb4fe9ab4e0a4c6">AcrossIntersection</a></div><div class="ttdeci">void AcrossIntersection(int prevcell, int int1, int int2, int mixing_rule)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02013">TrackingPart.c:2013</a></div></div>
<div class="ttc" id="structtempout_html_a7f6e4c17b4f10a6d9bbdbf02f794217f"><div class="ttname"><a href="structtempout.html#a7f6e4c17b4f10a6d9bbdbf02f794217f">tempout::times</a></div><div class="ttdeci">unsigned int times</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00044">TrackingPart.c:44</a></div></div>
<div class="ttc" id="_func_def_8h_html_a3759fb98594fea9a5c180b9d2324e027"><div class="ttname"><a href="_func_def_8h.html#a3759fb98594fea9a5c180b9d2324e027">DefineAngle</a></div><div class="ttdeci">double DefineAngle(double u1, double u2, double v1, double v2)</div><div class="ttdef"><b>Definition:</b> <a href="_velocity_reconstruction_8c_source.html#l00415">VelocityReconstruction.c:415</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a5c8fe8978ce1689f5dcf12bc7b56793d"><div class="ttname"><a href="_tracking_part_8c.html#a5c8fe8978ce1689f5dcf12bc7b56793d">InsideCell</a></div><div class="ttdeci">int InsideCell(unsigned int numc)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01487">TrackingPart.c:1487</a></div></div>
<div class="ttc" id="_func_def_8h_html_a15415d9923eaa4ed9145037c60199b99"><div class="ttname"><a href="_func_def_8h.html#a15415d9923eaa4ed9145037c60199b99">timesteps</a></div><div class="ttdeci">unsigned long int timesteps</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00048">main.c:48</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a526f545a0cd984e3aeea379a5f566231"><div class="ttname"><a href="_tracking_part_8c.html#a526f545a0cd984e3aeea379a5f566231">curv_o</a></div><div class="ttdeci">unsigned int curv_o</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="structelement_html_ab6062a713eca6e7458529ea45dea64d3"><div class="ttname"><a href="structelement.html#ab6062a713eca6e7458529ea45dea64d3">element::veloc_ind</a></div><div class="ttdeci">unsigned int veloc_ind[3]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00170">FuncDef.h:170</a></div></div>
<div class="ttc" id="structtempout_html_a56ef223d6bce6cfa895728b327d2bd82"><div class="ttname"><a href="structtempout.html#a56ef223d6bce6cfa895728b327d2bd82">tempout::length_t</a></div><div class="ttdeci">double length_t</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00052">TrackingPart.c:52</a></div></div>
<div class="ttc" id="_func_def_8h_html_adef0bd5e77533cdd4cdd0bcf0d5dc96b"><div class="ttname"><a href="_func_def_8h.html#adef0bd5e77533cdd4cdd0bcf0d5dc96b">flag_w</a></div><div class="ttdeci">unsigned int flag_w</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00038">main.c:38</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a1d090dc1bc431eb7753cca8a46c5b65c"><div class="ttname"><a href="_tracking_part_8c.html#a1d090dc1bc431eb7753cca8a46c5b65c">FLAG_OUT</a></div><div class="ttdeci">unsigned int FLAG_OUT</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00029">TrackingPart.c:29</a></div></div>
<div class="ttc" id="structvertex_html_acf83b561551952403148f73fe032f57b"><div class="ttname"><a href="structvertex.html#acf83b561551952403148f73fe032f57b">vertex::numneighb</a></div><div class="ttdeci">unsigned int numneighb</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00127">FuncDef.h:127</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a531d5d9aafd742ee661c27de55926627"><div class="ttname"><a href="_tracking_part_8c.html#a531d5d9aafd742ee661c27de55926627">tdrw_o</a></div><div class="ttdeci">unsigned int tdrw_o</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="structtempout_html_a959460ad7a7becc867670385c6540dcd"><div class="ttname"><a href="structtempout.html#a959460ad7a7becc867670385c6540dcd">tempout::cellp</a></div><div class="ttdeci">unsigned int cellp</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00048">TrackingPart.c:48</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a31b6a7f477cbead6448a5c27a867f86d"><div class="ttname"><a href="_tracking_part_8c.html#a31b6a7f477cbead6448a5c27a867f86d">CorrectorStep</a></div><div class="ttdeci">void CorrectorStep()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01576">TrackingPart.c:1576</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_aca9c704b192b82aaa3d33d12882a1c2f"><div class="ttname"><a href="_tracking_part_8c.html#aca9c704b192b82aaa3d33d12882a1c2f">tdrw_porosity</a></div><div class="ttdeci">double tdrw_porosity</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00032">TrackingPart.c:32</a></div></div>
<div class="ttc" id="structcontam_html_a70e44829116675e21bda7422f0c2b777"><div class="ttname"><a href="structcontam.html#a70e44829116675e21bda7422f0c2b777">contam::velocity</a></div><div class="ttdeci">double velocity[2]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00180">FuncDef.h:180</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a4b29f9c2e6a8e8da90992985304f0b78"><div class="ttname"><a href="_tracking_part_8c.html#a4b29f9c2e6a8e8da90992985304f0b78">t</a></div><div class="ttdeci">unsigned int t</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_aae06b27f74226725f3664a2b53467553"><div class="ttname"><a href="_tracking_part_8c.html#aae06b27f74226725f3664a2b53467553">lagvariable</a></div><div class="ttdeci">struct lagrangian lagvariable</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00028">TrackingPart.c:28</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a0d6bf595b25906760b9c824c66afc33a"><div class="ttname"><a href="_tracking_part_8c.html#a0d6bf595b25906760b9c824c66afc33a">tfile</a></div><div class="ttdeci">unsigned int tfile</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="structmaterial_html_a82946cb78555ad8c4c14a12fbd7aa3f8"><div class="ttname"><a href="structmaterial.html#a82946cb78555ad8c4c14a12fbd7aa3f8">material::firstnode</a></div><div class="ttdeci">unsigned int firstnode</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00086">FuncDef.h:86</a></div></div>
<div class="ttc" id="_func_def_8h_html_a821d6a33fadb1aacb1a231c2c38cf7ca"><div class="ttname"><a href="_func_def_8h.html#a821d6a33fadb1aacb1a231c2c38cf7ca">particle</a></div><div class="ttdeci">struct contam * particle</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00041">main.c:41</a></div></div>
<div class="ttc" id="_func_def_8h_html_a5d25bfed6640fd5e87e0e1f917e25218"><div class="ttname"><a href="_func_def_8h.html#a5d25bfed6640fd5e87e0e1f917e25218">OutputMarPlumDisp</a></div><div class="ttdeci">void OutputMarPlumDisp(int currentnum, char path[125])</div><div class="ttdef"><b>Definition:</b> <a href="output_8c_source.html#l00019">output.c:19</a></div></div>
<div class="ttc" id="structcontam_html_aacd8d2e19b4a3c689e96cf9693218777"><div class="ttname"><a href="structcontam.html#aacd8d2e19b4a3c689e96cf9693218777">contam::prev_pos</a></div><div class="ttdeci">double prev_pos[2]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00186">FuncDef.h:186</a></div></div>
<div class="ttc" id="structcontam_html_a5b317ab55ab5b48dc82c9a473c76a41e"><div class="ttname"><a href="structcontam.html#a5b317ab55ab5b48dc82c9a473c76a41e">contam::weight</a></div><div class="ttdeci">double weight[3]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00198">FuncDef.h:198</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a46a51bd2a4a54a3fdb92ad918816d1c6"><div class="ttname"><a href="_tracking_part_8c.html#a46a51bd2a4a54a3fdb92ad918816d1c6">timecounter</a></div><div class="ttdeci">unsigned int timecounter</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="_func_def_8h_html_aa8cd5b8e207b47b4a0ad1052040d16e9"><div class="ttname"><a href="_func_def_8h.html#aa8cd5b8e207b47b4a0ad1052040d16e9">CalculatePosition3D</a></div><div class="ttdeci">struct posit3d CalculatePosition3D()</div><div class="ttdef"><b>Definition:</b> <a href="_rotate_fracture_8c_source.html#l00213">RotateFracture.c:213</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a35bb87da21d354b827425c8cf4428fe9"><div class="ttname"><a href="_tracking_part_8c.html#a35bb87da21d354b827425c8cf4428fe9">nodeID</a></div><div class="ttdeci">unsigned int nodeID</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_add14e959474dac3e9dc7a0b82af4978b"><div class="ttname"><a href="_tracking_part_8c.html#add14e959474dac3e9dc7a0b82af4978b">ParticleOutput</a></div><div class="ttdeci">void ParticleOutput(int currentt, int fract_p)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02669">TrackingPart.c:2669</a></div></div>
<div class="ttc" id="structtempout_html_a389fe2c017890281652d5abc6a608f91"><div class="ttname"><a href="structtempout.html#a389fe2c017890281652d5abc6a608f91">tempout::position3d</a></div><div class="ttdeci">double position3d[3]</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00046">TrackingPart.c:46</a></div></div>
<div class="ttc" id="structcontam_html_a1747a7b7a63f22656afa1df6462279e8"><div class="ttname"><a href="structcontam.html#a1747a7b7a63f22656afa1df6462279e8">contam::intcell</a></div><div class="ttdeci">unsigned int intcell</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00195">FuncDef.h:195</a></div></div>
<div class="ttc" id="structcontam_html_aaff43bc31b910d7ac48f5d0a78f2212b"><div class="ttname"><a href="structcontam.html#aaff43bc31b910d7ac48f5d0a78f2212b">contam::t_diff</a></div><div class="ttdeci">double t_diff</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00213">FuncDef.h:213</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a3202503f7885b8b7db52a53134351045"><div class="ttname"><a href="_tracking_part_8c.html#a3202503f7885b8b7db52a53134351045">SearchNeighborCells</a></div><div class="ttdeci">void SearchNeighborCells(int nn1, int nn2, int nn3)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01450">TrackingPart.c:1450</a></div></div>
<div class="ttc" id="structcontam_html_aaa72e564c7052e029003076e0d8768be"><div class="ttname"><a href="structcontam.html#aaa72e564c7052e029003076e0d8768be">contam::t_adv_diff</a></div><div class="ttdeci">double t_adv_diff</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00210">FuncDef.h:210</a></div></div>
<div class="ttc" id="structintcoef_html"><div class="ttname"><a href="structintcoef.html">intcoef</a></div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00033">TrackingPart.c:33</a></div></div>
<div class="ttc" id="_func_def_8h_html_ab71244130eef93109128572e8ef83c2b"><div class="ttname"><a href="_func_def_8h.html#ab71244130eef93109128572e8ef83c2b">fracture</a></div><div class="ttdeci">struct material * fracture</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00039">main.c:39</a></div></div>
<div class="ttc" id="structinpfile_html_a57ff2cce78c35a8a128927da9eeccfbc"><div class="ttname"><a href="structinpfile.html#a57ff2cce78c35a8a128927da9eeccfbc">inpfile::param</a></div><div class="ttdeci">double param</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00013">InitialPartPositions.c:13</a></div></div>
<div class="ttc" id="structvertex_html_a82e41673a29352ee0f004ae7890d5266"><div class="ttname"><a href="structvertex.html#a82e41673a29352ee0f004ae7890d5266">vertex::indnodes</a></div><div class="ttdeci">unsigned int * indnodes</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00136">FuncDef.h:136</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a1c990391d3ca9179d3ea9e6bb6e4d16a"><div class="ttname"><a href="_tracking_part_8c.html#a1c990391d3ca9179d3ea9e6bb6e4d16a">tempdata</a></div><div class="ttdeci">struct tempout * tempdata</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00056">TrackingPart.c:56</a></div></div>
<div class="ttc" id="_func_def_8h_html_ae2df2bd90c8d4aa96e508002a36327c9"><div class="ttname"><a href="_func_def_8h.html#ae2df2bd90c8d4aa96e508002a36327c9">InitPos</a></div><div class="ttdeci">int InitPos()</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00021">InitialPartPositions.c:21</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a2c8fb935fea8f63cfbb4e768f2f7edb4"><div class="ttname"><a href="_tracking_part_8c.html#a2c8fb935fea8f63cfbb4e768f2f7edb4">plumec</a></div><div class="ttdeci">unsigned int plumec</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a7530c338b58fe878c151e5b4a1a16f19"><div class="ttname"><a href="_tracking_part_8c.html#a7530c338b58fe878c151e5b4a1a16f19">marfa</a></div><div class="ttdeci">unsigned int marfa</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="_func_def_8h_html_ae04e94bac8fc762dd97706043f25eaa4"><div class="ttname"><a href="_func_def_8h.html#ae04e94bac8fc762dd97706043f25eaa4">nodezonein</a></div><div class="ttdeci">unsigned int * nodezonein</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00036">main.c:36</a></div></div>
<div class="ttc" id="structcontam_html_a11c5e87e6e62d258648d5a02472251d5"><div class="ttname"><a href="structcontam.html#a11c5e87e6e62d258648d5a02472251d5">contam::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00201">FuncDef.h:201</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a0e6d306e376daacaaffc67739cf22316"><div class="ttname"><a href="_tracking_part_8c.html#a0e6d306e376daacaaffc67739cf22316">frac_o</a></div><div class="ttdeci">unsigned int frac_o</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a181c33224a0f02a5196c0c7e088744ec"><div class="ttname"><a href="_tracking_part_8c.html#a181c33224a0f02a5196c0c7e088744ec">CalculateCurrentDT</a></div><div class="ttdeci">double CalculateCurrentDT()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02527">TrackingPart.c:2527</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_ae72215fb2ccc4e1c6fe645aec42c6ff9"><div class="ttname"><a href="_tracking_part_8c.html#ae72215fb2ccc4e1c6fe645aec42c6ff9">Yindex</a></div><div class="ttdeci">int Yindex(int nodenum, int nnp)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02561">TrackingPart.c:2561</a></div></div>
<div class="ttc" id="_func_def_8h_html_a3ff73fcd11e358801772a4241e99e12d"><div class="ttname"><a href="_func_def_8h.html#a3ff73fcd11e358801772a4241e99e12d">FlowInWeight</a></div><div class="ttdeci">void FlowInWeight(int numbpart)</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00861">InitialPartPositions.c:861</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_acefa073fc2b27b20856d5e8a2ae09fd1"><div class="ttname"><a href="_tracking_part_8c.html#acefa073fc2b27b20856d5e8a2ae09fd1">NeighborCells</a></div><div class="ttdeci">void NeighborCells(int k)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01600">TrackingPart.c:1600</a></div></div>
<div class="ttc" id="structinpfile_html_a23ae60bf94767194de9a09a4eee8cc1d"><div class="ttname"><a href="structinpfile.html#a23ae60bf94767194de9a09a4eee8cc1d">inpfile::flag</a></div><div class="ttdeci">long int flag</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00012">InitialPartPositions.c:12</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a4c82cb7b570cde4cbf47b95a56130948"><div class="ttname"><a href="_tracking_part_8c.html#a4c82cb7b570cde4cbf47b95a56130948">traj_o</a></div><div class="ttdeci">unsigned int traj_o</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="structlagrangian_html_aa3a20ad03006649a17790bd31560af8f"><div class="ttname"><a href="structlagrangian.html#aa3a20ad03006649a17790bd31560af8f">lagrangian::initx</a></div><div class="ttdeci">double initx</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00022">TrackingPart.c:22</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_adf7de66e9362ab9e455afe82ec91a3f5"><div class="ttname"><a href="_tracking_part_8c.html#adf7de66e9362ab9e455afe82ec91a3f5">disp_o</a></div><div class="ttdeci">unsigned int disp_o</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00031">TrackingPart.c:31</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_aff6510d8f65513c2356dc171c2191086"><div class="ttname"><a href="_tracking_part_8c.html#aff6510d8f65513c2356dc171c2191086">FinalPosition</a></div><div class="ttdeci">void FinalPosition()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02996">TrackingPart.c:2996</a></div></div>
<div class="ttc" id="_func_def_8h_html_a0049b706bb5b3980868a5b1e1b3fac0c"><div class="ttname"><a href="_func_def_8h.html#a0049b706bb5b3980868a5b1e1b3fac0c">nnodes</a></div><div class="ttdeci">unsigned int nnodes</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00029">main.c:29</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a6f447de1387b9a1e610decc755e43bd8"><div class="ttname"><a href="_tracking_part_8c.html#a6f447de1387b9a1e610decc755e43bd8">InOutFlowCell</a></div><div class="ttdeci">double InOutFlowCell(int indcell, int int1, double nposx, double nposy)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01949">TrackingPart.c:1949</a></div></div>
<div class="ttc" id="structvertex_html_a54ac97be271319fa385aef0685ea0641"><div class="ttname"><a href="structvertex.html#a54ac97be271319fa385aef0685ea0641">vertex::pressure</a></div><div class="ttdeci">double pressure</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00124">FuncDef.h:124</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a1da16dbc53cf2728df74a0184f76e1ef"><div class="ttname"><a href="_tracking_part_8c.html#a1da16dbc53cf2728df74a0184f76e1ef">StreamlineRandomSampling</a></div><div class="ttdeci">int StreamlineRandomSampling(double products[4], double speedsq[4], int indj, int int1, int indk, int neighborcellind[4], int neighborfracind[4], int prevfrac, int prevcell)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02142">TrackingPart.c:2142</a></div></div>
<div class="ttc" id="structlagrangian_html_a6c0717ffd474442f1651a1f7ebec625f"><div class="ttname"><a href="structlagrangian.html#a6c0717ffd474442f1651a1f7ebec625f">lagrangian::tau</a></div><div class="ttdeci">double tau</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00020">TrackingPart.c:20</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a9541c2c154a6c03a5bf820ac7522fc04"><div class="ttname"><a href="_tracking_part_8c.html#a9541c2c154a6c03a5bf820ac7522fc04">Moving2NextCell</a></div><div class="ttdeci">int Moving2NextCell(int stuck, int k)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02471">TrackingPart.c:2471</a></div></div>
<div class="ttc" id="_func_def_8h_html_a9d0d7da8d3c9e75857a16e168969f89d"><div class="ttname"><a href="_func_def_8h.html#a9d0d7da8d3c9e75857a16e168969f89d">node</a></div><div class="ttdeci">struct vertex * node</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00040">main.c:40</a></div></div>
<div class="ttc" id="_func_def_8h_html_a8de9963c8d396e510b962001d412fc37"><div class="ttname"><a href="_func_def_8h.html#a8de9963c8d396e510b962001d412fc37">CalculateVelocity3D</a></div><div class="ttdeci">struct posit3d CalculateVelocity3D()</div><div class="ttdef"><b>Definition:</b> <a href="_rotate_fracture_8c_source.html#l00335">RotateFracture.c:335</a></div></div>
<div class="ttc" id="_func_def_8h_html_a5445e2c235239b89cc51146de36ca58f"><div class="ttname"><a href="_func_def_8h.html#a5445e2c235239b89cc51146de36ca58f">XindexC</a></div><div class="ttdeci">int XindexC(int nodenum, int ii)</div><div class="ttdef"><b>Definition:</b> <a href="_velocity_reconstruction_8c_source.html#l00922">VelocityReconstruction.c:922</a></div></div>
<div class="ttc" id="_func_def_8h_html_a5799b26fb87c6d98cd44352eb84a2e7e"><div class="ttname"><a href="_func_def_8h.html#a5799b26fb87c6d98cd44352eb84a2e7e">timeunit</a></div><div class="ttdeci">double timeunit</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00051">main.c:51</a></div></div>
<div class="ttc" id="_func_def_8h_html_a484100bd5902d4efcdd15c21d1cb9048"><div class="ttname"><a href="_func_def_8h.html#a484100bd5902d4efcdd15c21d1cb9048">Control_File_Optional</a></div><div class="ttdeci">struct inpfile Control_File_Optional(char fileobject[], int ctr)</div><div class="ttdef"><b>Definition:</b> <a href="_read_grid_init_8c_source.html#l01135">ReadGridInit.c:1135</a></div></div>
<div class="ttc" id="_func_def_8h_html_a6ac46448269e65b5766a3e49942c28e7"><div class="ttname"><a href="_func_def_8h.html#a6ac46448269e65b5766a3e49942c28e7">ChangeFracture</a></div><div class="ttdeci">void ChangeFracture(int cell_win)</div><div class="ttdef"><b>Definition:</b> <a href="_rotate_fracture_8c_source.html#l00183">RotateFracture.c:183</a></div></div>
<div class="ttc" id="structtempout_html_abc348407152ab976840ee50d46164a83"><div class="ttname"><a href="structtempout.html#abc348407152ab976840ee50d46164a83">tempout::velocity3d</a></div><div class="ttdeci">double velocity3d[3]</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00047">TrackingPart.c:47</a></div></div>
<div class="ttc" id="structcontam_html_a0b9253ce268d781958145f9d110df2de"><div class="ttname"><a href="structcontam.html#a0b9253ce268d781958145f9d110df2de">contam::fracture</a></div><div class="ttdeci">unsigned int fracture</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00189">FuncDef.h:189</a></div></div>
<div class="ttc" id="structtempout_html_aaadaf59e6458b77cd74d6e42b7f946bf"><div class="ttname"><a href="structtempout.html#aaadaf59e6458b77cd74d6e42b7f946bf">tempout::betap</a></div><div class="ttdeci">double betap</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00051">TrackingPart.c:51</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a67b3bde25c933874d93fd30f06b55f65"><div class="ttname"><a href="_tracking_part_8c.html#a67b3bde25c933874d93fd30f06b55f65">np</a></div><div class="ttdeci">unsigned int np</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_ae332144a969481cf5f9e1c954c332ee5"><div class="ttname"><a href="_tracking_part_8c.html#ae332144a969481cf5f9e1c954c332ee5">t_adv</a></div><div class="ttdeci">double t_adv</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00032">TrackingPart.c:32</a></div></div>
<div class="ttc" id="structcontam_html_ad50f20b01e37af1fedfd7bbe0cd1d7e3"><div class="ttname"><a href="structcontam.html#ad50f20b01e37af1fedfd7bbe0cd1d7e3">contam::fl_weight</a></div><div class="ttdeci">double fl_weight</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00204">FuncDef.h:204</a></div></div>
<div class="ttc" id="structinpfile_html"><div class="ttname"><a href="structinpfile.html">inpfile</a></div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00010">InitialPartPositions.c:10</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a7ff6ac949c292978394b28d9e0a9977b"><div class="ttname"><a href="_tracking_part_8c.html#a7ff6ac949c292978394b28d9e0a9977b">CompleteMixingRandomSampling</a></div><div class="ttdeci">int CompleteMixingRandomSampling(double products[4], double speedsq[4], int indj, int int1, int indk)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02344">TrackingPart.c:2344</a></div></div>
<div class="ttc" id="_func_def_8h_html_a2afbea1a5d0b14d8a098f551fe055420"><div class="ttname"><a href="_func_def_8h.html#a2afbea1a5d0b14d8a098f551fe055420">Control_File</a></div><div class="ttdeci">struct inpfile Control_File(char fileobject[], int ctr)</div><div class="ttdef"><b>Definition:</b> <a href="_read_grid_init_8c_source.html#l01090">ReadGridInit.c:1090</a></div></div>
<div class="ttc" id="structlagrangian_html"><div class="ttname"><a href="structlagrangian.html">lagrangian</a></div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00018">TrackingPart.c:18</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a70ceb6e59ecdae0487126a86c88523bb"><div class="ttname"><a href="_tracking_part_8c.html#a70ceb6e59ecdae0487126a86c88523bb">ParticleTrack</a></div><div class="ttdeci">void ParticleTrack()</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00066">TrackingPart.c:66</a></div></div>
<div class="ttc" id="structcontam_html_a858c05f3221a70f6e212c1e7e172252c"><div class="ttname"><a href="structcontam.html#a858c05f3221a70f6e212c1e7e172252c">contam::cell</a></div><div class="ttdeci">unsigned int cell</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00192">FuncDef.h:192</a></div></div>
<div class="ttc" id="structposit3d_html"><div class="ttname"><a href="structposit3d.html">posit3d</a></div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00016">InitialPartPositions.c:16</a></div></div>
<div class="ttc" id="_func_def_8h_html"><div class="ttname"><a href="_func_def_8h.html">FuncDef.h</a></div></div>
<div class="ttc" id="_func_def_8h_html_a11a6fda3ecb0ede2c4a9a8e96e23145d"><div class="ttname"><a href="_func_def_8h.html#a11a6fda3ecb0ede2c4a9a8e96e23145d">YindexC</a></div><div class="ttdeci">int YindexC(int nodenum, int ii)</div><div class="ttdef"><b>Definition:</b> <a href="_velocity_reconstruction_8c_source.html#l00933">VelocityReconstruction.c:933</a></div></div>
<div class="ttc" id="structvertex_html_a3473aebf2ce957df8c02095cc98ebb39"><div class="ttname"><a href="structvertex.html#a3473aebf2ce957df8c02095cc98ebb39">vertex::coord_xy</a></div><div class="ttdeci">double coord_xy[6]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00118">FuncDef.h:118</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a288d5ddd917552bb6640483eaa1b7add"><div class="ttname"><a href="_tracking_part_8c.html#a288d5ddd917552bb6640483eaa1b7add">CalculateWeights</a></div><div class="ttdeci">struct intcoef CalculateWeights(int nn1, int nn2, int nn3)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l01416">TrackingPart.c:1416</a></div></div>
<div class="ttc" id="structelement_html_aadc95dc4817009223151c40387f40e06"><div class="ttname"><a href="structelement.html#aadc95dc4817009223151c40387f40e06">element::node_ind</a></div><div class="ttdeci">unsigned int node_ind[3]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00167">FuncDef.h:167</a></div></div>
<div class="ttc" id="_func_def_8h_html_a396d7f3e7653807b76887efe794f2eb7"><div class="ttname"><a href="_func_def_8h.html#a396d7f3e7653807b76887efe794f2eb7">maindir</a></div><div class="ttdeci">char maindir[125]</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00043">main.c:43</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_abcfbff992646c011bd630b5df97eeebe"><div class="ttname"><a href="_tracking_part_8c.html#abcfbff992646c011bd630b5df97eeebe">mixing_rule</a></div><div class="ttdeci">unsigned int mixing_rule</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00030">TrackingPart.c:30</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_abeed81e7f6a295e7af7da3721dd07d66"><div class="ttname"><a href="_tracking_part_8c.html#abeed81e7f6a295e7af7da3721dd07d66">TimeDomainRW</a></div><div class="ttdeci">double TimeDomainRW(double time_advect)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l03175">TrackingPart.c:3175</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a69f9dfd9f5eba61f40439fc5dc92f3b6"><div class="ttname"><a href="_tracking_part_8c.html#a69f9dfd9f5eba61f40439fc5dc92f3b6">Moving2Center</a></div><div class="ttdeci">void Moving2Center(int nnp, int cellnumber)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02440">TrackingPart.c:2440</a></div></div>
<div class="ttc" id="structtempout_html_af198ba0015680ea5c222caca83cc4d7a"><div class="ttname"><a href="structtempout.html#af198ba0015680ea5c222caca83cc4d7a">tempout::timep</a></div><div class="ttdeci">double timep</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00050">TrackingPart.c:50</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a6d342b64b20e55a0478c7c52c47ac746"><div class="ttname"><a href="_tracking_part_8c.html#a6d342b64b20e55a0478c7c52c47ac746">all_out</a></div><div class="ttdeci">unsigned int all_out</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00029">TrackingPart.c:29</a></div></div>
<div class="ttc" id="structlagrangian_html_ad5fabc5bfeccc6ba7e60fbdf966c21d7"><div class="ttname"><a href="structlagrangian.html#ad5fabc5bfeccc6ba7e60fbdf966c21d7">lagrangian::betta</a></div><div class="ttdeci">double betta</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00021">TrackingPart.c:21</a></div></div>
<div class="ttc" id="structvertex_html_a583032cadaa99e8f5c044d3bd10191cf"><div class="ttname"><a href="structvertex.html#a583032cadaa99e8f5c044d3bd10191cf">vertex::cells</a></div><div class="ttdeci">unsigned int ** cells</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00139">FuncDef.h:139</a></div></div>
<div class="ttc" id="structvertex_html_a5e4c0ee67478edf757b52b50859dd25e"><div class="ttname"><a href="structvertex.html#a5e4c0ee67478edf757b52b50859dd25e">vertex::timestep</a></div><div class="ttdeci">double timestep[4]</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00133">FuncDef.h:133</a></div></div>
<div class="ttc" id="structtempout_html_aae2e06cd449b82338982dfcbeaacfe13"><div class="ttname"><a href="structtempout.html#aae2e06cd449b82338982dfcbeaacfe13">tempout::fracturep</a></div><div class="ttdeci">unsigned int fracturep</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00049">TrackingPart.c:49</a></div></div>
<div class="ttc" id="structtempout_html_a766494dc449f55f34cbb0404c0b3823a"><div class="ttname"><a href="structtempout.html#a766494dc449f55f34cbb0404c0b3823a">tempout::position2d</a></div><div class="ttdeci">double position2d[2]</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00045">TrackingPart.c:45</a></div></div>
<div class="ttc" id="_func_def_8h_html_a0bbf0ae1391d4e6a5a3fbc8d360d18b3"><div class="ttname"><a href="_func_def_8h.html#a0bbf0ae1391d4e6a5a3fbc8d360d18b3">String_Compare</a></div><div class="ttdeci">int String_Compare(char string1[], char string2[])</div><div class="ttdef"><b>Definition:</b> <a href="_read_grid_init_8c_source.html#l01176">ReadGridInit.c:1176</a></div></div>
<div class="ttc" id="_func_def_8h_html_a8e227a7bdba87548413eeac3daae26a6"><div class="ttname"><a href="_func_def_8h.html#a8e227a7bdba87548413eeac3daae26a6">nodezoneout</a></div><div class="ttdeci">unsigned int * nodezoneout</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00037">main.c:37</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a4952850f8949cccbdef08a6f01dfec20"><div class="ttname"><a href="_tracking_part_8c.html#a4952850f8949cccbdef08a6f01dfec20">t_adv0</a></div><div class="ttdeci">double t_adv0</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00032">TrackingPart.c:32</a></div></div>
<div class="ttc" id="_func_def_8h_html_a205add90a27292ac5f18188fa35bcdf5"><div class="ttname"><a href="_func_def_8h.html#a205add90a27292ac5f18188fa35bcdf5">OpenFile</a></div><div class="ttdeci">FILE * OpenFile(char filen[120], char fileopt[2])</div><div class="ttdef"><b>Definition:</b> <a href="_read_grid_init_8c_source.html#l00728">ReadGridInit.c:728</a></div></div>
<div class="ttc" id="structelement_html_af51b08146a1c495aadf45e7f085e1267"><div class="ttname"><a href="structelement.html#af51b08146a1c495aadf45e7f085e1267">element::fracture</a></div><div class="ttdeci">unsigned int fracture</div><div class="ttdef"><b>Definition:</b> <a href="_func_def_8h_source.html#l00164">FuncDef.h:164</a></div></div>
<div class="ttc" id="_func_def_8h_html_a461479d92dd1f67c7ef94fa953186860"><div class="ttname"><a href="_func_def_8h.html#a461479d92dd1f67c7ef94fa953186860">InitCell</a></div><div class="ttdeci">int InitCell()</div><div class="ttdef"><b>Definition:</b> <a href="_initial_part_positions_8c_source.html#l00621">InitialPartPositions.c:621</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_a60337725a775035e26cf11f796197fb0"><div class="ttname"><a href="_tracking_part_8c.html#a60337725a775035e26cf11f796197fb0">Xindex</a></div><div class="ttdeci">int Xindex(int nodenum, int nnp)</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l02550">TrackingPart.c:2550</a></div></div>
<div class="ttc" id="_tracking_part_8c_html_af11f3d6258b0839dfb97fe3875aa0a5b"><div class="ttname"><a href="_tracking_part_8c.html#af11f3d6258b0839dfb97fe3875aa0a5b">timediff</a></div><div class="ttdeci">double timediff</div><div class="ttdef"><b>Definition:</b> <a href="_tracking_part_8c_source.html#l00032">TrackingPart.c:32</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f80ddb2df819b297fd9c7beccba09984.html">Docs_PT</a></li><li class="navelem"><a class="el" href="dir_966eb28a5fc4cd2ac9e3086fcb212f97.html">ParticleTracking_source</a></li><li class="navelem"><a class="el" href="_tracking_part_8c.html">TrackingPart.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
